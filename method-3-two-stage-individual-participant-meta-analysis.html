<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Method 3: Two-Stage Individual Participant Meta-Analysis | A Taxonomy of Data Synthesis: A Tutorial</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Method 3: Two-Stage Individual Participant Meta-Analysis | A Taxonomy of Data Synthesis: A Tutorial" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="emoriebeck/data-synthesis-tutorial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Method 3: Two-Stage Individual Participant Meta-Analysis | A Taxonomy of Data Synthesis: A Tutorial" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  



<meta name="date" content="2024-05-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="method-2-pooled-one-stage-models-with-study-specific-effects.html"/>
<link rel="next" href="method-3-one-stage-individual-participant-analyses-reported-together.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Workspace</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#packages"><i class="fa fa-check"></i><b>1.1</b> Packages</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#directory-path"><i class="fa fa-check"></i><b>1.2</b> Directory Path</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.3</b> Introduction</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#codebook"><i class="fa fa-check"></i><b>1.4</b> Codebook</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#navigating-this-tutorial"><i class="fa fa-check"></i><b>1.5</b> Navigating This Tutorial</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cleaning.html"><a href="cleaning.html"><i class="fa fa-check"></i><b>2</b> Data Cleaning</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cleaning.html"><a href="cleaning.html#berlin-aging-study-base-i"><i class="fa fa-check"></i><b>2.1</b> Berlin Aging Study (BASE-I)</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="cleaning.html"><a href="cleaning.html#load-data"><i class="fa fa-check"></i><b>2.1.1</b> Load Data</a></li>
<li class="chapter" data-level="2.1.2" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring"><i class="fa fa-check"></i><b>2.1.2</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.1.3" data-path="cleaning.html"><a href="cleaning.html#covariates"><i class="fa fa-check"></i><b>2.1.3</b> Covariates</a></li>
<li class="chapter" data-level="2.1.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables"><i class="fa fa-check"></i><b>2.1.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.1.5" data-path="cleaning.html"><a href="cleaning.html#outcome-variables"><i class="fa fa-check"></i><b>2.1.5</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.1.6" data-path="cleaning.html"><a href="cleaning.html#combine-data"><i class="fa fa-check"></i><b>2.1.6</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="cleaning.html"><a href="cleaning.html#einstein-aging-study-eas"><i class="fa fa-check"></i><b>2.2</b> Einstein Aging Study (EAS)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="cleaning.html"><a href="cleaning.html#load-data-1"><i class="fa fa-check"></i><b>2.2.1</b> Load Data</a></li>
<li class="chapter" data-level="2.2.2" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring-1"><i class="fa fa-check"></i><b>2.2.2</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.2.3" data-path="cleaning.html"><a href="cleaning.html#covariates-1"><i class="fa fa-check"></i><b>2.2.3</b> Covariates</a></li>
<li class="chapter" data-level="2.2.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables-1"><i class="fa fa-check"></i><b>2.2.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.2.5" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-1"><i class="fa fa-check"></i><b>2.2.5</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.2.6" data-path="cleaning.html"><a href="cleaning.html#combine-data-1"><i class="fa fa-check"></i><b>2.2.6</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="cleaning.html"><a href="cleaning.html#german-socioeconomic-panel-gsoep"><i class="fa fa-check"></i><b>2.3</b> German Socioeconomic Panel (GSOEP)</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="cleaning.html"><a href="cleaning.html#load-data-2"><i class="fa fa-check"></i><b>2.3.1</b> Load Data</a></li>
<li class="chapter" data-level="2.3.2" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring-2"><i class="fa fa-check"></i><b>2.3.2</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.3.3" data-path="cleaning.html"><a href="cleaning.html#covariates-2"><i class="fa fa-check"></i><b>2.3.3</b> Covariates</a></li>
<li class="chapter" data-level="2.3.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables-2"><i class="fa fa-check"></i><b>2.3.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.3.5" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-2"><i class="fa fa-check"></i><b>2.3.5</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.3.6" data-path="cleaning.html"><a href="cleaning.html#combine-data-2"><i class="fa fa-check"></i><b>2.3.6</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="cleaning.html"><a href="cleaning.html#household-income-and-labour-dynamics-in-australia-hilda"><i class="fa fa-check"></i><b>2.4</b> Household, Income, and Labour Dynamics in Australia (HILDA)</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="cleaning.html"><a href="cleaning.html#load-data-3"><i class="fa fa-check"></i><b>2.4.1</b> Load Data</a></li>
<li class="chapter" data-level="2.4.2" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring-3"><i class="fa fa-check"></i><b>2.4.2</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.4.3" data-path="cleaning.html"><a href="cleaning.html#covariates-3"><i class="fa fa-check"></i><b>2.4.3</b> Covariates</a></li>
<li class="chapter" data-level="2.4.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables-3"><i class="fa fa-check"></i><b>2.4.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.4.5" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-3"><i class="fa fa-check"></i><b>2.4.5</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.4.6" data-path="cleaning.html"><a href="cleaning.html#combine-data-3"><i class="fa fa-check"></i><b>2.4.6</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="cleaning.html"><a href="cleaning.html#health-and-retirement-study-hrs"><i class="fa fa-check"></i><b>2.5</b> Health and Retirement Study (HRS)</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="cleaning.html"><a href="cleaning.html#load-data-4"><i class="fa fa-check"></i><b>2.5.1</b> Load Data</a></li>
<li class="chapter" data-level="2.5.2" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring-4"><i class="fa fa-check"></i><b>2.5.2</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.5.3" data-path="cleaning.html"><a href="cleaning.html#covariates-4"><i class="fa fa-check"></i><b>2.5.3</b> Covariates</a></li>
<li class="chapter" data-level="2.5.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables-4"><i class="fa fa-check"></i><b>2.5.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.5.5" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-4"><i class="fa fa-check"></i><b>2.5.5</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.5.6" data-path="cleaning.html"><a href="cleaning.html#combine-data-4"><i class="fa fa-check"></i><b>2.5.6</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="cleaning.html"><a href="cleaning.html#longitudinal-aging-study-amsterdam-lasa"><i class="fa fa-check"></i><b>2.6</b> Longitudinal Aging Study Amsterdam (LASA)</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="cleaning.html"><a href="cleaning.html#load-data-5"><i class="fa fa-check"></i><b>2.6.1</b> Load Data</a></li>
<li class="chapter" data-level="2.6.2" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring-5"><i class="fa fa-check"></i><b>2.6.2</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.6.3" data-path="cleaning.html"><a href="cleaning.html#covariates-5"><i class="fa fa-check"></i><b>2.6.3</b> Covariates</a></li>
<li class="chapter" data-level="2.6.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables-5"><i class="fa fa-check"></i><b>2.6.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.6.5" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-5"><i class="fa fa-check"></i><b>2.6.5</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.6.6" data-path="cleaning.html"><a href="cleaning.html#combine-data-5"><i class="fa fa-check"></i><b>2.6.6</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="cleaning.html"><a href="cleaning.html#map"><i class="fa fa-check"></i><b>2.7</b> MAP</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="cleaning.html"><a href="cleaning.html#load-data-6"><i class="fa fa-check"></i><b>2.7.1</b> Load Data</a></li>
<li class="chapter" data-level="2.7.2" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring-6"><i class="fa fa-check"></i><b>2.7.2</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.7.3" data-path="cleaning.html"><a href="cleaning.html#covariates-6"><i class="fa fa-check"></i><b>2.7.3</b> Covariates</a></li>
<li class="chapter" data-level="2.7.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables-6"><i class="fa fa-check"></i><b>2.7.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.7.5" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-6"><i class="fa fa-check"></i><b>2.7.5</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.7.6" data-path="cleaning.html"><a href="cleaning.html#combine-data-6"><i class="fa fa-check"></i><b>2.7.6</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="cleaning.html"><a href="cleaning.html#mars"><i class="fa fa-check"></i><b>2.8</b> MARS</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring-7"><i class="fa fa-check"></i><b>2.8.1</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.8.2" data-path="cleaning.html"><a href="cleaning.html#covariates-7"><i class="fa fa-check"></i><b>2.8.2</b> Covariates</a></li>
<li class="chapter" data-level="2.8.3" data-path="cleaning.html"><a href="cleaning.html#personality-variables-7"><i class="fa fa-check"></i><b>2.8.3</b> Personality Variables</a></li>
<li class="chapter" data-level="2.8.4" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-7"><i class="fa fa-check"></i><b>2.8.4</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.8.5" data-path="cleaning.html"><a href="cleaning.html#combine-data-7"><i class="fa fa-check"></i><b>2.8.5</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="cleaning.html"><a href="cleaning.html#ros"><i class="fa fa-check"></i><b>2.9</b> ROS</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="cleaning.html"><a href="cleaning.html#load-data-7"><i class="fa fa-check"></i><b>2.9.1</b> Load Data</a></li>
<li class="chapter" data-level="2.9.2" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring-8"><i class="fa fa-check"></i><b>2.9.2</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.9.3" data-path="cleaning.html"><a href="cleaning.html#covariates-8"><i class="fa fa-check"></i><b>2.9.3</b> Covariates</a></li>
<li class="chapter" data-level="2.9.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables-8"><i class="fa fa-check"></i><b>2.9.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.9.5" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-8"><i class="fa fa-check"></i><b>2.9.5</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.9.6" data-path="cleaning.html"><a href="cleaning.html#combine-data-8"><i class="fa fa-check"></i><b>2.9.6</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="cleaning.html"><a href="cleaning.html#origins-of-the-variances-of-the-oldest-old-octogenarian-twins-octo-twin"><i class="fa fa-check"></i><b>2.10</b> Origins of the Variances of the Oldest-Old: Octogenarian Twins (OCTO-TWIN)</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="cleaning.html"><a href="cleaning.html#load-data-8"><i class="fa fa-check"></i><b>2.10.1</b> Load Data</a></li>
<li class="chapter" data-level="2.10.2" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring-9"><i class="fa fa-check"></i><b>2.10.2</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.10.3" data-path="cleaning.html"><a href="cleaning.html#covariates-9"><i class="fa fa-check"></i><b>2.10.3</b> Covariates</a></li>
<li class="chapter" data-level="2.10.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables-9"><i class="fa fa-check"></i><b>2.10.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.10.5" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-9"><i class="fa fa-check"></i><b>2.10.5</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.10.6" data-path="cleaning.html"><a href="cleaning.html#combine-data-9"><i class="fa fa-check"></i><b>2.10.6</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="cleaning.html"><a href="cleaning.html#swedish-adoption-twin-study-of-aging-satsa"><i class="fa fa-check"></i><b>2.11</b> Swedish Adoption Twin Study of Aging (SATSA)</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="cleaning.html"><a href="cleaning.html#load-data-9"><i class="fa fa-check"></i><b>2.11.1</b> Load Data</a></li>
<li class="chapter" data-level="2.11.2" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring-10"><i class="fa fa-check"></i><b>2.11.2</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.11.3" data-path="cleaning.html"><a href="cleaning.html#covariates-10"><i class="fa fa-check"></i><b>2.11.3</b> Covariates</a></li>
<li class="chapter" data-level="2.11.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables-10"><i class="fa fa-check"></i><b>2.11.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.11.5" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-10"><i class="fa fa-check"></i><b>2.11.5</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.11.6" data-path="cleaning.html"><a href="cleaning.html#combine-data-10"><i class="fa fa-check"></i><b>2.11.6</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="cleaning.html"><a href="cleaning.html#seattle-longitudinal-study-sls"><i class="fa fa-check"></i><b>2.12</b> Seattle Longitudinal Study (SLS)</a></li>
<li class="chapter" data-level="2.13" data-path="cleaning.html"><a href="cleaning.html#descriptives-of-all-studies"><i class="fa fa-check"></i><b>2.13</b> Descriptives of All Studies</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="runmodels.html"><a href="runmodels.html"><i class="fa fa-check"></i><b>3</b> Method 1: Pooled One Stage Models without Study-Specific Effects</a>
<ul>
<li class="chapter" data-level="3.1" data-path="runmodels.html"><a href="runmodels.html#step-1-combine-data"><i class="fa fa-check"></i><b>3.1</b> Step 1: Combine Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="runmodels.html"><a href="runmodels.html#study-level-moderators"><i class="fa fa-check"></i><b>3.1.1</b> Study-Level Moderators</a></li>
<li class="chapter" data-level="3.1.2" data-path="runmodels.html"><a href="runmodels.html#harmonize-data"><i class="fa fa-check"></i><b>3.1.2</b> Harmonize Data</a></li>
<li class="chapter" data-level="3.1.3" data-path="runmodels.html"><a href="runmodels.html#save-data-files"><i class="fa fa-check"></i><b>3.1.3</b> Save Data Files</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="runmodels.html"><a href="runmodels.html#step-2-run-models-and-extract-results"><i class="fa fa-check"></i><b>3.2</b> Step 2: Run Models and Extract Results</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="runmodels.html"><a href="runmodels.html#method-1a-linear-regression"><i class="fa fa-check"></i><b>3.2.1</b> Method 1A: Linear Regression</a></li>
<li class="chapter" data-level="3.2.2" data-path="runmodels.html"><a href="runmodels.html#part-1b-pooled-linear-regression-with-cluster-robust-standard-errors"><i class="fa fa-check"></i><b>3.2.2</b> Part 1B: Pooled Linear Regression with Cluster Robust Standard Errors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="method-2-pooled-one-stage-models-with-study-specific-effects.html"><a href="method-2-pooled-one-stage-models-with-study-specific-effects.html"><i class="fa fa-check"></i><b>4</b> Method 2: Pooled One Stage Models with Study-Specific Effects</a>
<ul>
<li class="chapter" data-level="4.1" data-path="method-2-pooled-one-stage-models-with-study-specific-effects.html"><a href="method-2-pooled-one-stage-models-with-study-specific-effects.html#step-1-combine-data-1"><i class="fa fa-check"></i><b>4.1</b> Step 1: Combine Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="method-2-pooled-one-stage-models-with-study-specific-effects.html"><a href="method-2-pooled-one-stage-models-with-study-specific-effects.html#study-level-moderators-1"><i class="fa fa-check"></i><b>4.1.1</b> Study-Level Moderators</a></li>
<li class="chapter" data-level="4.1.2" data-path="method-2-pooled-one-stage-models-with-study-specific-effects.html"><a href="method-2-pooled-one-stage-models-with-study-specific-effects.html#harmonize-data-1"><i class="fa fa-check"></i><b>4.1.2</b> Harmonize Data</a></li>
<li class="chapter" data-level="4.1.3" data-path="method-2-pooled-one-stage-models-with-study-specific-effects.html"><a href="method-2-pooled-one-stage-models-with-study-specific-effects.html#save-data-files-1"><i class="fa fa-check"></i><b>4.1.3</b> Save Data Files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="method-2-pooled-one-stage-models-with-study-specific-effects.html"><a href="method-2-pooled-one-stage-models-with-study-specific-effects.html#step-2-run-models-and-extract-results-1"><i class="fa fa-check"></i><b>4.2</b> Step 2: Run Models and Extract Results</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="method-2-pooled-one-stage-models-with-study-specific-effects.html"><a href="method-2-pooled-one-stage-models-with-study-specific-effects.html#method-2a-pooled-one-stage-models-with-dummy-codes"><i class="fa fa-check"></i><b>4.2.1</b> Method 2A: Pooled One Stage Models with Dummy Codes</a></li>
<li class="chapter" data-level="4.2.2" data-path="method-2-pooled-one-stage-models-with-study-specific-effects.html"><a href="method-2-pooled-one-stage-models-with-study-specific-effects.html#method-2b-pooled-one-stage-models-with-random-effects"><i class="fa fa-check"></i><b>4.2.2</b> Method 2B: Pooled One Stage Models with Random Effects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html"><i class="fa fa-check"></i><b>5</b> Method 3: Two-Stage Individual Participant Meta-Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#analytic-plan-4"><i class="fa fa-check"></i><b>5.1</b> Analytic Plan</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#sample-specific-statistical-modeling"><i class="fa fa-check"></i><b>5.1.1</b> 1. Sample-Specific Statistical Modeling</a></li>
<li class="chapter" data-level="5.1.2" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#results-pooling-using-meta-analysis"><i class="fa fa-check"></i><b>5.1.2</b> 2. Results Pooling Using Meta-Analysis</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#step-1-combine-data-2"><i class="fa fa-check"></i><b>5.2</b> Step 1: Combine Data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#study-level-moderators-2"><i class="fa fa-check"></i><b>5.2.1</b> Study-Level Moderators</a></li>
<li class="chapter" data-level="5.2.2" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#harmonize-data-2"><i class="fa fa-check"></i><b>5.2.2</b> Harmonize Data</a></li>
<li class="chapter" data-level="5.2.3" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#save-data-files-2"><i class="fa fa-check"></i><b>5.2.3</b> Save Data Files</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#step-2-run-models-for-each-study"><i class="fa fa-check"></i><b>5.3</b> Step 2: Run Models for Each Study</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#functions"><i class="fa fa-check"></i><b>5.3.1</b> Functions</a></li>
<li class="chapter" data-level="5.3.2" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#run-models"><i class="fa fa-check"></i><b>5.3.2</b> Run Models</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#step-3-meta-analyze-results"><i class="fa fa-check"></i><b>5.4</b> Step 3: Meta-Analyze Results</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#functions-1"><i class="fa fa-check"></i><b>5.4.1</b> Functions</a></li>
<li class="chapter" data-level="5.4.2" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#run-meta-analysis-and-meta-regression-models"><i class="fa fa-check"></i><b>5.4.2</b> Run Meta-Analysis and Meta-Regression Models</a></li>
<li class="chapter" data-level="5.4.3" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#compile-results-4"><i class="fa fa-check"></i><b>5.4.3</b> Compile Results</a></li>
<li class="chapter" data-level="5.4.4" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#figures-4"><i class="fa fa-check"></i><b>5.4.4</b> Figures</a></li>
<li class="chapter" data-level="5.4.5" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#table-meta-analytic-heterogeneity"><i class="fa fa-check"></i><b>5.4.5</b> Table Meta-Analytic Heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="method-3-two-stage-individual-participant-meta-analysis.html"><a href="method-3-two-stage-individual-participant-meta-analysis.html#sample-results-section-4"><i class="fa fa-check"></i><b>5.5</b> Sample Results Section</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="method-3-one-stage-individual-participant-analyses-reported-together.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together.html"><i class="fa fa-check"></i><b>6</b> Method 3: One-Stage Individual Participant Analyses Reported Together</a>
<ul>
<li class="chapter" data-level="6.1" data-path="method-3-one-stage-individual-participant-analyses-reported-together.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together.html#analytic-plan-5"><i class="fa fa-check"></i><b>6.1</b> Analytic Plan</a></li>
<li class="chapter" data-level="6.2" data-path="method-3-one-stage-individual-participant-analyses-reported-together.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together.html#step-1-combine-data-3"><i class="fa fa-check"></i><b>6.2</b> Step 1: Combine Data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="method-3-one-stage-individual-participant-analyses-reported-together.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together.html#harmonize-data-3"><i class="fa fa-check"></i><b>6.2.1</b> Harmonize Data</a></li>
<li class="chapter" data-level="6.2.2" data-path="method-3-one-stage-individual-participant-analyses-reported-together.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together.html#save-data-files-3"><i class="fa fa-check"></i><b>6.2.2</b> Save Data Files</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="method-3-one-stage-individual-participant-analyses-reported-together.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together.html#step-2-run-models-for-each-study-1"><i class="fa fa-check"></i><b>6.3</b> Step 2: Run Models for Each Study</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="method-3-one-stage-individual-participant-analyses-reported-together.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together.html#functions-2"><i class="fa fa-check"></i><b>6.3.1</b> Functions</a></li>
<li class="chapter" data-level="6.3.2" data-path="method-3-one-stage-individual-participant-analyses-reported-together.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together.html#run-models-1"><i class="fa fa-check"></i><b>6.3.2</b> Run Models</a></li>
<li class="chapter" data-level="6.3.3" data-path="method-3-one-stage-individual-participant-analyses-reported-together.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together.html#compile-results-5"><i class="fa fa-check"></i><b>6.3.3</b> Compile Results</a></li>
<li class="chapter" data-level="6.3.4" data-path="method-3-one-stage-individual-participant-analyses-reported-together.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together.html#figures-5"><i class="fa fa-check"></i><b>6.3.4</b> Figures</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="method-3-one-stage-individual-participant-analyses-reported-together.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together.html#sample-results-section-5"><i class="fa fa-check"></i><b>6.4</b> Sample Results Section</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="method-3-one-stage-individual-participant-analyses-reported-together-1.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together-1.html"><i class="fa fa-check"></i><b>7</b> Method 3: One-Stage Individual Participant Analyses Reported Together</a>
<ul>
<li class="chapter" data-level="7.1" data-path="method-3-one-stage-individual-participant-analyses-reported-together-1.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together-1.html#comparisons-across-the-taxonomy"><i class="fa fa-check"></i><b>7.1</b> Comparisons Across the Taxonomy</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="method-3-one-stage-individual-participant-analyses-reported-together-1.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together-1.html#tables-6"><i class="fa fa-check"></i><b>7.1.1</b> Tables</a></li>
<li class="chapter" data-level="7.1.2" data-path="method-3-one-stage-individual-participant-analyses-reported-together-1.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together-1.html#figures-6"><i class="fa fa-check"></i><b>7.1.2</b> Figures</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="method-3-one-stage-individual-participant-analyses-reported-together-1.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together-1.html#comparisons-across-methods-bayesian-versus-frequentist"><i class="fa fa-check"></i><b>7.2</b> Comparisons Across Methods: Bayesian versus Frequentist</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="method-3-one-stage-individual-participant-analyses-reported-together-1.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together-1.html#tables-7"><i class="fa fa-check"></i><b>7.2.1</b> Tables</a></li>
<li class="chapter" data-level="7.2.2" data-path="method-3-one-stage-individual-participant-analyses-reported-together-1.html"><a href="method-3-one-stage-individual-participant-analyses-reported-together-1.html#figures-7"><i class="fa fa-check"></i><b>7.2.2</b> Figures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Taxonomy of Data Synthesis: A Tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="method-3-two-stage-individual-participant-meta-analysis" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Method 3: Two-Stage Individual Participant Meta-Analysis<a href="method-3-two-stage-individual-participant-meta-analysis.html#method-3-two-stage-individual-participant-meta-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="analytic-plan-4" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Analytic Plan<a href="method-3-two-stage-individual-participant-meta-analysis.html#analytic-plan-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the present study, we estimate associations between the Big Five personality traits and crystallized cognitive abilities using a two-stage individual participant data meta-analysis (also known as a coordinated data analysis when multiple analysts are used). The procedure is as follows:</p>
<div id="sample-specific-statistical-modeling" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> 1. Sample-Specific Statistical Modeling<a href="method-3-two-stage-individual-participant-meta-analysis.html#sample-specific-statistical-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Models were run separately for each sample, personality characteristic, outcome, covariate, and moderator combination. To do so, we wrote a series of functions in the R programming language (see online materials) to (1) set up and run the model and extract model coefficients, (2) extract simple-effects predictions for moderator models (i.e. predicted values across levels of the moderator values), and (3) extract effect size metrics for the later meta-analysis. The basic form of the model is as follows:</p>
<p><span class="math inline">\(Y_{ij}=b_0+b_1\ast predictor_{ij}+\epsilon_{ij}\)</span>
<span class="math inline">\(\epsilon_{ij}\sim\mathcal{N}(0, \sigma^2)\)</span>,</p>
<p>where <span class="math inline">\(b_1\)</span> represents the effect of personality predicting the outcome separately in each sample.<br />
The modeling function used the base <code>R</code> <code>lm()</code> function to run the models and the <code>tidy()</code> function from the broom package to extract model coefficients and confidence intervals (CI). Inferences will be made based on the 95% confidence intervals. Effect sizes and their standard errors were extracted from the model <code>summary()</code>. Simple-effects predictions were calculated by providing the full range of personality levels (0-10) and average levels of the covariates from the data used to estimate the model as the “newdata” argument in the base R <code>predict()</code> function.</p>
</div>
<div id="results-pooling-using-meta-analysis" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> 2. Results Pooling Using Meta-Analysis<a href="method-3-two-stage-individual-participant-meta-analysis.html#results-pooling-using-meta-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Once all the models were run, we next combined the effects across samples for each personality characteristic (5), outcome (1), covariate (6; none, each alone, all covariates), and moderator (3) combination and estimated a meta-analysis model of the target effect. We chose to conduct a random effects meta-analysis, which assumes that all effect sizes are randomly drawn from a population of effect sizes. To do so, we constructed three helper functions to (1) set up and run the meta-analytic models, (2) extract the meta-analytic estimates, and (3) extract heterogeneity estimates. The functions and more detail on them can be found in the online materials. The meta-analytic model is as follows:</p>
<p><span class="math inline">\(T_i=\mu+\zeta_i+\epsilon_i\)</span></p>
<p><span class="math inline">\(\epsilon_i\sim \mathcal{N}\left(0,\sigma^2\right)\ \)</span>
<span class="math inline">\(\zeta_i\sim \mathcal{N}\left(0,\tau^2\right)\ \)</span>
<span class="math inline">\(Cov\left(\zeta_i,\epsilon_i\right)=0\)</span>,</p>
<p>where <span class="math inline">\(T_i\)</span> is the sample-specific effect of sample <span class="math inline">\(i\)</span>, <span class="math inline">\(\mu\)</span> is the overall meta-analytic estimate, <span class="math inline">\(\zeta_i\)</span> is true sample variability of sample <span class="math inline">\(i\)</span> from the overall estimate, and <span class="math inline">\(\epsilon_i\)</span> is sampling error.</p>
<p>Random effects meta-analyses were estimated using the metafor package in R. Meta-analytic estimates and confidence intervals were extracted using the <code>coef()</code> function. Inferences were based on the 95% confidence intervals (CI). Heterogeneity estimates were directly extracted from the model. Simple effects predictions of participant-level moderators were calculated using the weighted average sample-level predictions across levels of the moderators.</p>
</div>
</div>
<div id="step-1-combine-data-2" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Step 1: Combine Data<a href="method-3-two-stage-individual-participant-meta-analysis.html#step-1-combine-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We again need to combine data. However, rather than combining data across studies, for the two-stage approach, we’ll be combining data within studies in order to run separate analyses for each before combining via meta-analytic tools.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-1" tabindex="-1"></a>loadRData <span class="ot">&lt;-</span> <span class="cf">function</span>(fileName, type){</span>
<span id="cb348-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-2" tabindex="-1"></a><span class="co">#loads an RData file, and returns it</span></span>
<span id="cb348-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-3" tabindex="-1"></a>    path <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/%s_cleaned.RData&quot;</span>, local_path, fileName)</span>
<span id="cb348-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-4" tabindex="-1"></a>    <span class="fu">print</span>(path)</span>
<span id="cb348-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-5" tabindex="-1"></a>    <span class="fu">load</span>(path)</span>
<span id="cb348-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-6" tabindex="-1"></a>    <span class="fu">get</span>(<span class="fu">ls</span>()[<span class="fu">grepl</span>(type, <span class="fu">ls</span>())])</span>
<span id="cb348-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-7" tabindex="-1"></a>}</span>
<span id="cb348-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-8" tabindex="-1"></a></span>
<span id="cb348-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-9" tabindex="-1"></a>ipd3_meta_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb348-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-10" tabindex="-1"></a>  <span class="at">study =</span> studies[<span class="sc">!</span>studies <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;CNLSY&quot;</span>, <span class="st">&quot;SLS&quot;</span>)]</span>
<span id="cb348-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-11" tabindex="-1"></a>  , <span class="at">data =</span> <span class="fu">map</span>(<span class="fu">str_to_lower</span>(study), <span class="sc">~</span><span class="fu">loadRData</span>(., <span class="st">&quot;combined&quot;</span>))</span>
<span id="cb348-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-12" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb348-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-13" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb348-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-14" tabindex="-1"></a>                 <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb348-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-15" tabindex="-1"></a>                 <span class="fu">mutate</span>(<span class="at">SID =</span> <span class="fu">as.character</span>(SID)))</span>
<span id="cb348-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-16" tabindex="-1"></a>    , <span class="at">study =</span> <span class="fu">mapvalues</span>(study, studies, studies_long)</span>
<span id="cb348-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-17" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb348-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-18" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb348-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb348-19" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(age), p_year <span class="sc">-</span> yearBrth, age))</span></code></pre></div>
<pre><code>## [1] &quot;~/Documents/projects/data synthesis/crystallized/data/clean/base-i_cleaned.RData&quot;
## [1] &quot;~/Documents/projects/data synthesis/crystallized/data/clean/eas_cleaned.RData&quot;
## [1] &quot;~/Documents/projects/data synthesis/crystallized/data/clean/gsoep_cleaned.RData&quot;
## [1] &quot;~/Documents/projects/data synthesis/crystallized/data/clean/hilda_cleaned.RData&quot;
## [1] &quot;~/Documents/projects/data synthesis/crystallized/data/clean/hrs_cleaned.RData&quot;
## [1] &quot;~/Documents/projects/data synthesis/crystallized/data/clean/lasa_cleaned.RData&quot;
## [1] &quot;~/Documents/projects/data synthesis/crystallized/data/clean/map_cleaned.RData&quot;
## [1] &quot;~/Documents/projects/data synthesis/crystallized/data/clean/mars_cleaned.RData&quot;
## [1] &quot;~/Documents/projects/data synthesis/crystallized/data/clean/octo-twin_cleaned.RData&quot;
## [1] &quot;~/Documents/projects/data synthesis/crystallized/data/clean/ros_cleaned.RData&quot;
## [1] &quot;~/Documents/projects/data synthesis/crystallized/data/clean/satsa_cleaned.RData&quot;</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb350-1" tabindex="-1"></a>ipd3_meta_data</span></code></pre></div>
<pre><code>## # A tibble: 119,597 × 13
##    study Trait p_value p_year SID   Outcome      o_value o_year education gender SRhealth yearBrth   age
##    &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
##  1 BASE  E        3.83   1990 10004 crystallized   2.17    2000        17      0        4     1918    72
##  2 BASE  E        3.83   1990 10010 crystallized   3.08    1995        11      0        2     1911    79
##  3 BASE  E        2.5    1990 10033 crystallized   0.909   1997         8      1        5     1910    80
##  4 BASE  E        3      1990 10034 crystallized   6.54    1995        10      0        5     1914    76
##  5 BASE  E        2.5    1990 10111 crystallized   6.54    1995        13      1        4     1901    89
##  6 BASE  E        3.17   1990 10115 crystallized  10       1995        11      0        2     1918    72
##  7 BASE  E        3      1990 10116 crystallized   3.85    1995        10      0        4     1917    73
##  8 BASE  E        3      1990 10145 crystallized   6.36    1997        10      1        5     1897    93
##  9 BASE  E        3.33   1990 10175 crystallized   2.31    1995         8      1        3     1911    79
## 10 BASE  E        3.33   1990 10188 crystallized   5.77    2004        10      1        2     1903    87
## # ℹ 119,587 more rows</code></pre>
<div id="study-level-moderators-2" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Study-Level Moderators<a href="method-3-two-stage-individual-participant-meta-analysis.html#study-level-moderators-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-1" tabindex="-1"></a>save_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, trait, outcome){</span>
<span id="cb352-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-2" tabindex="-1"></a>  <span class="fu">save</span>(d, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/data/two_stage/meta_data/%s_%s.RData&quot;</span>, local_path, trait, outcome))</span>
<span id="cb352-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-3" tabindex="-1"></a>}</span>
<span id="cb352-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-4" tabindex="-1"></a></span>
<span id="cb352-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-5" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://github.com/emoriebeck/data-synthesis-tutorial/raw/main/codebooks/crystallized_tables.xlsx&quot;</span></span>
<span id="cb352-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-6" tabindex="-1"></a>destfile <span class="ot">&lt;-</span> <span class="st">&quot;tables.xlsx&quot;</span></span>
<span id="cb352-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-7" tabindex="-1"></a>curl<span class="sc">::</span><span class="fu">curl_download</span>(url, destfile)</span>
<span id="cb352-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-8" tabindex="-1"></a></span>
<span id="cb352-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-9" tabindex="-1"></a>ipd_metaMod_data <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(destfile, <span class="at">sheet =</span> <span class="st">&quot;Table 4&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb352-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-10" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Category, <span class="sc">-</span>Construct, <span class="sc">-</span>category) <span class="sc">%&gt;%</span></span>
<span id="cb352-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-11" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;BASE-I&quot;</span><span class="sc">:</span><span class="st">&quot;SATSA&quot;</span>)</span>
<span id="cb352-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-12" tabindex="-1"></a>               , <span class="at">names_to =</span> <span class="st">&quot;study&quot;</span></span>
<span id="cb352-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-13" tabindex="-1"></a>               , <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb352-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-14" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span></span>
<span id="cb352-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-15" tabindex="-1"></a>              , <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb352-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">continent =</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(continent), <span class="at">ref =</span> <span class="st">&quot;North America&quot;</span>)</span>
<span id="cb352-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-17" tabindex="-1"></a>         , <span class="at">country =</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(country), <span class="at">ref =</span> <span class="st">&quot;United States&quot;</span>)</span>
<span id="cb352-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-18" tabindex="-1"></a>         , <span class="at">scale =</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(scale), <span class="at">ref =</span> <span class="st">&quot;NEO-FFI&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb352-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-19" tabindex="-1"></a>  <span class="fu">right_join</span>(</span>
<span id="cb352-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-20" tabindex="-1"></a>    ipd3_meta_data <span class="sc">%&gt;%</span> </span>
<span id="cb352-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-21" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>p_value, <span class="sc">-</span>o_value, <span class="sc">-</span>(education<span class="sc">:</span>yearBrth))</span>
<span id="cb352-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-22" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb352-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-23" tabindex="-1"></a>  <span class="fu">group_by</span>(study, Trait, Outcome) <span class="sc">%&gt;%</span></span>
<span id="cb352-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-24" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">baseAge =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> T) <span class="sc">-</span> <span class="dv">60</span>, <span class="co"># center at age 60</span></span>
<span id="cb352-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-25" tabindex="-1"></a>         <span class="at">predInt =</span> <span class="fu">mean</span>(o_year <span class="sc">-</span> p_year) <span class="sc">-</span> <span class="dv">5</span>, <span class="co"># center at 5 years</span></span>
<span id="cb352-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-26" tabindex="-1"></a>         <span class="at">baseYear =</span> <span class="fu">ifelse</span>(study <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MARS&quot;</span>, <span class="st">&quot;MAP&quot;</span>, <span class="st">&quot;ROS&quot;</span>), <span class="fu">mean</span>(p_year), <span class="fu">mean</span>(p_year) <span class="sc">-</span> <span class="dv">2000</span>)) <span class="sc">%&gt;%</span> <span class="co"># center at 2000</span></span>
<span id="cb352-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-27" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb352-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-28" tabindex="-1"></a>  <span class="fu">select</span>(Trait, Outcome, study, continent, country, scale, baseAge, baseYear, predInt) <span class="sc">%&gt;%</span></span>
<span id="cb352-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-29" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb352-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-30" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait, Outcome) <span class="sc">%&gt;%</span></span>
<span id="cb352-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-31" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb352-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-32" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb352-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb352-33" tabindex="-1"></a>ipd_metaMod_data</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   Trait Outcome      data             
##   &lt;chr&gt; &lt;chr&gt;        &lt;list&gt;           
## 1 A     crystallized &lt;tibble [6 × 7]&gt; 
## 2 C     crystallized &lt;tibble [7 × 7]&gt; 
## 3 E     crystallized &lt;tibble [9 × 7]&gt; 
## 4 N     crystallized &lt;tibble [11 × 7]&gt;
## 5 O     crystallized &lt;tibble [7 × 7]&gt;</code></pre>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb354-1" tabindex="-1"></a>ipd_metaMod_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">pmap</span>(<span class="fu">list</span>(data, Trait, Outcome), save_fun))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   Trait Outcome      data              `pmap(list(data, Trait, Outcome), save_fun)`
##   &lt;chr&gt; &lt;chr&gt;        &lt;list&gt;            &lt;list&gt;                                      
## 1 A     crystallized &lt;tibble [6 × 7]&gt;  &lt;NULL&gt;                                      
## 2 C     crystallized &lt;tibble [7 × 7]&gt;  &lt;NULL&gt;                                      
## 3 E     crystallized &lt;tibble [9 × 7]&gt;  &lt;NULL&gt;                                      
## 4 N     crystallized &lt;tibble [11 × 7]&gt; &lt;NULL&gt;                                      
## 5 O     crystallized &lt;tibble [7 × 7]&gt;  &lt;NULL&gt;</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-1" tabindex="-1"></a>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(destfile, <span class="at">sheet =</span> <span class="st">&quot;Table 4&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb356-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-2" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Category, <span class="sc">-</span>Construct, <span class="sc">-</span>category) <span class="sc">%&gt;%</span></span>
<span id="cb356-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-3" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;BASE-I&quot;</span><span class="sc">:</span><span class="st">&quot;SATSA&quot;</span>)</span>
<span id="cb356-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-4" tabindex="-1"></a>                 , <span class="at">names_to =</span> <span class="st">&quot;study&quot;</span></span>
<span id="cb356-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-5" tabindex="-1"></a>                 , <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb356-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-6" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span></span>
<span id="cb356-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-7" tabindex="-1"></a>                , <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb356-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-8" tabindex="-1"></a>    <span class="fu">right_join</span>(</span>
<span id="cb356-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-9" tabindex="-1"></a>        ipd3_meta_data <span class="sc">%&gt;%</span> </span>
<span id="cb356-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-10" tabindex="-1"></a>            <span class="fu">select</span>(<span class="sc">-</span>p_value, <span class="sc">-</span>o_value, <span class="sc">-</span>(education<span class="sc">:</span>yearBrth))</span>
<span id="cb356-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-11" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb356-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-12" tabindex="-1"></a>    <span class="fu">group_by</span>(study, Trait, Outcome) <span class="sc">%&gt;%</span></span>
<span id="cb356-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-13" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">baseAge =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> T), <span class="co"># center at age 60</span></span>
<span id="cb356-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-14" tabindex="-1"></a>           <span class="at">baseAgeSD =</span> <span class="fu">sd</span>(age, <span class="at">na.rm =</span> T), <span class="co"># center at age 60</span></span>
<span id="cb356-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-15" tabindex="-1"></a>           <span class="at">predInt =</span> <span class="fu">mean</span>(o_year <span class="sc">-</span> p_year), <span class="co"># center at 5 years</span></span>
<span id="cb356-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-16" tabindex="-1"></a>           <span class="at">predIntSD =</span> <span class="fu">sd</span>(o_year <span class="sc">-</span> p_year), <span class="co"># center at 5 years</span></span>
<span id="cb356-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-17" tabindex="-1"></a>           <span class="at">baseYear =</span> <span class="fu">ifelse</span>(study <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MARS&quot;</span>, <span class="st">&quot;MAP&quot;</span>, <span class="st">&quot;ROS&quot;</span>), <span class="fu">median</span>(p_year), <span class="fu">median</span>(p_year)),</span>
<span id="cb356-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-18" tabindex="-1"></a>           <span class="at">baseYearSD =</span> <span class="fu">ifelse</span>(study <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MARS&quot;</span>, <span class="st">&quot;MAP&quot;</span>, <span class="st">&quot;ROS&quot;</span>), <span class="fu">sd</span>(p_year), <span class="fu">sd</span>(p_year)),</span>
<span id="cb356-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-19" tabindex="-1"></a>           <span class="at">cogYear =</span> <span class="fu">ifelse</span>(study <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MARS&quot;</span>, <span class="st">&quot;MAP&quot;</span>, <span class="st">&quot;ROS&quot;</span>), <span class="fu">median</span>(o_year), <span class="fu">median</span>(o_year)),</span>
<span id="cb356-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-20" tabindex="-1"></a>           <span class="at">cogYearSD =</span> <span class="fu">ifelse</span>(study <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MARS&quot;</span>, <span class="st">&quot;MAP&quot;</span>, <span class="st">&quot;ROS&quot;</span>), <span class="fu">sd</span>(o_year), <span class="fu">sd</span>(o_year))) <span class="sc">%&gt;%</span> <span class="co"># center at 2000</span></span>
<span id="cb356-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-21" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb356-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-22" tabindex="-1"></a>    <span class="fu">select</span>(Trait, Outcome, study, continent, country, scale, baseAge, baseAgeSD, baseYear, baseYearSD, cogYear, cogYearSD, predInt, predIntSD) <span class="sc">%&gt;%</span></span>
<span id="cb356-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-23" tabindex="-1"></a>    <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb356-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-24" tabindex="-1"></a>  <span class="fu">group_by</span>(study, Outcome) <span class="sc">%&gt;%</span></span>
<span id="cb356-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-25" tabindex="-1"></a>  <span class="fu">summarize_at</span>(<span class="fu">vars</span>(baseAge<span class="sc">:</span>predIntSD), mean) <span class="sc">%&gt;%</span></span>
<span id="cb356-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-26" tabindex="-1"></a>  <span class="fu">kable</span>(., <span class="st">&quot;html&quot;</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb356-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb356-27" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">&quot;Times New Roman&quot;</span>) </span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: Times New Roman; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
study
</th>
<th style="text-align:left;">
Outcome
</th>
<th style="text-align:right;">
baseAge
</th>
<th style="text-align:right;">
baseAgeSD
</th>
<th style="text-align:right;">
baseYear
</th>
<th style="text-align:right;">
baseYearSD
</th>
<th style="text-align:right;">
cogYear
</th>
<th style="text-align:right;">
cogYearSD
</th>
<th style="text-align:right;">
predInt
</th>
<th style="text-align:right;">
predIntSD
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
BASE
</td>
<td style="text-align:left;">
crystallized
</td>
<td style="text-align:right;">
78.23
</td>
<td style="text-align:right;">
6.66
</td>
<td style="text-align:right;">
1990
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
1997.00
</td>
<td style="text-align:right;">
3.51
</td>
<td style="text-align:right;">
8.56
</td>
<td style="text-align:right;">
3.51
</td>
</tr>
<tr>
<td style="text-align:left;">
EAS
</td>
<td style="text-align:left;">
crystallized
</td>
<td style="text-align:right;">
79.47
</td>
<td style="text-align:right;">
5.36
</td>
<td style="text-align:right;">
2011
</td>
<td style="text-align:right;">
3.18
</td>
<td style="text-align:right;">
2014.00
</td>
<td style="text-align:right;">
3.09
</td>
<td style="text-align:right;">
2.15
</td>
<td style="text-align:right;">
2.41
</td>
</tr>
<tr>
<td style="text-align:left;">
GSOEP
</td>
<td style="text-align:left;">
crystallized
</td>
<td style="text-align:right;">
49.83
</td>
<td style="text-align:right;">
15.83
</td>
<td style="text-align:right;">
2005
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
2012.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
7.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
HILDA
</td>
<td style="text-align:left;">
crystallized
</td>
<td style="text-align:right;">
44.51
</td>
<td style="text-align:right;">
16.92
</td>
<td style="text-align:right;">
2005
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
2012.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
7.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
HRS
</td>
<td style="text-align:left;">
crystallized
</td>
<td style="text-align:right;">
71.71
</td>
<td style="text-align:right;">
6.97
</td>
<td style="text-align:right;">
2006
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
2010.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
LASA
</td>
<td style="text-align:left;">
crystallized
</td>
<td style="text-align:right;">
61.46
</td>
<td style="text-align:right;">
15.71
</td>
<td style="text-align:right;">
1992
</td>
<td style="text-align:right;">
1.19
</td>
<td style="text-align:right;">
1995.00
</td>
<td style="text-align:right;">
9.09
</td>
<td style="text-align:right;">
8.39
</td>
<td style="text-align:right;">
9.45
</td>
</tr>
<tr>
<td style="text-align:left;">
MAP
</td>
<td style="text-align:left;">
crystallized
</td>
<td style="text-align:right;">
79.45
</td>
<td style="text-align:right;">
7.32
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
6.33
</td>
<td style="text-align:right;">
4.53
</td>
<td style="text-align:right;">
6.75
</td>
<td style="text-align:right;">
4.53
</td>
</tr>
<tr>
<td style="text-align:left;">
MARS
</td>
<td style="text-align:left;">
crystallized
</td>
<td style="text-align:right;">
73.60
</td>
<td style="text-align:right;">
6.37
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
6.00
</td>
<td style="text-align:right;">
3.86
</td>
<td style="text-align:right;">
6.46
</td>
<td style="text-align:right;">
3.86
</td>
</tr>
<tr>
<td style="text-align:left;">
OCTO-Twin
</td>
<td style="text-align:left;">
crystallized
</td>
<td style="text-align:right;">
82.99
</td>
<td style="text-align:right;">
2.66
</td>
<td style="text-align:right;">
1991
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
1997.00
</td>
<td style="text-align:right;">
2.82
</td>
<td style="text-align:right;">
6.21
</td>
<td style="text-align:right;">
2.82
</td>
</tr>
<tr>
<td style="text-align:left;">
ROS
</td>
<td style="text-align:left;">
crystallized
</td>
<td style="text-align:right;">
75.87
</td>
<td style="text-align:right;">
7.38
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
8.00
</td>
<td style="text-align:right;">
6.42
</td>
<td style="text-align:right;">
9.53
</td>
<td style="text-align:right;">
6.42
</td>
</tr>
<tr>
<td style="text-align:left;">
SATSA
</td>
<td style="text-align:left;">
crystallized
</td>
<td style="text-align:right;">
54.77
</td>
<td style="text-align:right;">
9.84
</td>
<td style="text-align:right;">
1984
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
1999.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
15.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
</tbody>
</table>
</div>
<div id="harmonize-data-2" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Harmonize Data<a href="method-3-two-stage-individual-participant-meta-analysis.html#harmonize-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb357-1" tabindex="-1"></a>ipd3_meta_data <span class="ot">&lt;-</span> ipd3_meta_data <span class="sc">%&gt;%</span></span>
<span id="cb357-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb357-2" tabindex="-1"></a>  <span class="fu">group_by</span>(study, Trait, Outcome) <span class="sc">%&gt;%</span></span>
<span id="cb357-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb357-3" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(p_value, o_value, SRhealth), </span>
<span id="cb357-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb357-4" tabindex="-1"></a>            <span class="sc">~</span>((. <span class="sc">-</span> <span class="fu">min</span>(., <span class="at">na.rm =</span> T))<span class="sc">/</span>(<span class="fu">max</span>(., <span class="at">na.rm =</span> T) <span class="sc">-</span> <span class="fu">min</span>(., <span class="at">na.rm =</span> T))<span class="sc">*</span><span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb357-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb357-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>)),</span>
<span id="cb357-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb357-6" tabindex="-1"></a>         <span class="at">education =</span> education <span class="sc">-</span> <span class="dv">12</span>,</span>
<span id="cb357-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb357-7" tabindex="-1"></a>         <span class="at">age =</span> age <span class="sc">-</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb357-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb357-8" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb357-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb357-9" tabindex="-1"></a>ipd3_meta_data</span></code></pre></div>
<pre><code>## # A tibble: 119,597 × 13
##    study Trait p_value p_year SID   Outcome      o_value o_year education gender SRhealth yearBrth    age
##    &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
##  1 BASE  E         7     1990 10004 crystallized   2.17    2000         5 Male        7.5     1918 -6.23 
##  2 BASE  E         7     1990 10010 crystallized   3.08    1995        -1 Male        2.5     1911  0.766
##  3 BASE  E         3     1990 10033 crystallized   0.909   1997        -4 Female     10       1910  1.77 
##  4 BASE  E         4.5   1990 10034 crystallized   6.54    1995        -2 Male       10       1914 -2.23 
##  5 BASE  E         3     1990 10111 crystallized   6.54    1995         1 Female      7.5     1901 10.8  
##  6 BASE  E         5     1990 10115 crystallized  10       1995        -1 Male        2.5     1918 -6.23 
##  7 BASE  E         4.5   1990 10116 crystallized   3.85    1995        -2 Male        7.5     1917 -5.23 
##  8 BASE  E         4.5   1990 10145 crystallized   6.36    1997        -2 Female     10       1897 14.8  
##  9 BASE  E         5.5   1990 10175 crystallized   2.31    1995        -4 Female      5       1911  0.766
## 10 BASE  E         5.5   1990 10188 crystallized   5.77    2004        -2 Female      2.5     1903  8.77 
## # ℹ 119,587 more rows</code></pre>
</div>
<div id="save-data-files-2" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Save Data Files<a href="method-3-two-stage-individual-participant-meta-analysis.html#save-data-files-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb359-1" tabindex="-1"></a>save_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, trait, outcome, study){</span>
<span id="cb359-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb359-2" tabindex="-1"></a>  <span class="fu">save</span>(d, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/data/two_stage/%s_%s_%s.RData&quot;</span>, local_path, trait, outcome, study))</span>
<span id="cb359-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb359-3" tabindex="-1"></a>}</span>
<span id="cb359-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb359-4" tabindex="-1"></a></span>
<span id="cb359-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb359-5" tabindex="-1"></a>ipd3_meta_data <span class="sc">%&gt;%</span></span>
<span id="cb359-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb359-6" tabindex="-1"></a>  <span class="fu">group_by</span>(study, Trait, Outcome) <span class="sc">%&gt;%</span></span>
<span id="cb359-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb359-7" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb359-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb359-8" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb359-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb359-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(data, Trait, Outcome, study), save_fun))</span></code></pre></div>
<pre><code>## # A tibble: 40 × 4
##    study Trait Outcome      data  
##    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;        &lt;list&gt;
##  1 BASE  E     crystallized &lt;NULL&gt;
##  2 BASE  N     crystallized &lt;NULL&gt;
##  3 BASE  O     crystallized &lt;NULL&gt;
##  4 EAS   A     crystallized &lt;NULL&gt;
##  5 EAS   C     crystallized &lt;NULL&gt;
##  6 EAS   E     crystallized &lt;NULL&gt;
##  7 EAS   N     crystallized &lt;NULL&gt;
##  8 EAS   O     crystallized &lt;NULL&gt;
##  9 GSOEP A     crystallized &lt;NULL&gt;
## 10 GSOEP C     crystallized &lt;NULL&gt;
## # ℹ 30 more rows</code></pre>
</div>
</div>
<div id="step-2-run-models-for-each-study" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Step 2: Run Models for Each Study<a href="method-3-two-stage-individual-participant-meta-analysis.html#step-2-run-models-for-each-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="functions" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Functions<a href="method-3-two-stage-individual-participant-meta-analysis.html#functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="model-function-4" class="section level4 hasAnchor" number="5.3.1.1">
<h4><span class="header-section-number">5.3.1.1</span> Model Function<a href="method-3-two-stage-individual-participant-meta-analysis.html#model-function-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-1" tabindex="-1"></a>ipd3_study_mod_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(trait, outcome, type, mod, study, cov){</span>
<span id="cb361-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-2" tabindex="-1"></a>  <span class="do">## load the data</span></span>
<span id="cb361-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-3" tabindex="-1"></a>  <span class="fu">load</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/data/two_stage/%s_%s_%s.RData&quot;</span>, local_path, trait, outcome, study))</span>
<span id="cb361-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-4" tabindex="-1"></a>  </span>
<span id="cb361-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-5" tabindex="-1"></a>  <span class="do">## compiled Bayesian model to speed up processing and avoid crashing</span></span>
<span id="cb361-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-6" tabindex="-1"></a>  <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">&quot;Bayesian&quot;</span>) <span class="fu">load</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/bayes_sample_mod.RData&quot;</span>, local_path))</span>
<span id="cb361-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-7" tabindex="-1"></a>  </span>
<span id="cb361-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-8" tabindex="-1"></a>  <span class="do">## model formula </span></span>
<span id="cb361-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-9" tabindex="-1"></a>  <span class="cf">if</span> (cov <span class="sc">==</span> <span class="st">&quot;all&quot;</span>) cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;education&quot;</span>)</span>
<span id="cb361-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-10" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>cov <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;all&quot;</span>, <span class="st">&quot;none&quot;</span>)) cv <span class="ot">&lt;-</span> cov</span>
<span id="cb361-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-11" tabindex="-1"></a>  rhs <span class="ot">&lt;-</span> <span class="st">&quot;p_value&quot;</span></span>
<span id="cb361-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-12" tabindex="-1"></a>  rhs <span class="ot">&lt;-</span> <span class="cf">if</span>(cov <span class="sc">!=</span> <span class="st">&quot;none&quot;</span>) <span class="fu">c</span>(rhs, cv) <span class="cf">else</span> rhs</span>
<span id="cb361-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-13" tabindex="-1"></a>  <span class="cf">if</span>(mod <span class="sc">!=</span> <span class="st">&quot;none&quot;</span>){rhs <span class="ot">&lt;-</span> <span class="fu">c</span>(rhs, <span class="fu">paste</span>(<span class="st">&quot;p_value&quot;</span>, mod, <span class="at">sep =</span> <span class="st">&quot;*&quot;</span>))}</span>
<span id="cb361-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-14" tabindex="-1"></a>  rhs <span class="ot">&lt;-</span> <span class="fu">paste</span>(rhs, <span class="at">collapse =</span> <span class="st">&quot; + &quot;</span>)</span>
<span id="cb361-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-15" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;o_value ~ &quot;</span>, rhs, <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb361-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-16" tabindex="-1"></a>  </span>
<span id="cb361-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-17" tabindex="-1"></a>  <span class="do">## run the models &amp; save</span></span>
<span id="cb361-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-18" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">&quot;Frequentist&quot;</span>){<span class="fu">do.call</span>(<span class="st">&quot;lm&quot;</span>, <span class="fu">list</span>(<span class="at">formula =</span> f, <span class="at">data =</span> <span class="fu">quote</span>(d)))} <span class="cf">else</span> {<span class="fu">update</span>(m, <span class="at">formula =</span> f, <span class="at">newdata =</span> d, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">cores =</span> <span class="dv">1</span>)}</span>
<span id="cb361-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-19" tabindex="-1"></a>  <span class="fu">save</span>(m, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/studyModels/%s_%s_%s_%s_%s.RData&quot;</span></span>
<span id="cb361-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-20" tabindex="-1"></a>                         , local_path, type, outcome, trait, mod, cov, study))</span>
<span id="cb361-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-21" tabindex="-1"></a>  </span>
<span id="cb361-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-22" tabindex="-1"></a>  <span class="do">## extract model terms and confidence intervals &amp; save</span></span>
<span id="cb361-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-23" tabindex="-1"></a>  rx <span class="ot">&lt;-</span> <span class="fu">tidy</span>(m, <span class="at">conf.int =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb361-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-24" tabindex="-1"></a>    <span class="fu">select</span>(term, estimate, conf.low, conf.high)</span>
<span id="cb361-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-25" tabindex="-1"></a>  <span class="fu">save</span>(rx, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/studySummary/%s_%s_%s_%s_%s.RData&quot;</span></span>
<span id="cb361-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-26" tabindex="-1"></a>                          , local_path, type, outcome, trait, mod, cov, study))</span>
<span id="cb361-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-27" tabindex="-1"></a>    </span>
<span id="cb361-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-28" tabindex="-1"></a>  <span class="do">## calculate effect sizes for random effects meta analysis</span></span>
<span id="cb361-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-29" tabindex="-1"></a>  es <span class="ot">&lt;-</span> <span class="fu">ipd3_es_fun</span>(m, type, mod)</span>
<span id="cb361-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-30" tabindex="-1"></a>  <span class="fu">save</span>(es, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/studyEffects/%s_%s_%s_%s_%s.RData&quot;</span></span>
<span id="cb361-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-31" tabindex="-1"></a>                          , local_path, type, outcome, trait, mod, cov, study))</span>
<span id="cb361-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-32" tabindex="-1"></a>  </span>
<span id="cb361-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-33" tabindex="-1"></a>  <span class="do">## calculate simple effects  </span></span>
<span id="cb361-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-34" tabindex="-1"></a>  <span class="cf">if</span>(mod <span class="sc">!=</span> <span class="st">&quot;none&quot;</span>){</span>
<span id="cb361-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-35" tabindex="-1"></a>    pred.rx <span class="ot">&lt;-</span> <span class="fu">ipd3_study_simpeff_fun</span>(m, mod, type)</span>
<span id="cb361-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-36" tabindex="-1"></a>    <span class="fu">save</span>(pred.rx, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/studyPredicted/%s_%s_%s_%s_%s.RData&quot;</span></span>
<span id="cb361-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-37" tabindex="-1"></a>                                 , local_path, type, outcome, trait, mod, cov, study))</span>
<span id="cb361-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-38" tabindex="-1"></a>  }</span>
<span id="cb361-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-39" tabindex="-1"></a>  </span>
<span id="cb361-40"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-40" tabindex="-1"></a>  <span class="do">## clean up the local function environment</span></span>
<span id="cb361-41"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-41" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">c</span>(<span class="st">&quot;d&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;fx&quot;</span>, <span class="st">&quot;es&quot;</span>, <span class="st">&quot;rhs&quot;</span>))</span>
<span id="cb361-42"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-42" tabindex="-1"></a>  <span class="fu">gc</span>()</span>
<span id="cb361-43"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb361-43" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="effect-size-function" class="section level4 hasAnchor" number="5.3.1.2">
<h4><span class="header-section-number">5.3.1.2</span> Effect Size Function<a href="method-3-two-stage-individual-participant-meta-analysis.html#effect-size-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-1" tabindex="-1"></a>ipd3_es_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(m, type, mod){</span>
<span id="cb362-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-2" tabindex="-1"></a>  <span class="do">## extract model features needed for meta-analysis</span></span>
<span id="cb362-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-3" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> insight<span class="sc">::</span><span class="fu">clean_parameters</span>(m)<span class="sc">$</span>Cleaned_Parameter</span>
<span id="cb362-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-4" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="cf">if</span>(mod <span class="sc">==</span> <span class="st">&quot;none&quot;</span>) <span class="st">&quot;p_value&quot;</span> <span class="cf">else</span> ts[<span class="fu">grepl</span>(<span class="st">&quot;p_value.&quot;</span>, ts)]</span>
<span id="cb362-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-5" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(ts, <span class="st">&quot;[.]&quot;</span>, <span class="st">&quot;:&quot;</span>)</span>
<span id="cb362-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-6" tabindex="-1"></a>  <span class="do">## standardize the model </span></span>
<span id="cb362-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-7" tabindex="-1"></a>  <span class="co"># ms &lt;- standardize(m)</span></span>
<span id="cb362-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-8" tabindex="-1"></a>  <span class="do">## get standardized model coefficients and standard errors</span></span>
<span id="cb362-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-9" tabindex="-1"></a>  <span class="do">## for bayesian models this is the sd of the posterior estimates</span></span>
<span id="cb362-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-10" tabindex="-1"></a>  es <span class="ot">&lt;-</span> <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">&quot;Frequentist&quot;</span>){ </span>
<span id="cb362-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-11" tabindex="-1"></a>    <span class="fu">summary</span>(m)<span class="sc">$</span>coef[<span class="fu">c</span>(<span class="st">&quot;(Intercept)&quot;</span>, ts), <span class="fu">c</span>(<span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>)] <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;SEI&quot;</span>))</span>
<span id="cb362-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-12" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb362-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-13" tabindex="-1"></a>      <span class="fu">fixef</span>(m)[<span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, ts), <span class="fu">c</span>(<span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Est.Error&quot;</span>)]  <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;SEI&quot;</span>))</span>
<span id="cb362-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-14" tabindex="-1"></a>    }</span>
<span id="cb362-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-15" tabindex="-1"></a>  <span class="do">## format to standardized format</span></span>
<span id="cb362-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-16" tabindex="-1"></a>  es <span class="ot">&lt;-</span> es <span class="sc">%&gt;%</span></span>
<span id="cb362-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-17" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb362-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-18" tabindex="-1"></a>    <span class="co"># t() %&gt;% </span></span>
<span id="cb362-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-19" tabindex="-1"></a>    <span class="co"># as.data.frame() %&gt;% </span></span>
<span id="cb362-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-20" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ni =</span> <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">&quot;Frequentist&quot;</span>) {<span class="fu">nrow</span>(m<span class="sc">$</span>model)} <span class="cf">else</span> {<span class="fu">nrow</span>(m<span class="sc">$</span>data)})</span>
<span id="cb362-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-21" tabindex="-1"></a>  <span class="fu">return</span>(es)</span>
<span id="cb362-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb362-22" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="study-specific-simple-effects-function" class="section level4 hasAnchor" number="5.3.1.3">
<h4><span class="header-section-number">5.3.1.3</span> Study-Specific Simple Effects Function<a href="method-3-two-stage-individual-participant-meta-analysis.html#study-specific-simple-effects-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-1" tabindex="-1"></a>ipd3_study_simpeff_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(m, moder, type){</span>
<span id="cb363-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-2" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">&quot;Bayesian&quot;</span>) m<span class="sc">$</span>data <span class="cf">else</span> m<span class="sc">$</span>model</span>
<span id="cb363-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-3" tabindex="-1"></a>  d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>o_value, <span class="sc">-</span>p_value)</span>
<span id="cb363-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-4" tabindex="-1"></a>  cols <span class="ot">&lt;-</span> <span class="fu">colnames</span>(d)</span>
<span id="cb363-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-5" tabindex="-1"></a>  md_cl <span class="ot">&lt;-</span> <span class="fu">class</span>(d[,moder])</span>
<span id="cb363-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-6" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">sapply</span>(d, class) <span class="sc">==</span> <span class="st">&quot;numeric&quot;</span>)){</span>
<span id="cb363-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-7" tabindex="-1"></a>    msd <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb363-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-8" tabindex="-1"></a>      <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb363-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-9" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()</span>
<span id="cb363-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-10" tabindex="-1"></a>                   , <span class="at">names_to =</span> <span class="st">&quot;item&quot;</span></span>
<span id="cb363-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-11" tabindex="-1"></a>                   , <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb363-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-12" tabindex="-1"></a>      <span class="fu">group_by</span>(item) <span class="sc">%&gt;%</span></span>
<span id="cb363-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-13" tabindex="-1"></a>      <span class="fu">summarize_at</span>(<span class="fu">vars</span>(value), <span class="fu">lst</span>(mean, sd)) <span class="sc">%&gt;%</span></span>
<span id="cb363-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-14" tabindex="-1"></a>      <span class="fu">ungroup</span>()</span>
<span id="cb363-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-15" tabindex="-1"></a>  }</span>
<span id="cb363-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-16" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">sapply</span>(d, class) <span class="sc">==</span> <span class="st">&quot;factor&quot;</span>)){</span>
<span id="cb363-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-17" tabindex="-1"></a>    fct_lev <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb363-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-18" tabindex="-1"></a>      <span class="fu">select_if</span>(is.factor) <span class="sc">%&gt;%</span></span>
<span id="cb363-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-19" tabindex="-1"></a>      <span class="fu">summarize_all</span>(<span class="sc">~</span><span class="fu">list</span>(<span class="fu">unique</span>(.)))</span>
<span id="cb363-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-20" tabindex="-1"></a>  }</span>
<span id="cb363-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-21" tabindex="-1"></a>  d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(moder))</span>
<span id="cb363-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-22" tabindex="-1"></a>  md_levs <span class="ot">&lt;-</span> <span class="cf">if</span>(md_cl <span class="sc">==</span> <span class="st">&quot;numeric&quot;</span>){</span>
<span id="cb363-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-23" tabindex="-1"></a>    <span class="cf">if</span>(moder <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;baseAge&quot;</span>, <span class="st">&quot;baseYear&quot;</span>)) {</span>
<span id="cb363-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-24" tabindex="-1"></a>      <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb363-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-25" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (moder <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;predInt&quot;</span>, <span class="st">&quot;education&quot;</span>)) {</span>
<span id="cb363-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-26" tabindex="-1"></a>      <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>) </span>
<span id="cb363-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-27" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb363-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-28" tabindex="-1"></a>        <span class="fu">with</span>(msd, <span class="fu">c</span>(mean[item <span class="sc">==</span> moder] <span class="sc">-</span> sd[item <span class="sc">==</span> moder], mean[item <span class="sc">==</span> moder], mean[item <span class="sc">==</span> moder] <span class="sc">+</span> sd[item <span class="sc">==</span> moder]))</span>
<span id="cb363-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-29" tabindex="-1"></a>      }</span>
<span id="cb363-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-30" tabindex="-1"></a>  } <span class="cf">else</span> { </span>
<span id="cb363-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-31" tabindex="-1"></a>    <span class="fu">unique</span>(fct_lev[,moder][[<span class="dv">1</span>]])</span>
<span id="cb363-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-32" tabindex="-1"></a>  }</span>
<span id="cb363-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-33" tabindex="-1"></a>  </span>
<span id="cb363-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-34" tabindex="-1"></a>  mod_frame <span class="ot">&lt;-</span> <span class="fu">crossing</span>(</span>
<span id="cb363-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-35" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,.<span class="dv">5</span>)</span>
<span id="cb363-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-36" tabindex="-1"></a>    , <span class="at">modvalue =</span> md_levs</span>
<span id="cb363-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-37" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;p_value&quot;</span>, moder))</span>
<span id="cb363-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-38" tabindex="-1"></a>  </span>
<span id="cb363-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-39" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">ncol</span>(d) <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb363-40"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-40" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">sapply</span>(d, class) <span class="sc">==</span> <span class="st">&quot;numeric&quot;</span>)){</span>
<span id="cb363-41"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-41" tabindex="-1"></a>      mod_frame <span class="ot">&lt;-</span> <span class="fu">tibble</span>(mod_frame, d <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span> <span class="fu">summarize_all</span>(mean))</span>
<span id="cb363-42"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-42" tabindex="-1"></a>    } </span>
<span id="cb363-43"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-43" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">sapply</span>(d, class) <span class="sc">==</span> <span class="st">&quot;factor&quot;</span>)){</span>
<span id="cb363-44"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-44" tabindex="-1"></a>      mod_frame <span class="ot">&lt;-</span> <span class="fu">tibble</span>(mod_frame, d <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.factor) <span class="sc">%&gt;%</span> <span class="fu">summarize_all</span>(<span class="sc">~</span><span class="fu">levels</span>(.)[<span class="dv">1</span>]))</span>
<span id="cb363-45"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-45" tabindex="-1"></a>    }</span>
<span id="cb363-46"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-46" tabindex="-1"></a>  }</span>
<span id="cb363-47"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-47" tabindex="-1"></a>  </span>
<span id="cb363-48"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-48" tabindex="-1"></a>  pred.fx <span class="ot">&lt;-</span> <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">&quot;Bayesian&quot;</span>){</span>
<span id="cb363-49"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-49" tabindex="-1"></a>    <span class="fu">bind_cols</span>(</span>
<span id="cb363-50"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-50" tabindex="-1"></a>      mod_frame, </span>
<span id="cb363-51"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-51" tabindex="-1"></a>      <span class="fu">fitted</span>(m, <span class="at">newdata =</span> mod_frame) <span class="sc">%&gt;%</span> data.frame</span>
<span id="cb363-52"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-52" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb363-53"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-53" tabindex="-1"></a>      <span class="fu">select</span>(<span class="fu">one_of</span>(<span class="fu">colnames</span>(m<span class="sc">$</span>data)), <span class="at">pred =</span> Estimate, <span class="at">lower =</span> Q2<span class="fl">.5</span>, <span class="at">upper =</span> Q97<span class="fl">.5</span>)</span>
<span id="cb363-54"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-54" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb363-55"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-55" tabindex="-1"></a>    <span class="fu">bind_cols</span>(</span>
<span id="cb363-56"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-56" tabindex="-1"></a>      mod_frame, </span>
<span id="cb363-57"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-57" tabindex="-1"></a>      <span class="fu">predict</span>(m, <span class="at">newdata =</span> mod_frame, <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>) <span class="sc">%&gt;%</span> data.frame </span>
<span id="cb363-58"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-58" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb363-59"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-59" tabindex="-1"></a>      <span class="fu">select</span>(<span class="fu">one_of</span>(<span class="fu">colnames</span>(m<span class="sc">$</span>model)), <span class="at">pred =</span> fit, <span class="at">lower =</span> lwr, <span class="at">upper =</span> upr)</span>
<span id="cb363-60"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-60" tabindex="-1"></a>  }</span>
<span id="cb363-61"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-61" tabindex="-1"></a>  </span>
<span id="cb363-62"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-62" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">c</span>(<span class="st">&quot;m&quot;</span>, <span class="st">&quot;mod_frame&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;md_levs&quot;</span>))</span>
<span id="cb363-63"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-63" tabindex="-1"></a>  <span class="fu">gc</span>()</span>
<span id="cb363-64"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-64" tabindex="-1"></a>  <span class="fu">return</span>(pred.fx)</span>
<span id="cb363-65"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb363-65" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="run-models" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Run Models<a href="method-3-two-stage-individual-participant-meta-analysis.html#run-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-1" tabindex="-1"></a><span class="co"># done &lt;- tibble(file = list.files(sprintf(&quot;%s/results/3_ipd_meta/Bayesian/studyModels&quot;, local_path))) %&gt;%</span></span>
<span id="cb364-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-2" tabindex="-1"></a><span class="co">#   separate(file, c(&quot;Outcome&quot;, &quot;Trait&quot;, &quot;Moderator&quot;, &quot;Covariate&quot;, &quot;study&quot;), sep = &quot;_&quot;) %&gt;%</span></span>
<span id="cb364-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-3" tabindex="-1"></a><span class="co">#   mutate(study = str_remove_all(study, &quot;.RData&quot;),</span></span>
<span id="cb364-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-4" tabindex="-1"></a><span class="co">#          done = &quot;done&quot;)</span></span>
<span id="cb364-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-5" tabindex="-1"></a><span class="fu">plan</span>(<span class="fu">multisession</span>(<span class="at">workers =</span> <span class="dv">12</span><span class="dt">L</span>))</span>
<span id="cb364-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-6" tabindex="-1"></a>nested_ipd_reg <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">files =</span> <span class="fu">list.files</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/data/two_stage&quot;</span>, local_path))) <span class="sc">%&gt;%</span></span>
<span id="cb364-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-7" tabindex="-1"></a>  <span class="fu">separate</span>(files, <span class="fu">c</span>(<span class="st">&quot;Trait&quot;</span>, <span class="st">&quot;Outcome&quot;</span>, <span class="st">&quot;study&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb364-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-8" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(study)) <span class="sc">%&gt;%</span></span>
<span id="cb364-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">study =</span> <span class="fu">str_remove</span>(study, <span class="st">&quot;.RData&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb364-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-10" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb364-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-11" tabindex="-1"></a>    <span class="fu">crossing</span>(</span>
<span id="cb364-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-12" tabindex="-1"></a>      <span class="at">study =</span> studies</span>
<span id="cb364-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-13" tabindex="-1"></a>      , <span class="at">Trait =</span> traits<span class="sc">$</span>short_name</span>
<span id="cb364-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-14" tabindex="-1"></a>      , <span class="at">Outcome =</span> outcomes<span class="sc">$</span>short_name</span>
<span id="cb364-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-15" tabindex="-1"></a>      , <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;Frequentist&quot;</span>, <span class="st">&quot;Bayesian&quot;</span>)</span>
<span id="cb364-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-16" tabindex="-1"></a>      , <span class="at">Moderator =</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;education&quot;</span>)</span>
<span id="cb364-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-17" tabindex="-1"></a>      , <span class="at">Covariate =</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;all&quot;</span>)</span>
<span id="cb364-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-18" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb364-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-19" tabindex="-1"></a>      <span class="fu">full_join</span>(</span>
<span id="cb364-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-20" tabindex="-1"></a>        <span class="fu">crossing</span>(</span>
<span id="cb364-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-21" tabindex="-1"></a>          <span class="at">study =</span> studies</span>
<span id="cb364-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-22" tabindex="-1"></a>          , <span class="at">Trait =</span> traits<span class="sc">$</span>short_name</span>
<span id="cb364-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-23" tabindex="-1"></a>          , <span class="at">Outcome =</span> outcomes<span class="sc">$</span>short_name</span>
<span id="cb364-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-24" tabindex="-1"></a>          , <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;Frequentist&quot;</span>, <span class="st">&quot;Bayesian&quot;</span>)</span>
<span id="cb364-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-25" tabindex="-1"></a>          , <span class="at">Moderator =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb364-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-26" tabindex="-1"></a>          , <span class="at">Covariate =</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;all&quot;</span>)</span>
<span id="cb364-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-27" tabindex="-1"></a>          )</span>
<span id="cb364-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-28" tabindex="-1"></a>        )</span>
<span id="cb364-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-29" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb364-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-30" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Covariate)) <span class="sc">%&gt;%</span></span>
<span id="cb364-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-31" tabindex="-1"></a>  <span class="co"># full_join(done) %&gt;% filter(is.na(done)) %&gt;%</span></span>
<span id="cb364-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-32" tabindex="-1"></a>  <span class="co"># filter(type == &quot;Frequentist&quot;) %&gt;%</span></span>
<span id="cb364-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-33" tabindex="-1"></a>  <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;N&quot;</span> <span class="sc">&amp;</span> study <span class="sc">==</span> <span class="st">&quot;HILDA&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb364-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-34" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">run =</span> </span>
<span id="cb364-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-35" tabindex="-1"></a>           <span class="co"># pmap(list(Trait, Outcome, type, Moderator, study, Covariate)</span></span>
<span id="cb364-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-36" tabindex="-1"></a>           <span class="fu">future_pmap</span>(<span class="fu">list</span>(Trait, Outcome, type, Moderator, study, Covariate)</span>
<span id="cb364-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-37" tabindex="-1"></a>                    , <span class="fu">possibly</span>(ipd3_study_mod_fun, <span class="cn">NA_real_</span>)</span>
<span id="cb364-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-38" tabindex="-1"></a>                    , <span class="at">.progress =</span> T</span>
<span id="cb364-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-39" tabindex="-1"></a>             , <span class="at">.options =</span> <span class="fu">furrr_options</span>(</span>
<span id="cb364-40"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-40" tabindex="-1"></a>                                    <span class="at">globals =</span> <span class="fu">c</span>(<span class="st">&quot;ipd3_es_fun&quot;</span></span>
<span id="cb364-41"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-41" tabindex="-1"></a>                                                , <span class="st">&quot;ipd3_study_simpeff_fun&quot;</span></span>
<span id="cb364-42"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-42" tabindex="-1"></a>                                                , <span class="st">&quot;read_path&quot;</span></span>
<span id="cb364-43"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-43" tabindex="-1"></a>                                                , <span class="st">&quot;local_path&quot;</span></span>
<span id="cb364-44"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-44" tabindex="-1"></a>                                                , <span class="st">&quot;res_path&quot;</span></span>
<span id="cb364-45"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-45" tabindex="-1"></a>                                                , <span class="st">&quot;codebook&quot;</span></span>
<span id="cb364-46"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-46" tabindex="-1"></a>                                                , <span class="st">&quot;covars&quot;</span></span>
<span id="cb364-47"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-47" tabindex="-1"></a>                                                , <span class="st">&quot;moders&quot;</span></span>
<span id="cb364-48"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-48" tabindex="-1"></a>                                                , <span class="st">&quot;outcomes&quot;</span></span>
<span id="cb364-49"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-49" tabindex="-1"></a>                                                , <span class="st">&quot;studies&quot;</span></span>
<span id="cb364-50"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-50" tabindex="-1"></a>                                                , <span class="st">&quot;stdyModers&quot;</span></span>
<span id="cb364-51"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-51" tabindex="-1"></a>                                                , <span class="st">&quot;traits&quot;</span></span>
<span id="cb364-52"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-52" tabindex="-1"></a>                                                , <span class="st">&quot;data_path&quot;</span>)</span>
<span id="cb364-53"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-53" tabindex="-1"></a>                                  , <span class="at">packages =</span> <span class="fu">c</span>(<span class="st">&quot;lme4&quot;</span></span>
<span id="cb364-54"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-54" tabindex="-1"></a>                                                 , <span class="st">&quot;broom&quot;</span></span>
<span id="cb364-55"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-55" tabindex="-1"></a>                                                 , <span class="st">&quot;psych&quot;</span></span>
<span id="cb364-56"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-56" tabindex="-1"></a>                                                 , <span class="st">&quot;knitr&quot;</span></span>
<span id="cb364-57"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-57" tabindex="-1"></a>                                                 , <span class="st">&quot;broom.mixed&quot;</span></span>
<span id="cb364-58"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-58" tabindex="-1"></a>                                                 , <span class="st">&quot;brms&quot;</span></span>
<span id="cb364-59"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-59" tabindex="-1"></a>                                                 <span class="co">#, &quot;tidybayes&quot;</span></span>
<span id="cb364-60"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-60" tabindex="-1"></a>                                                 <span class="co">#, &quot;bootpredictlme4&quot;</span></span>
<span id="cb364-61"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-61" tabindex="-1"></a>                                                 , <span class="st">&quot;rstan&quot;</span></span>
<span id="cb364-62"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-62" tabindex="-1"></a>                                                 , <span class="st">&quot;estimatr&quot;</span></span>
<span id="cb364-63"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-63" tabindex="-1"></a>                                                 <span class="co">#, &quot;merTools&quot;</span></span>
<span id="cb364-64"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-64" tabindex="-1"></a>                                                 , <span class="st">&quot;plyr&quot;</span></span>
<span id="cb364-65"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-65" tabindex="-1"></a>                                                 , <span class="st">&quot;tidyverse&quot;</span>))</span>
<span id="cb364-66"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-66" tabindex="-1"></a>             ))</span>
<span id="cb364-67"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb364-67" tabindex="-1"></a><span class="fu">closeAllConnections</span>()</span></code></pre></div>
<!-- ### DELETE LATER -->
<!-- ```{r} -->
<!-- pred_fun <- function(file, type, outcome, trait, mod, cov, study){ -->
<!--   if(mod != "none"){ -->
<!--     load(sprintf("%s/results/3_ipd_meta/%s/studyModels/%s_%s_%s_%s_%s.RData", local_path, type, outcome, trait, mod, cov, study)) -->
<!--     pred.rx <- ipd3_study_simpeff_fun(m, mod, type) -->
<!--     save(pred.rx, file = sprintf("%s/results/3_ipd_meta/%s/studyPredicted/%s_%s_%s_%s_%s.RData", local_path, type, outcome, trait, mod, cov, study)) -->
<!--   } -->
<!-- } -->
<!--  tibble(type = c("Frequentist", "Bayesian")) %>% -->
<!--   mutate(file = map(type, ~list.files(sprintf("%s/results/3_ipd_meta/%s/studySummary", local_path, .)))) %>% -->
<!--   unnest(file) %>% -->
<!--   separate(file, c("Outcome", "Trait", "Moderator", "Covariate", "study"), sep = "_", remove = F) %>% -->
<!--   ## read in the files -->
<!--   mutate(study = str_remove(study, ".RData"), -->
<!--          pmap(list(file, type, Outcome, Trait, Moderator, Covariate, study), pred_fun)) -->
<!-- ``` -->
</div>
</div>
<div id="step-3-meta-analyze-results" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Step 3: Meta-Analyze Results<a href="method-3-two-stage-individual-participant-meta-analysis.html#step-3-meta-analyze-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="functions-1" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Functions<a href="method-3-two-stage-individual-participant-meta-analysis.html#functions-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="meta-analysis-function" class="section level5 hasAnchor" number="5.4.1.0.1">
<h5><span class="header-section-number">5.4.1.0.1</span> Meta-Analysis Function<a href="method-3-two-stage-individual-participant-meta-analysis.html#meta-analysis-function" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-1" tabindex="-1"></a>ipd3_meta_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(es, type, trait, outcome, mod, cov){</span>
<span id="cb365-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-2" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(type, trait, outcome, mod, cov))</span>
<span id="cb365-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-3" tabindex="-1"></a>  <span class="do">## bayesian sample models for stability and speed</span></span>
<span id="cb365-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-4" tabindex="-1"></a>  <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">&quot;Bayesian&quot;</span>) {</span>
<span id="cb365-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-5" tabindex="-1"></a>    mr <span class="ot">&lt;-</span> <span class="cf">if</span>(mod <span class="sc">%in%</span> stdyModers<span class="sc">$</span>short_name) <span class="st">&quot;metareg&quot;</span> <span class="cf">else</span> <span class="st">&quot;meta&quot;</span></span>
<span id="cb365-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-6" tabindex="-1"></a>    <span class="fu">load</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/bayes_sample_%s.RData&quot;</span>, local_path, mr))</span>
<span id="cb365-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-7" tabindex="-1"></a>  }</span>
<span id="cb365-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-8" tabindex="-1"></a>  </span>
<span id="cb365-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-9" tabindex="-1"></a>  <span class="do">## adding meta-regression values to effect sizes</span></span>
<span id="cb365-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-10" tabindex="-1"></a>  <span class="cf">if</span>(mod <span class="sc">%in%</span> stdyModers<span class="sc">$</span>short_name) {</span>
<span id="cb365-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-11" tabindex="-1"></a>    <span class="fu">load</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/data/two_stage/meta_data/%s_%s.RData&quot;</span>,  local_path, trait, outcome))</span>
<span id="cb365-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-12" tabindex="-1"></a>    es <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">select</span>(study, <span class="fu">one_of</span>(mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb365-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-13" tabindex="-1"></a>      <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;study&quot;</span>, <span class="st">&quot;metamod&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb365-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-14" tabindex="-1"></a>      <span class="fu">full_join</span>(es) <span class="sc">%&gt;%</span></span>
<span id="cb365-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-15" tabindex="-1"></a>      <span class="fu">mutate_if</span>(is.character, factor)</span>
<span id="cb365-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-16" tabindex="-1"></a>    es0 <span class="ot">&lt;-</span> es <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;Intercept&quot;</span>, term)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>term)</span>
<span id="cb365-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-17" tabindex="-1"></a>  }</span>
<span id="cb365-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-18" tabindex="-1"></a>    es <span class="ot">&lt;-</span> es <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;Intercept&quot;</span>, term)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>term)</span>
<span id="cb365-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-19" tabindex="-1"></a>  </span>
<span id="cb365-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-20" tabindex="-1"></a>  <span class="do">## base bayesian model</span></span>
<span id="cb365-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-21" tabindex="-1"></a>    <span class="co"># brm(formula = bf(Estimate | se(SEI) ~ 1 + (1 | study))</span></span>
<span id="cb365-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-22" tabindex="-1"></a>  <span class="co">#     , save_pars = &quot;all&quot;</span></span>
<span id="cb365-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-23" tabindex="-1"></a>  <span class="co">#     , sample_prior = T</span></span>
<span id="cb365-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-24" tabindex="-1"></a>  <span class="co">#     , prior = prior(cauchy(0,1), class = sd)</span></span>
<span id="cb365-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-25" tabindex="-1"></a>  <span class="co">#     , iter = 4000)</span></span>
<span id="cb365-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-26" tabindex="-1"></a>  </span>
<span id="cb365-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-27" tabindex="-1"></a>  <span class="do">## base bayesian meta-regression model</span></span>
<span id="cb365-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-28" tabindex="-1"></a>  <span class="co"># update(mt</span></span>
<span id="cb365-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-29" tabindex="-1"></a>  <span class="co">#     , formula. = bf(~ . + metamod)</span></span>
<span id="cb365-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-30" tabindex="-1"></a>  <span class="co">#     , newdata = es</span></span>
<span id="cb365-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-31" tabindex="-1"></a>  <span class="co">#     , sample_prior = T)</span></span>
<span id="cb365-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-32" tabindex="-1"></a>  <span class="co"># run the meta-analytic model</span></span>
<span id="cb365-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-33" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">if</span> (mod <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, moders<span class="sc">$</span>short_name)) <span class="st">&quot;Estimate ~ 1&quot;</span> <span class="cf">else</span> <span class="st">&quot;Estimate ~ 1 + metamod&quot;</span></span>
<span id="cb365-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-34" tabindex="-1"></a>  mt <span class="ot">&lt;-</span> <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">&quot;Frequentist&quot;</span>){</span>
<span id="cb365-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-35" tabindex="-1"></a>    <span class="fu">rma</span>(<span class="fu">formula</span>(f)</span>
<span id="cb365-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-36" tabindex="-1"></a>        , <span class="at">sei =</span> SEI</span>
<span id="cb365-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-37" tabindex="-1"></a>        , <span class="at">ni =</span> ni</span>
<span id="cb365-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-38" tabindex="-1"></a>        , <span class="at">slab =</span> study</span>
<span id="cb365-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-39" tabindex="-1"></a>        , <span class="at">data =</span> es)</span>
<span id="cb365-40"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-40" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb365-41"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-41" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span>mod <span class="sc">%in%</span> stdyModers<span class="sc">$</span>short_name) {</span>
<span id="cb365-42"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-42" tabindex="-1"></a>      <span class="fu">update</span>(m</span>
<span id="cb365-43"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-43" tabindex="-1"></a>             , <span class="at">newdata =</span> es</span>
<span id="cb365-44"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-44" tabindex="-1"></a>             , <span class="at">iter =</span> <span class="dv">2000</span></span>
<span id="cb365-45"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-45" tabindex="-1"></a>             , <span class="at">warmup =</span> <span class="dv">1000</span></span>
<span id="cb365-46"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-46" tabindex="-1"></a>             , <span class="at">cores =</span> <span class="dv">1</span>)</span>
<span id="cb365-47"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-47" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb365-48"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-48" tabindex="-1"></a>      <span class="fu">update</span>(m</span>
<span id="cb365-49"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-49" tabindex="-1"></a>             , <span class="at">formula. =</span> <span class="fu">bf</span>(<span class="sc">~</span> . <span class="sc">+</span> metamod)</span>
<span id="cb365-50"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-50" tabindex="-1"></a>             , <span class="at">newdata =</span> es</span>
<span id="cb365-51"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-51" tabindex="-1"></a>             , <span class="at">iter =</span> <span class="dv">2000</span></span>
<span id="cb365-52"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-52" tabindex="-1"></a>             , <span class="at">warmup =</span> <span class="dv">1000</span></span>
<span id="cb365-53"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-53" tabindex="-1"></a>             , <span class="at">cores =</span> <span class="dv">1</span>)</span>
<span id="cb365-54"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-54" tabindex="-1"></a>    }</span>
<span id="cb365-55"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-55" tabindex="-1"></a>  }</span>
<span id="cb365-56"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-56" tabindex="-1"></a>  </span>
<span id="cb365-57"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-57" tabindex="-1"></a>  <span class="cf">if</span>(mod <span class="sc">%in%</span> stdyModers<span class="sc">$</span>short_name) {</span>
<span id="cb365-58"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-58" tabindex="-1"></a>    mt0 <span class="ot">&lt;-</span> <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">&quot;Frequentist&quot;</span>) {</span>
<span id="cb365-59"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-59" tabindex="-1"></a>      <span class="fu">rma</span>(<span class="fu">formula</span>(f)</span>
<span id="cb365-60"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-60" tabindex="-1"></a>        , <span class="at">sei =</span> SEI</span>
<span id="cb365-61"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-61" tabindex="-1"></a>        , <span class="at">ni =</span> ni</span>
<span id="cb365-62"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-62" tabindex="-1"></a>        , <span class="at">slab =</span> study</span>
<span id="cb365-63"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-63" tabindex="-1"></a>        , <span class="at">data =</span> es0)</span>
<span id="cb365-64"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-64" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb365-65"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-65" tabindex="-1"></a>      <span class="fu">update</span>(m</span>
<span id="cb365-66"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-66" tabindex="-1"></a>             , <span class="at">formula. =</span> <span class="fu">bf</span>(<span class="sc">~</span> . <span class="sc">+</span> metamod)</span>
<span id="cb365-67"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-67" tabindex="-1"></a>             , <span class="at">newdata =</span> es0</span>
<span id="cb365-68"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-68" tabindex="-1"></a>             , <span class="at">iter =</span> <span class="dv">2000</span></span>
<span id="cb365-69"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-69" tabindex="-1"></a>             , <span class="at">warmup =</span> <span class="dv">1000</span></span>
<span id="cb365-70"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-70" tabindex="-1"></a>             , <span class="at">cores =</span> <span class="dv">1</span>)</span>
<span id="cb365-71"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-71" tabindex="-1"></a>    }</span>
<span id="cb365-72"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-72" tabindex="-1"></a>  }</span>
<span id="cb365-73"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-73" tabindex="-1"></a>  </span>
<span id="cb365-74"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-74" tabindex="-1"></a>  <span class="fu">save</span>(mt, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/metaModels/%s_%s_%s_%s.RData&quot;</span></span>
<span id="cb365-75"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-75" tabindex="-1"></a>                          , local_path, type, outcome, trait, mod, cov))</span>
<span id="cb365-76"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-76" tabindex="-1"></a>  </span>
<span id="cb365-77"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-77" tabindex="-1"></a>  <span class="co"># pull out and format the fixed effects (i.e. overall effects)</span></span>
<span id="cb365-78"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-78" tabindex="-1"></a>  fx <span class="ot">&lt;-</span> <span class="fu">ipd3_meta_fx_fun</span>(mt, type, mod)</span>
<span id="cb365-79"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-79" tabindex="-1"></a>  <span class="fu">save</span>(fx, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/metaSummary/%s_%s_%s_%s.RData&quot;</span></span>
<span id="cb365-80"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-80" tabindex="-1"></a>                          , local_path, type, outcome, trait, mod, cov))</span>
<span id="cb365-81"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-81" tabindex="-1"></a>  </span>
<span id="cb365-82"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-82" tabindex="-1"></a>  <span class="co"># meta-analysis predictions</span></span>
<span id="cb365-83"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-83" tabindex="-1"></a>  <span class="cf">if</span>(mod <span class="sc">%in%</span> stdyModers<span class="sc">$</span>short_name) {</span>
<span id="cb365-84"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-84" tabindex="-1"></a>    pred.fx0 <span class="ot">&lt;-</span> <span class="fu">ipd3_meta_simpeff_fun</span>(mt0, mod, type) <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(mod, <span class="st">&quot;b0_pred&quot;</span>, <span class="st">&quot;b0_lower&quot;</span>, <span class="st">&quot;b0_higher&quot;</span>))</span>
<span id="cb365-85"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-85" tabindex="-1"></a>    pred.fx1 <span class="ot">&lt;-</span> <span class="fu">ipd3_meta_simpeff_fun</span>(mt, mod, type) <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(mod, <span class="st">&quot;b1_pred&quot;</span>, <span class="st">&quot;b1_lower&quot;</span>, <span class="st">&quot;b1_higher&quot;</span>))</span>
<span id="cb365-86"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-86" tabindex="-1"></a>    pred.fx <span class="ot">&lt;-</span> <span class="fu">crossing</span>(</span>
<span id="cb365-87"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-87" tabindex="-1"></a>      <span class="at">p_value =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, .<span class="dv">25</span>)</span>
<span id="cb365-88"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-88" tabindex="-1"></a>      , pred.fx0 <span class="sc">%&gt;%</span></span>
<span id="cb365-89"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-89" tabindex="-1"></a>        <span class="fu">full_join</span>(pred.fx1)</span>
<span id="cb365-90"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-90" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb365-91"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-91" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">pred =</span> b0_pred <span class="sc">+</span> b1_pred<span class="sc">*</span>p_value) <span class="sc">%&gt;%</span></span>
<span id="cb365-92"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-92" tabindex="-1"></a>      <span class="fu">select</span>(p_value, <span class="fu">all_of</span>(mod), pred)</span>
<span id="cb365-93"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-93" tabindex="-1"></a>    <span class="fu">save</span>(pred.fx, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/metaPredicted/%s_%s_%s_%s.RData&quot;</span></span>
<span id="cb365-94"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-94" tabindex="-1"></a>                          , local_path, type, outcome, trait, mod, cov))</span>
<span id="cb365-95"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-95" tabindex="-1"></a>  }</span>
<span id="cb365-96"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-96" tabindex="-1"></a>  </span>
<span id="cb365-97"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-97" tabindex="-1"></a>  <span class="co"># pull out and format the cross-study heterogeneity estimates</span></span>
<span id="cb365-98"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-98" tabindex="-1"></a>  het <span class="ot">&lt;-</span> <span class="fu">ipd3_meta_rx_fun</span>(mt, type)</span>
<span id="cb365-99"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-99" tabindex="-1"></a>  <span class="fu">save</span>(het, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/metaHetero/%s_%s_%s_%s.RData&quot;</span></span>
<span id="cb365-100"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-100" tabindex="-1"></a>                          , local_path, type, outcome, trait, mod, cov))</span>
<span id="cb365-101"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-101" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">c</span>(<span class="st">&quot;mt&quot;</span>, <span class="st">&quot;es&quot;</span>, <span class="st">&quot;type&quot;</span>, <span class="st">&quot;trait&quot;</span>, <span class="st">&quot;outcome&quot;</span>, <span class="st">&quot;mod&quot;</span>, <span class="st">&quot;fx&quot;</span>, <span class="st">&quot;rx&quot;</span>))</span>
<span id="cb365-102"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-102" tabindex="-1"></a>  <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb365-103"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb365-103" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="meta-analysis-fixed-effect-function" class="section level5 hasAnchor" number="5.4.1.0.2">
<h5><span class="header-section-number">5.4.1.0.2</span> Meta-Analysis Fixed Effect Function<a href="method-3-two-stage-individual-participant-meta-analysis.html#meta-analysis-fixed-effect-function" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-1" tabindex="-1"></a>ipd3_meta_fx_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(mt, type, mod){</span>
<span id="cb366-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-2" tabindex="-1"></a>  trgt <span class="ot">&lt;-</span> <span class="cf">if</span>(mod <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, stdyModers<span class="sc">$</span>short_name)) <span class="st">&quot;p_value&quot;</span> <span class="cf">else</span> <span class="fu">paste0</span>(<span class="st">&quot;p_value:&quot;</span>, mod)</span>
<span id="cb366-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-3" tabindex="-1"></a>  <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;Frequentist&quot;</span>){</span>
<span id="cb366-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-4" tabindex="-1"></a>    <span class="fu">coef</span>(<span class="fu">summary</span>(mt)) <span class="sc">%&gt;%</span></span>
<span id="cb366-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-5" tabindex="-1"></a>      <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb366-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-6" tabindex="-1"></a>      <span class="fu">select</span>(term, estimate, <span class="at">SE =</span> se, <span class="at">conf.low =</span> ci.lb, <span class="at">conf.high =</span> ci.ub) <span class="sc">%&gt;%</span></span>
<span id="cb366-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-7" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">study =</span> <span class="st">&quot;Meta-Analytic&quot;</span>,</span>
<span id="cb366-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-8" tabindex="-1"></a>             <span class="at">term =</span> <span class="fu">mapvalues</span>(term, <span class="st">&quot;intrcpt&quot;</span>, trgt))</span>
<span id="cb366-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-9" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb366-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-10" tabindex="-1"></a>    <span class="fu">fixef</span>(mt) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb366-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-11" tabindex="-1"></a>      <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb366-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-12" tabindex="-1"></a>      <span class="fu">select</span>(term, <span class="at">estimate =</span> Estimate, <span class="at">SE =</span> Est.Error, <span class="at">conf.low =</span> Q2<span class="fl">.5</span>, <span class="at">conf.high =</span> Q97<span class="fl">.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb366-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-13" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">study =</span> <span class="st">&quot;Meta-Analytic&quot;</span>,</span>
<span id="cb366-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-14" tabindex="-1"></a>             <span class="at">term =</span> <span class="fu">mapvalues</span>(term, <span class="st">&quot;Intercept&quot;</span>, trgt))</span>
<span id="cb366-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-15" tabindex="-1"></a>  }</span>
<span id="cb366-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb366-16" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="meta-analysis-heterogeneity-function" class="section level5 hasAnchor" number="5.4.1.0.3">
<h5><span class="header-section-number">5.4.1.0.3</span> Meta-Analysis Heterogeneity Function<a href="method-3-two-stage-individual-participant-meta-analysis.html#meta-analysis-heterogeneity-function" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-1" tabindex="-1"></a>ipd3_meta_rx_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(mt, type){</span>
<span id="cb367-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-2" tabindex="-1"></a>  <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&quot;Frequentist&quot;</span>){</span>
<span id="cb367-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-3" tabindex="-1"></a>    <span class="do">## for frequentist, we&#39;ll grab estimates of:</span></span>
<span id="cb367-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-4" tabindex="-1"></a>    <span class="do">## - tau^2: estimated between-study heterogeneity</span></span>
<span id="cb367-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-5" tabindex="-1"></a>    <span class="do">## - I^2: total hetero (tau^2) / total hetero + total var (tau^2 + sigma^2)</span></span>
<span id="cb367-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-6" tabindex="-1"></a>    <span class="do">## - H^2: total var (tau^2 + sigma^2) / total sampling var (sigma^2)</span></span>
<span id="cb367-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-7" tabindex="-1"></a>    <span class="do">## - QE: Chi^2 dist Cochran&#39;s Q statistic (hetero &gt; 0)</span></span>
<span id="cb367-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-8" tabindex="-1"></a>    <span class="do">## - QEp: associated p-value for QE for k df</span></span>
<span id="cb367-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-9" tabindex="-1"></a>    mt[<span class="fu">c</span>(<span class="st">&quot;tau2&quot;</span>, <span class="st">&quot;se.tau2&quot;</span>, <span class="st">&quot;I2&quot;</span>, <span class="st">&quot;H2&quot;</span>, <span class="st">&quot;QE&quot;</span>, <span class="st">&quot;QEp&quot;</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb367-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-10" tabindex="-1"></a>      <span class="fu">ldply</span>() <span class="sc">%&gt;%</span></span>
<span id="cb367-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-11" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;.id&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;V1&quot;</span>)</span>
<span id="cb367-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-12" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb367-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-13" tabindex="-1"></a>    <span class="do">## for Bayesian, we&#39;ll grab estimates of: </span></span>
<span id="cb367-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-14" tabindex="-1"></a>    <span class="do">## note, for these, we must estimate some directly</span></span>
<span id="cb367-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-15" tabindex="-1"></a>    <span class="do">## but will use Bayes Factor to estimate probability of tau^2 &gt; 0</span></span>
<span id="cb367-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-16" tabindex="-1"></a>    <span class="do">## this should converge with other estimates but is more appropriate for Bayes</span></span>
<span id="cb367-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-17" tabindex="-1"></a>    <span class="do">## - tau^2: average estimated between-study hetero across Bayes samples</span></span>
<span id="cb367-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-18" tabindex="-1"></a>    <span class="do">## - I^2: total hetero (tau^2) / total hetero + total var (tau^2 + sigma^2)</span></span>
<span id="cb367-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-19" tabindex="-1"></a>    <span class="do">## - H^2: total var (tau^2 + sigma^2) / total sampling var (sigma^2)</span></span>
<span id="cb367-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-20" tabindex="-1"></a>    <span class="do">## - BF: posterior prob / prior prob</span></span>
<span id="cb367-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-21" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">tau2 =</span> <span class="fu">summary</span>(mt)<span class="sc">$</span>random<span class="sc">$</span>study[,<span class="st">&quot;Estimate&quot;</span>]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb367-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-22" tabindex="-1"></a>           , <span class="at">se.tau2 =</span> <span class="fu">summary</span>(mt)<span class="sc">$</span>random<span class="sc">$</span>study[,<span class="st">&quot;Est.Error&quot;</span>]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb367-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-23" tabindex="-1"></a>           , <span class="at">I2 =</span> tau2 <span class="sc">/</span> (tau2 <span class="sc">+</span> <span class="fu">var</span>(<span class="fu">resid</span>(mt)[,<span class="st">&quot;Estimate&quot;</span>]))</span>
<span id="cb367-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-24" tabindex="-1"></a>           , <span class="at">H2 =</span> (tau2 <span class="sc">+</span> <span class="fu">var</span>(<span class="fu">resid</span>(mt)[,<span class="st">&quot;Estimate&quot;</span>])) <span class="sc">/</span> <span class="fu">var</span>(<span class="fu">resid</span>(mt)[,<span class="st">&quot;Estimate&quot;</span>])</span>
<span id="cb367-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-25" tabindex="-1"></a>           , <span class="at">BF =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">hypothesis</span>(mt, <span class="st">&quot;study__Intercept^2 = 0&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>)<span class="sc">$</span>hypothesis<span class="sc">$</span>Evid.Ratio</span>
<span id="cb367-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-26" tabindex="-1"></a>    )</span>
<span id="cb367-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-27" tabindex="-1"></a>  }</span>
<span id="cb367-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb367-28" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="meta-analysis-simple-effects-function" class="section level5 hasAnchor" number="5.4.1.0.4">
<h5><span class="header-section-number">5.4.1.0.4</span> Meta-Analysis Simple Effects Function<a href="method-3-two-stage-individual-participant-meta-analysis.html#meta-analysis-simple-effects-function" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-1" tabindex="-1"></a><span class="do">## seemingly only seems to make sense for meta regressions</span></span>
<span id="cb368-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-2" tabindex="-1"></a><span class="do">## the effect sizes uses would be the difference in the association </span></span>
<span id="cb368-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-3" tabindex="-1"></a><span class="do">## associated with a 1 SD change in the moderator</span></span>
<span id="cb368-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-4" tabindex="-1"></a><span class="do">## or with a dummy code?\</span></span>
<span id="cb368-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-5" tabindex="-1"></a>ipd3_meta_simpeff_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(m, moder, type){</span>
<span id="cb368-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-6" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">&quot;Bayesian&quot;</span>) m<span class="sc">$</span>data <span class="sc">%&gt;%</span> <span class="fu">select</span>(metamod) <span class="cf">else</span> m<span class="sc">$</span>X <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>intrcpt)</span>
<span id="cb368-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-7" tabindex="-1"></a>  md_cl <span class="ot">&lt;-</span> <span class="fu">class</span>(d<span class="sc">$</span>metamod)</span>
<span id="cb368-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-8" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">sapply</span>(d, class) <span class="sc">==</span> <span class="st">&quot;numeric&quot;</span>)){</span>
<span id="cb368-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-9" tabindex="-1"></a>    msd <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb368-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-10" tabindex="-1"></a>      <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb368-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-11" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()</span>
<span id="cb368-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-12" tabindex="-1"></a>                   , <span class="at">names_to =</span> <span class="st">&quot;item&quot;</span></span>
<span id="cb368-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-13" tabindex="-1"></a>                   , <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb368-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-14" tabindex="-1"></a>      <span class="fu">group_by</span>(item) <span class="sc">%&gt;%</span></span>
<span id="cb368-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-15" tabindex="-1"></a>      <span class="fu">summarize_at</span>(<span class="fu">vars</span>(value), <span class="fu">lst</span>(mean, sd)) <span class="sc">%&gt;%</span></span>
<span id="cb368-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-16" tabindex="-1"></a>      <span class="fu">ungroup</span>()</span>
<span id="cb368-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-17" tabindex="-1"></a>  }</span>
<span id="cb368-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-18" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">sapply</span>(d, class) <span class="sc">==</span> <span class="st">&quot;factor&quot;</span>)){</span>
<span id="cb368-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-19" tabindex="-1"></a>    fct_lev <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb368-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-20" tabindex="-1"></a>      <span class="fu">select_if</span>(is.factor) <span class="sc">%&gt;%</span></span>
<span id="cb368-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-21" tabindex="-1"></a>      <span class="fu">summarize_all</span>(<span class="sc">~</span><span class="fu">list</span>(<span class="fu">unique</span>(.)))</span>
<span id="cb368-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-22" tabindex="-1"></a>  }</span>
<span id="cb368-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-23" tabindex="-1"></a>  <span class="co"># d &lt;- d %&gt;% select(-one_of(moder))</span></span>
<span id="cb368-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-24" tabindex="-1"></a>  </span>
<span id="cb368-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-25" tabindex="-1"></a>  md_levs <span class="ot">&lt;-</span> <span class="cf">if</span>(md_cl <span class="sc">==</span> <span class="st">&quot;numeric&quot;</span>){</span>
<span id="cb368-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-26" tabindex="-1"></a>    <span class="cf">if</span>(moder <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;baseAge&quot;</span>, <span class="st">&quot;baseYear&quot;</span>)) {</span>
<span id="cb368-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-27" tabindex="-1"></a>      <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb368-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-28" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (moder <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;predInt&quot;</span>, <span class="st">&quot;education&quot;</span>)) {</span>
<span id="cb368-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-29" tabindex="-1"></a>      <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>) </span>
<span id="cb368-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-30" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb368-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-31" tabindex="-1"></a>        <span class="fu">with</span>(msd, <span class="fu">c</span>(mean[item <span class="sc">==</span> moder] <span class="sc">-</span> sd[item <span class="sc">==</span> moder], mean[item <span class="sc">==</span> moder], mean[item <span class="sc">==</span> moder] <span class="sc">+</span> sd[item <span class="sc">==</span> moder]))</span>
<span id="cb368-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-32" tabindex="-1"></a>      }</span>
<span id="cb368-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-33" tabindex="-1"></a>  } <span class="cf">else</span> { </span>
<span id="cb368-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-34" tabindex="-1"></a>    <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">&quot;Bayesian&quot;</span>){</span>
<span id="cb368-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-35" tabindex="-1"></a>      <span class="fu">unique</span>(fct_lev[,moder][[<span class="dv">1</span>]])</span>
<span id="cb368-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-36" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb368-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-37" tabindex="-1"></a>      <span class="fu">unique</span>(d) <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>()</span>
<span id="cb368-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-38" tabindex="-1"></a>    }</span>
<span id="cb368-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-39" tabindex="-1"></a>  }</span>
<span id="cb368-40"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-40" tabindex="-1"></a>  <span class="cf">if</span>(moder <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;continent&quot;</span>, <span class="st">&quot;scale&quot;</span>)) <span class="fu">rownames</span>(md_levs) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(md_levs)</span>
<span id="cb368-41"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-41" tabindex="-1"></a>  </span>
<span id="cb368-42"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-42" tabindex="-1"></a>  probs <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb368-43"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-43" tabindex="-1"></a>    <span class="sc">~</span>wrong           , <span class="sc">~</span>correct,</span>
<span id="cb368-44"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-44" tabindex="-1"></a>    <span class="st">&quot;metamodNEO.FFI&quot;</span> , <span class="st">&quot;metamodNEO-FFI&quot;</span>,</span>
<span id="cb368-45"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-45" tabindex="-1"></a>    <span class="st">&quot;metamodBFI.S&quot;</span>   , <span class="st">&quot;metamodBFI-S&quot;</span>,</span>
<span id="cb368-46"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-46" tabindex="-1"></a>    <span class="st">&quot;metamodIPIP.NEO&quot;</span>, <span class="st">&quot;metamodIPIP NEO&quot;</span>,</span>
<span id="cb368-47"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-47" tabindex="-1"></a>    <span class="st">&quot;metamodTDA.40&quot;</span>  , <span class="st">&quot;metamodTDA-40&quot;</span>,</span>
<span id="cb368-48"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-48" tabindex="-1"></a>    <span class="st">&quot;metamodThe.Netherlands&quot;</span>  , <span class="st">&quot;metamodThe Netherlands&quot;</span></span>
<span id="cb368-49"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-49" tabindex="-1"></a>  )</span>
<span id="cb368-50"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-50" tabindex="-1"></a>  </span>
<span id="cb368-51"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-51" tabindex="-1"></a>  mod_frame <span class="ot">&lt;-</span> <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">&quot;Bayesian&quot;</span>) {</span>
<span id="cb368-52"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-52" tabindex="-1"></a>    <span class="fu">expand.grid</span>(</span>
<span id="cb368-53"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-53" tabindex="-1"></a>      <span class="at">SEI =</span> <span class="dv">0</span></span>
<span id="cb368-54"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-54" tabindex="-1"></a>      , <span class="at">metamod =</span> md_levs</span>
<span id="cb368-55"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-55" tabindex="-1"></a>      , <span class="at">stringsAsFactors =</span> F</span>
<span id="cb368-56"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-56" tabindex="-1"></a>      ) </span>
<span id="cb368-57"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-57" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb368-58"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-58" tabindex="-1"></a>    md_levs</span>
<span id="cb368-59"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-59" tabindex="-1"></a>  }</span>
<span id="cb368-60"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-60" tabindex="-1"></a>  </span>
<span id="cb368-61"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-61" tabindex="-1"></a>  <span class="cf">if</span>(moder <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;scale&quot;</span>, <span class="st">&quot;country&quot;</span>)) <span class="fu">colnames</span>(mod_frame) <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(<span class="fu">colnames</span>(mod_frame), probs<span class="sc">$</span>wrong, probs<span class="sc">$</span>correct)</span>
<span id="cb368-62"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-62" tabindex="-1"></a>  </span>
<span id="cb368-63"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-63" tabindex="-1"></a>  pred.fx <span class="ot">&lt;-</span> <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">&quot;Bayesian&quot;</span>){</span>
<span id="cb368-64"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-64" tabindex="-1"></a>    <span class="fu">bind_cols</span>(</span>
<span id="cb368-65"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-65" tabindex="-1"></a>      mod_frame, </span>
<span id="cb368-66"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-66" tabindex="-1"></a>      <span class="fu">fitted</span>(m</span>
<span id="cb368-67"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-67" tabindex="-1"></a>             , <span class="at">newdata =</span> mod_frame</span>
<span id="cb368-68"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-68" tabindex="-1"></a>             , <span class="at">re_formula =</span> <span class="cn">NA</span></span>
<span id="cb368-69"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-69" tabindex="-1"></a>             ) <span class="sc">%&gt;%</span> data.frame</span>
<span id="cb368-70"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-70" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb368-71"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-71" tabindex="-1"></a>      <span class="fu">select</span>(metamod, <span class="at">pred =</span> Estimate, <span class="at">lower =</span> Q2<span class="fl">.5</span>, <span class="at">upper =</span> Q97<span class="fl">.5</span>)</span>
<span id="cb368-72"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-72" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb368-73"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-73" tabindex="-1"></a>    <span class="fu">bind_cols</span>(</span>
<span id="cb368-74"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-74" tabindex="-1"></a>      <span class="fu">tibble</span>(<span class="at">modvalue =</span> mod_frame), </span>
<span id="cb368-75"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-75" tabindex="-1"></a>      <span class="fu">predict</span>(m, mod_frame) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb368-76"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-76" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb368-77"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-77" tabindex="-1"></a>      <span class="fu">select</span>(modvalue, pred, <span class="at">lower =</span> ci.lb, <span class="at">upper =</span> ci.ub)</span>
<span id="cb368-78"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-78" tabindex="-1"></a>  }</span>
<span id="cb368-79"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-79" tabindex="-1"></a>  </span>
<span id="cb368-80"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-80" tabindex="-1"></a>  <span class="cf">if</span>(moder <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;scale&quot;</span>, <span class="st">&quot;continent&quot;</span>)){</span>
<span id="cb368-81"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-81" tabindex="-1"></a>    mssng <span class="ot">&lt;-</span> <span class="cf">if</span>(moder <span class="sc">==</span> <span class="st">&quot;country&quot;</span>) <span class="st">&quot;United States&quot;</span> <span class="cf">else</span> <span class="cf">if</span>(moder <span class="sc">==</span> <span class="st">&quot;continent&quot;</span>) <span class="st">&quot;North America&quot;</span> <span class="cf">else</span> <span class="st">&quot;NEO-FFI&quot;</span></span>
<span id="cb368-82"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-82" tabindex="-1"></a>    nms <span class="ot">&lt;-</span> <span class="fu">str_remove</span>(<span class="fu">colnames</span>(mod_frame), <span class="st">&quot;metamod&quot;</span>)</span>
<span id="cb368-83"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-83" tabindex="-1"></a>    trck <span class="ot">&lt;-</span> <span class="fu">apply</span>(mod_frame, <span class="dv">1</span>, <span class="cf">function</span>(x){</span>
<span id="cb368-84"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-84" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">sum</span>(x) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">which</span>(x <span class="sc">==</span> <span class="dv">1</span>) <span class="cf">else</span> <span class="fu">ncol</span>(mod_frame) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb368-85"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-85" tabindex="-1"></a>    }); trck <span class="ot">&lt;-</span> <span class="fu">c</span>(nms, mssng)[trck]</span>
<span id="cb368-86"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-86" tabindex="-1"></a>    <span class="fu">rownames</span>(mod_frame) <span class="ot">&lt;-</span> trck</span>
<span id="cb368-87"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-87" tabindex="-1"></a>    pred.fx <span class="ot">&lt;-</span> pred.fx <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">modvalue =</span> trck)</span>
<span id="cb368-88"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-88" tabindex="-1"></a>  }</span>
<span id="cb368-89"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-89" tabindex="-1"></a>  </span>
<span id="cb368-90"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-90" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">c</span>(<span class="st">&quot;m&quot;</span>, <span class="st">&quot;mod_frame&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;md_levs&quot;</span>))</span>
<span id="cb368-91"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-91" tabindex="-1"></a>  <span class="fu">gc</span>()</span>
<span id="cb368-92"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-92" tabindex="-1"></a>  <span class="fu">return</span>(pred.fx)</span>
<span id="cb368-93"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb368-93" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="run-meta-analysis-and-meta-regression-models" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Run Meta-Analysis and Meta-Regression Models<a href="method-3-two-stage-individual-participant-meta-analysis.html#run-meta-analysis-and-meta-regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-1" tabindex="-1"></a>loadRData <span class="ot">&lt;-</span> <span class="cf">function</span>(fileName, type, obj, folder){</span>
<span id="cb369-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-2" tabindex="-1"></a><span class="co">#loads an RData file, and returns it</span></span>
<span id="cb369-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-3" tabindex="-1"></a>    path <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/%s/%s&quot;</span>, local_path, type, folder, fileName)</span>
<span id="cb369-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-4" tabindex="-1"></a>    <span class="fu">load</span>(path)</span>
<span id="cb369-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-5" tabindex="-1"></a>    <span class="fu">get</span>(<span class="fu">ls</span>()[<span class="fu">grepl</span>(obj, <span class="fu">ls</span>())])</span>
<span id="cb369-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-6" tabindex="-1"></a>}</span>
<span id="cb369-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-7" tabindex="-1"></a></span>
<span id="cb369-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-8" tabindex="-1"></a><span class="do">## load in effect size data </span></span>
<span id="cb369-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-9" tabindex="-1"></a><span class="do">## first get file names</span></span>
<span id="cb369-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-10" tabindex="-1"></a>nested_ipd3_meta <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;Frequentist&quot;</span>, <span class="st">&quot;Bayesian&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb369-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">file =</span> <span class="fu">map</span>(type, <span class="sc">~</span><span class="fu">list.files</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/studyEffects&quot;</span>, local_path, .)))) <span class="sc">%&gt;%</span></span>
<span id="cb369-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-12" tabindex="-1"></a>  <span class="fu">unnest</span>(file) <span class="sc">%&gt;%</span></span>
<span id="cb369-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-13" tabindex="-1"></a>  <span class="fu">separate</span>(file, <span class="fu">c</span>(<span class="st">&quot;Outcome&quot;</span>, <span class="st">&quot;Trait&quot;</span>, <span class="st">&quot;Moderator&quot;</span>, <span class="st">&quot;Covariate&quot;</span>, <span class="st">&quot;study&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="at">remove =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb369-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-14" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(study)) <span class="sc">%&gt;%</span></span>
<span id="cb369-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-15" tabindex="-1"></a>  <span class="co"># filter(Trait == &quot;N&quot;) %&gt;%</span></span>
<span id="cb369-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-16" tabindex="-1"></a>  <span class="do">## read in the files</span></span>
<span id="cb369-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">study =</span> <span class="fu">str_remove</span>(study, <span class="st">&quot;.RData&quot;</span>),</span>
<span id="cb369-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-18" tabindex="-1"></a>         <span class="at">data =</span> <span class="fu">map2</span>(file, type, <span class="sc">~</span><span class="fu">loadRData</span>(.x, .y, <span class="st">&quot;es&quot;</span>, <span class="st">&quot;studyEffects&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb369-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-19" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>file) <span class="sc">%&gt;%</span></span>
<span id="cb369-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-20" tabindex="-1"></a>  <span class="do">## unnest effect sizes</span></span>
<span id="cb369-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-21" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb369-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb369-22" tabindex="-1"></a>nested_ipd3_meta</span></code></pre></div>
<pre><code>## # A tibble: 1,712 × 10
##    type        Outcome      Trait Moderator Covariate study term         Estimate      SEI    ni
##    &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;
##  1 Frequentist crystallized A     age       all       EAS   (Intercept)  5.67     0.344      788
##  2 Frequentist crystallized A     age       all       EAS   p_value:age -0.0103   0.00881    788
##  3 Frequentist crystallized A     age       all       GSOEP (Intercept)  8.08     0.206      647
##  4 Frequentist crystallized A     age       all       GSOEP p_value:age -0.00168  0.00195    647
##  5 Frequentist crystallized A     age       all       HILDA (Intercept)  5.13     0.110     7755
##  6 Frequentist crystallized A     age       all       HILDA p_value:age  0.000451 0.000817  7755
##  7 Frequentist crystallized A     age       all       HRS   (Intercept)  5.14     0.112     8432
##  8 Frequentist crystallized A     age       all       HRS   p_value:age -0.00142  0.00185   8432
##  9 Frequentist crystallized A     age       all       ROS   (Intercept)  7.02     0.284     1372
## 10 Frequentist crystallized A     age       all       ROS   p_value:age  0.0136   0.00651   1372
## # ℹ 1,702 more rows</code></pre>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb371-1" tabindex="-1"></a><span class="do">## group and nest</span></span>
<span id="cb371-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb371-2" tabindex="-1"></a>nested_ipd3_meta <span class="ot">&lt;-</span> nested_ipd3_meta <span class="sc">%&gt;%</span></span>
<span id="cb371-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb371-3" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Trait, Outcome, Moderator, Covariate) <span class="sc">%&gt;%</span></span>
<span id="cb371-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb371-4" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb371-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb371-5" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb371-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb371-6" tabindex="-1"></a></span>
<span id="cb371-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb371-7" tabindex="-1"></a><span class="do">## add in meta-moderators, which requires taking original models and </span></span>
<span id="cb371-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb371-8" tabindex="-1"></a><span class="do">## modifying the Moderator column</span></span>
<span id="cb371-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb371-9" tabindex="-1"></a>nested_ipd3_meta <span class="ot">&lt;-</span> nested_ipd3_meta <span class="sc">%&gt;%</span></span>
<span id="cb371-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb371-10" tabindex="-1"></a>  <span class="fu">filter</span>(Moderator <span class="sc">==</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb371-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb371-11" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Moderator) <span class="sc">%&gt;%</span></span>
<span id="cb371-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb371-12" tabindex="-1"></a>  <span class="fu">full_join</span>(<span class="fu">crossing</span>(</span>
<span id="cb371-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb371-13" tabindex="-1"></a>    <span class="at">Trait =</span> traits<span class="sc">$</span>short_name</span>
<span id="cb371-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb371-14" tabindex="-1"></a>    , <span class="at">Moderator =</span> stdyModers<span class="sc">$</span>short_name)) <span class="sc">%&gt;%</span></span>
<span id="cb371-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb371-15" tabindex="-1"></a>  <span class="fu">full_join</span>(nested_ipd3_meta)</span></code></pre></div>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-1" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="st">&quot;age&quot;</span></span>
<span id="cb372-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-2" tabindex="-1"></a>mr <span class="ot">&lt;-</span> <span class="cf">if</span>(mod <span class="sc">%in%</span> stdyModers<span class="sc">$</span>short_name) <span class="st">&quot;metareg&quot;</span> <span class="cf">else</span> <span class="st">&quot;meta&quot;</span></span>
<span id="cb372-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-3" tabindex="-1"></a><span class="do">## adding meta-regression values to effect sizes</span></span>
<span id="cb372-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-4" tabindex="-1"></a>es <span class="ot">&lt;-</span> (nested_ipd3_meta <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;N&quot;</span> <span class="sc">&amp;</span> Covariate <span class="sc">==</span> <span class="st">&quot;all&quot;</span> <span class="sc">&amp;</span> Moderator <span class="sc">==</span> <span class="st">&quot;age&quot;</span> <span class="sc">&amp;</span> type <span class="sc">==</span> <span class="st">&quot;Bayesian&quot;</span>))<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb372-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-5" tabindex="-1"></a></span>
<span id="cb372-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-6" tabindex="-1"></a><span class="co"># base bayesian model</span></span>
<span id="cb372-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-7" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> <span class="fu">bf</span>(Estimate <span class="sc">|</span> <span class="fu">se</span>(SEI) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> study))</span>
<span id="cb372-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-8" tabindex="-1"></a>    , <span class="at">data =</span> es</span>
<span id="cb372-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-9" tabindex="-1"></a>    , <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> T)</span>
<span id="cb372-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-10" tabindex="-1"></a>    , <span class="at">sample_prior =</span> T</span>
<span id="cb372-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-11" tabindex="-1"></a>    , <span class="at">prior =</span> <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">class =</span> sd)</span>
<span id="cb372-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-12" tabindex="-1"></a>    , <span class="at">iter =</span> <span class="dv">30</span></span>
<span id="cb372-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-13" tabindex="-1"></a>    , <span class="at">warmup =</span> <span class="dv">20</span>)</span>
<span id="cb372-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-14" tabindex="-1"></a><span class="fu">save</span>(m, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/bayes_sample_meta.RData&quot;</span>, local_path))</span>
<span id="cb372-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-15" tabindex="-1"></a></span>
<span id="cb372-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-16" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="st">&quot;scale&quot;</span></span>
<span id="cb372-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-17" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/data/two_stage/meta_data/N_episodicMem.RData&quot;</span>,  local_path))</span>
<span id="cb372-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-18" tabindex="-1"></a>es <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">select</span>(study, <span class="fu">one_of</span>(mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb372-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-19" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;study&quot;</span>, <span class="st">&quot;metamod&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb372-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-20" tabindex="-1"></a>  <span class="fu">full_join</span>(es) </span>
<span id="cb372-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-21" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> <span class="fu">bf</span>(Estimate <span class="sc">|</span> <span class="fu">se</span>(SEI) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> metamod <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> study))</span>
<span id="cb372-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-22" tabindex="-1"></a>    , <span class="at">data =</span> es</span>
<span id="cb372-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-23" tabindex="-1"></a>    , <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> T)</span>
<span id="cb372-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-24" tabindex="-1"></a>    , <span class="at">sample_prior =</span> T</span>
<span id="cb372-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-25" tabindex="-1"></a>    , <span class="at">prior =</span> <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">class =</span> sd)</span>
<span id="cb372-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-26" tabindex="-1"></a>    , <span class="at">iter =</span> <span class="dv">30</span></span>
<span id="cb372-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-27" tabindex="-1"></a>    , <span class="at">warmup =</span> <span class="dv">20</span>)</span>
<span id="cb372-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-28" tabindex="-1"></a><span class="fu">save</span>(m, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/bayes_sample_metareg.RData&quot;</span>, local_path))</span>
<span id="cb372-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb372-29" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">c</span>(<span class="st">&quot;d&quot;</span>, <span class="st">&quot;es&quot;</span>, <span class="st">&quot;mod&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;mr&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-1" tabindex="-1"></a><span class="fu">plan</span>(<span class="fu">multisession</span>(<span class="at">workers =</span> <span class="dv">12</span><span class="dt">L</span>))</span>
<span id="cb373-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-2" tabindex="-1"></a>nested_ipd3_meta <span class="ot">&lt;-</span> nested_ipd3_meta <span class="sc">%&gt;%</span></span>
<span id="cb373-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-3" tabindex="-1"></a>  <span class="co"># full_join(done) %&gt;% filter(is.na(done)) %&gt;%</span></span>
<span id="cb373-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-4" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;Bayesian&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb373-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-5" tabindex="-1"></a>  <span class="co"># filter(Moderator %in% c(&quot;scale&quot;, &quot;country&quot;, &quot;continent&quot;)) %&gt;%</span></span>
<span id="cb373-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">metamod =</span> </span>
<span id="cb373-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-7" tabindex="-1"></a>           <span class="co"># pmap(list(data, type, Trait, Outcome, Moderator, Covariate)</span></span>
<span id="cb373-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-8" tabindex="-1"></a>           <span class="fu">future_pmap</span>(<span class="fu">list</span>(data, type, Trait, Outcome, Moderator, Covariate)</span>
<span id="cb373-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-9" tabindex="-1"></a>                        , <span class="fu">possibly</span>(ipd3_meta_fun, <span class="cn">NA_real_</span>)</span>
<span id="cb373-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-10" tabindex="-1"></a>                        , <span class="at">.progress =</span> T</span>
<span id="cb373-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-11" tabindex="-1"></a>             , <span class="at">.options =</span> <span class="fu">furrr_options</span>(</span>
<span id="cb373-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-12" tabindex="-1"></a>                                    <span class="at">globals =</span> <span class="fu">c</span>(<span class="st">&quot;ipd3_meta_fx_fun&quot;</span></span>
<span id="cb373-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-13" tabindex="-1"></a>                                                , <span class="st">&quot;ipd3_meta_rx_fun&quot;</span></span>
<span id="cb373-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-14" tabindex="-1"></a>                                                , <span class="st">&quot;ipd3_meta_simpeff_fun&quot;</span></span>
<span id="cb373-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-15" tabindex="-1"></a>                                                , <span class="st">&quot;read_path&quot;</span></span>
<span id="cb373-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-16" tabindex="-1"></a>                                                , <span class="st">&quot;local_path&quot;</span></span>
<span id="cb373-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-17" tabindex="-1"></a>                                                , <span class="st">&quot;res_path&quot;</span></span>
<span id="cb373-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-18" tabindex="-1"></a>                                                , <span class="st">&quot;codebook&quot;</span></span>
<span id="cb373-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-19" tabindex="-1"></a>                                                , <span class="st">&quot;covars&quot;</span></span>
<span id="cb373-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-20" tabindex="-1"></a>                                                , <span class="st">&quot;moders&quot;</span></span>
<span id="cb373-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-21" tabindex="-1"></a>                                                , <span class="st">&quot;outcomes&quot;</span></span>
<span id="cb373-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-22" tabindex="-1"></a>                                                , <span class="st">&quot;studies&quot;</span></span>
<span id="cb373-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-23" tabindex="-1"></a>                                                , <span class="st">&quot;stdyModers&quot;</span></span>
<span id="cb373-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-24" tabindex="-1"></a>                                                , <span class="st">&quot;traits&quot;</span></span>
<span id="cb373-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-25" tabindex="-1"></a>                                                , <span class="st">&quot;data_path&quot;</span>)</span>
<span id="cb373-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-26" tabindex="-1"></a>                                  , <span class="at">packages =</span> <span class="fu">c</span>(<span class="st">&quot;lme4&quot;</span></span>
<span id="cb373-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-27" tabindex="-1"></a>                                                 , <span class="st">&quot;broom&quot;</span></span>
<span id="cb373-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-28" tabindex="-1"></a>                                                 , <span class="st">&quot;psych&quot;</span></span>
<span id="cb373-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-29" tabindex="-1"></a>                                                 , <span class="st">&quot;knitr&quot;</span></span>
<span id="cb373-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-30" tabindex="-1"></a>                                                 , <span class="st">&quot;broom.mixed&quot;</span></span>
<span id="cb373-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-31" tabindex="-1"></a>                                                 , <span class="st">&quot;brms&quot;</span></span>
<span id="cb373-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-32" tabindex="-1"></a>                                                 <span class="co">#, &quot;tidybayes&quot;</span></span>
<span id="cb373-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-33" tabindex="-1"></a>                                                 <span class="co">#, &quot;bootpredictlme4&quot;</span></span>
<span id="cb373-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-34" tabindex="-1"></a>                                                 , <span class="st">&quot;rstan&quot;</span></span>
<span id="cb373-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-35" tabindex="-1"></a>                                                 , <span class="st">&quot;estimatr&quot;</span></span>
<span id="cb373-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-36" tabindex="-1"></a>                                                 , <span class="st">&quot;metafor&quot;</span></span>
<span id="cb373-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-37" tabindex="-1"></a>                                                 , <span class="st">&quot;plyr&quot;</span></span>
<span id="cb373-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-38" tabindex="-1"></a>                                                 , <span class="st">&quot;tidyverse&quot;</span>))</span>
<span id="cb373-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-39" tabindex="-1"></a>                        ))</span>
<span id="cb373-40"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-40" tabindex="-1"></a><span class="fu">closeAllConnections</span>()</span>
<span id="cb373-41"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb373-41" tabindex="-1"></a>nested_ipd3_meta</span></code></pre></div>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-1" tabindex="-1"></a>contr_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(m, std){</span>
<span id="cb374-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-2" tabindex="-1"></a>  cntrm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;p_value = 0&quot;</span>, <span class="st">&quot;p_value + p_value:genderFemale = 0&quot;</span>)</span>
<span id="cb374-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-3" tabindex="-1"></a>  </span>
<span id="cb374-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-4" tabindex="-1"></a>  (multcomp<span class="sc">::</span><span class="fu">glht</span>(m, cntrm) <span class="sc">%&gt;%</span> <span class="co"># multcomp hypothesis function</span></span>
<span id="cb374-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-5" tabindex="-1"></a>        <span class="fu">confint</span>(., <span class="at">calpha =</span> multcomp<span class="sc">::</span><span class="fu">univariate_calpha</span>()))<span class="sc">$</span>confint <span class="sc">%&gt;%</span></span>
<span id="cb374-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-6" tabindex="-1"></a>        <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb374-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-7" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb374-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-8" tabindex="-1"></a>        <span class="fu">rename</span>(<span class="at">estimate =</span> Estimate, <span class="at">conf.low =</span> lwr, <span class="at">conf.high =</span> upr)</span>
<span id="cb374-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-9" tabindex="-1"></a>}</span>
<span id="cb374-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-10" tabindex="-1"></a></span>
<span id="cb374-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-11" tabindex="-1"></a>res <span class="ot">&lt;-</span> nested_ipd3_meta <span class="sc">%&gt;%</span> </span>
<span id="cb374-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-12" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;Frequentist&quot;</span> <span class="sc">&amp;</span> Covariate <span class="sc">==</span> <span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb374-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res =</span> <span class="fu">map2</span>(model, study, contr_fun))</span>
<span id="cb374-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-14" tabindex="-1"></a></span>
<span id="cb374-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-15" tabindex="-1"></a>res <span class="sc">%&gt;%</span> </span>
<span id="cb374-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-16" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>model) <span class="sc">%&gt;%</span></span>
<span id="cb374-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-17" tabindex="-1"></a>  <span class="fu">unnest</span>(res) <span class="sc">%&gt;%</span> </span>
<span id="cb374-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-18" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(<span class="fu">sign</span>(conf.low) <span class="sc">==</span> <span class="fu">sign</span>(conf.high), <span class="st">&quot;sig&quot;</span>, <span class="st">&quot;ns&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb374-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb374-19" tabindex="-1"></a>  <span class="fu">filter</span>(sig <span class="sc">==</span> <span class="st">&quot;sig&quot;</span>)</span></code></pre></div>
</div>
<div id="compile-results-4" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Compile Results<a href="method-3-two-stage-individual-participant-meta-analysis.html#compile-results-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-1" tabindex="-1"></a>loadRData <span class="ot">&lt;-</span> <span class="cf">function</span>(fileName, type, obj, folder){</span>
<span id="cb375-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-2" tabindex="-1"></a><span class="co">#loads an RData file, and returns it</span></span>
<span id="cb375-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-3" tabindex="-1"></a>    path <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/%s/%s&quot;</span>, local_path, type, folder, fileName)</span>
<span id="cb375-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-4" tabindex="-1"></a>    <span class="co"># print(path)</span></span>
<span id="cb375-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-5" tabindex="-1"></a>    <span class="fu">load</span>(path)</span>
<span id="cb375-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-6" tabindex="-1"></a>    <span class="fu">get</span>(<span class="fu">ls</span>()[<span class="fu">grepl</span>(obj, <span class="fu">ls</span>())])</span>
<span id="cb375-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-7" tabindex="-1"></a>}</span>
<span id="cb375-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-8" tabindex="-1"></a></span>
<span id="cb375-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-9" tabindex="-1"></a><span class="do">## load in effect size data </span></span>
<span id="cb375-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-10" tabindex="-1"></a><span class="do">## first get file names</span></span>
<span id="cb375-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-11" tabindex="-1"></a>nested_ipd3_meta <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;Frequentist&quot;</span>, <span class="st">&quot;Bayesian&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb375-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">file =</span> <span class="fu">map</span>(type, <span class="sc">~</span><span class="fu">list.files</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/studyEffects&quot;</span>, local_path, .)))) <span class="sc">%&gt;%</span></span>
<span id="cb375-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-13" tabindex="-1"></a>  <span class="fu">unnest</span>(file) <span class="sc">%&gt;%</span></span>
<span id="cb375-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-14" tabindex="-1"></a>  <span class="fu">separate</span>(file, <span class="fu">c</span>(<span class="st">&quot;Outcome&quot;</span>, <span class="st">&quot;Trait&quot;</span>, <span class="st">&quot;Moderator&quot;</span>, <span class="st">&quot;Covariate&quot;</span>, <span class="st">&quot;study&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="at">remove =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb375-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-15" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(study)) <span class="sc">%&gt;%</span></span>
<span id="cb375-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-16" tabindex="-1"></a>  <span class="do">## read in the files</span></span>
<span id="cb375-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">study =</span> <span class="fu">str_remove</span>(study, <span class="st">&quot;.RData&quot;</span>),</span>
<span id="cb375-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-18" tabindex="-1"></a>         <span class="at">studyEff =</span> <span class="fu">map2</span>(file, type, <span class="sc">~</span><span class="fu">loadRData</span>(.x, .y, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;studySummary&quot;</span>)),</span>
<span id="cb375-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-19" tabindex="-1"></a>         <span class="at">n =</span> <span class="fu">map2</span>(file, type, <span class="sc">~</span><span class="fu">loadRData</span>(.x, .y, <span class="st">&quot;es&quot;</span>, <span class="st">&quot;studyEffects&quot;</span>)),</span>
<span id="cb375-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-20" tabindex="-1"></a>         <span class="at">n =</span> <span class="fu">map_dbl</span>(n, <span class="sc">~</span>(.)<span class="sc">$</span>ni[<span class="dv">1</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb375-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-21" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>file) <span class="sc">%&gt;%</span></span>
<span id="cb375-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-22" tabindex="-1"></a>  <span class="fu">unnest</span>(studyEff) <span class="sc">%&gt;%</span></span>
<span id="cb375-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-23" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Trait, Outcome, Moderator, Covariate) <span class="sc">%&gt;%</span></span>
<span id="cb375-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-24" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">studyEff =</span> study<span class="sc">:</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb375-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-25" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb375-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-26" tabindex="-1"></a></span>
<span id="cb375-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-27" tabindex="-1"></a><span class="do">## now we add in the study-level moderators (i.e. meta-regression)</span></span>
<span id="cb375-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-28" tabindex="-1"></a>  </span>
<span id="cb375-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-29" tabindex="-1"></a>nested_ipd3_meta <span class="ot">&lt;-</span> nested_ipd3_meta <span class="sc">%&gt;%</span></span>
<span id="cb375-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-30" tabindex="-1"></a>  <span class="fu">filter</span>(Moderator <span class="sc">==</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb375-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-31" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Moderator) <span class="sc">%&gt;%</span></span>
<span id="cb375-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-32" tabindex="-1"></a>  <span class="fu">full_join</span>(<span class="fu">crossing</span>(</span>
<span id="cb375-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-33" tabindex="-1"></a>    <span class="at">Trait =</span> traits<span class="sc">$</span>short_name</span>
<span id="cb375-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-34" tabindex="-1"></a>    , <span class="at">Moderator =</span> stdyModers<span class="sc">$</span>short_name)) <span class="sc">%&gt;%</span></span>
<span id="cb375-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-35" tabindex="-1"></a>  <span class="fu">full_join</span>(nested_ipd3_meta) <span class="sc">%&gt;%</span></span>
<span id="cb375-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-36" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_%s_%s.RData&quot;</span>, Outcome, Trait, Moderator, Covariate),</span>
<span id="cb375-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-37" tabindex="-1"></a>         <span class="at">metaEff =</span> <span class="fu">map2</span>(file, type, <span class="sc">~</span><span class="fu">loadRData</span>(.x, .y, <span class="st">&quot;fx&quot;</span>, <span class="st">&quot;metaSummary&quot;</span>)),</span>
<span id="cb375-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-38" tabindex="-1"></a>         <span class="at">metaHet =</span> <span class="fu">map2</span>(file, type, <span class="fu">possibly</span>(<span class="sc">~</span><span class="fu">loadRData</span>(.x, .y, <span class="st">&quot;het&quot;</span>, <span class="st">&quot;metaHetero&quot;</span>), <span class="cn">NA_real_</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb375-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb375-39" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>file)</span></code></pre></div>
<p>This results in a nested data frame, with columns:</p>
<ul>
<li><code>studyEff</code> = standardized study-specific effects from stage 1 regressions<br />
</li>
<li><code>metaEff</code> = standardized meta-analytic effect from stage 2 meta-analysis<br />
</li>
<li><code>metaHet</code> = Measures of cross-study heterogeneity</li>
</ul>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb376-1" tabindex="-1"></a>nested_ipd3_meta</span></code></pre></div>
<pre><code>## # A tibble: 410 × 8
##    type        Outcome      Trait Covariate studyEff          Moderator metaEff      metaHet         
##    &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;     &lt;list&gt;            &lt;chr&gt;     &lt;list&gt;       &lt;list&gt;          
##  1 Frequentist crystallized A     age       &lt;tibble [18 × 6]&gt; baseAge   &lt;df [2 × 6]&gt; &lt;tibble [1 × 6]&gt;
##  2 Frequentist crystallized A     age       &lt;tibble [18 × 6]&gt; baseYear  &lt;df [2 × 6]&gt; &lt;tibble [1 × 6]&gt;
##  3 Frequentist crystallized A     age       &lt;tibble [18 × 6]&gt; continent &lt;df [3 × 6]&gt; &lt;tibble [1 × 6]&gt;
##  4 Frequentist crystallized A     age       &lt;tibble [18 × 6]&gt; country   &lt;df [4 × 6]&gt; &lt;tibble [1 × 6]&gt;
##  5 Frequentist crystallized A     age       &lt;tibble [18 × 6]&gt; predInt   &lt;df [2 × 6]&gt; &lt;tibble [1 × 6]&gt;
##  6 Frequentist crystallized A     age       &lt;tibble [18 × 6]&gt; scale     &lt;df [2 × 6]&gt; &lt;dbl [1]&gt;       
##  7 Frequentist crystallized A     all       &lt;tibble [30 × 6]&gt; baseAge   &lt;df [2 × 6]&gt; &lt;tibble [1 × 6]&gt;
##  8 Frequentist crystallized A     all       &lt;tibble [30 × 6]&gt; baseYear  &lt;df [2 × 6]&gt; &lt;tibble [1 × 6]&gt;
##  9 Frequentist crystallized A     all       &lt;tibble [30 × 6]&gt; continent &lt;df [3 × 6]&gt; &lt;tibble [1 × 6]&gt;
## 10 Frequentist crystallized A     all       &lt;tibble [30 × 6]&gt; country   &lt;df [4 × 6]&gt; &lt;tibble [1 × 6]&gt;
## # ℹ 400 more rows</code></pre>
<div id="tables-4" class="section level5 hasAnchor" number="5.4.3.0.1">
<h5><span class="header-section-number">5.4.3.0.1</span> Tables<a href="method-3-two-stage-individual-participant-meta-analysis.html#tables-4" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>First, we’ll combine study and meta-analytic results.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb378-1" tabindex="-1"></a>ipd3_meta_res <span class="ot">&lt;-</span> nested_ipd3_meta <span class="sc">%&gt;%</span></span>
<span id="cb378-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb378-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comEff =</span> <span class="fu">map2</span>(studyEff, metaEff, <span class="sc">~</span>(.y) <span class="sc">%&gt;%</span> <span class="fu">full_join</span>(.x))) <span class="sc">%&gt;%</span></span>
<span id="cb378-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb378-3" tabindex="-1"></a>  <span class="fu">select</span>(type, Outcome, Trait, Moderator, Covariate, comEff) <span class="sc">%&gt;%</span></span>
<span id="cb378-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb378-4" tabindex="-1"></a>  <span class="fu">unnest</span>(comEff) <span class="sc">%&gt;%</span></span>
<span id="cb378-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb378-5" tabindex="-1"></a>  <span class="fu">filter</span>((Moderator <span class="sc">==</span> <span class="st">&quot;none&quot;</span> <span class="sc">&amp;</span> term <span class="sc">==</span> <span class="st">&quot;p_value&quot;</span>) <span class="sc">|</span> </span>
<span id="cb378-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb378-6" tabindex="-1"></a>         (<span class="sc">!</span>Moderator <span class="sc">%in%</span> stdyModers<span class="sc">$</span>short_name <span class="sc">&amp;</span> (<span class="fu">grepl</span>(<span class="st">&quot;p_value:&quot;</span>, term))) <span class="sc">|</span></span>
<span id="cb378-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb378-7" tabindex="-1"></a>         (Moderator <span class="sc">%in%</span> stdyModers<span class="sc">$</span>short_name <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">&quot;metamod&quot;</span>, term))) <span class="sc">%&gt;%</span></span>
<span id="cb378-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb378-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">str_replace_all</span>(term, <span class="st">&quot;metamod&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;p_value:&quot;</span>, Moderator)),</span>
<span id="cb378-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb378-9" tabindex="-1"></a>         <span class="at">study =</span> <span class="fu">mapvalues</span>(study, <span class="fu">c</span>(<span class="st">&quot;BASE-I&quot;</span>, <span class="st">&quot;OCTO-TWIN&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;BASE&quot;</span>, <span class="st">&quot;OCTO-Twin&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb378-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb378-10" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>SE)</span>
<span id="cb378-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb378-11" tabindex="-1"></a>ipd3_meta_res</span></code></pre></div>
<pre><code>## # A tibble: 1,635 × 11
##    type        Outcome      Trait Moderator Covariate term                       estimate  conf.low conf.high study         n
##    &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
##  1 Frequentist crystallized A     baseAge   age       p_value:baseAge             0.00400 -0.00174    0.00973 Meta-Ana…    NA
##  2 Frequentist crystallized A     baseYear  age       p_value:baseYear            0.0102   0.00399    0.0164  Meta-Ana…    NA
##  3 Frequentist crystallized A     continent age       p_value:continentAustralia -0.0489  -0.211      0.113   Meta-Ana…    NA
##  4 Frequentist crystallized A     continent age       p_value:continentEurope    -0.177   -0.314     -0.0391  Meta-Ana…    NA
##  5 Frequentist crystallized A     country   age       p_value:countryAustralia   -0.0309  -0.0775     0.0158  Meta-Ana…    NA
##  6 Frequentist crystallized A     country   age       p_value:countryGermany     -0.0873  -0.133     -0.0418  Meta-Ana…    NA
##  7 Frequentist crystallized A     country   age       p_value:countrySweden      -0.268   -0.377     -0.158   Meta-Ana…    NA
##  8 Frequentist crystallized A     predInt   age       p_value:predInt            -0.0198  -0.0331    -0.00647 Meta-Ana…    NA
##  9 Frequentist crystallized A     baseAge   all       p_value:baseAge             0.00164 -0.00104    0.00431 Meta-Ana…    NA
## 10 Frequentist crystallized A     baseYear  all       p_value:baseYear            0.00507  0.000720   0.00943 Meta-Ana…    NA
## # ℹ 1,625 more rows</code></pre>
<div id="study-specific" class="section level6 hasAnchor" number="5.4.3.0.1.1">
<h6><span class="header-section-number">5.4.3.0.1.1</span> Study-Specific<a href="method-3-two-stage-individual-participant-meta-analysis.html#study-specific" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Next, we’ll make a table of the results, separately for each moderator. To do this efficiently, we’ll make a function that creates those tables across all combinations. Before calling that function, we’ll do some reformatting and reshaping to get the data ready.</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb380-1" tabindex="-1"></a>ipd3_res_tab <span class="ot">&lt;-</span> ipd3_meta_res <span class="sc">%&gt;%</span></span>
<span id="cb380-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb380-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(<span class="fu">sign</span>(conf.low) <span class="sc">==</span> <span class="fu">sign</span>(conf.high), <span class="st">&quot;sig&quot;</span>, <span class="st">&quot;ns&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># significance marker</span></span>
<span id="cb380-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb380-3" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(estimate<span class="sc">:</span>conf.high), </span>
<span id="cb380-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb380-4" tabindex="-1"></a>            <span class="sc">~</span><span class="fu">ifelse</span>(<span class="fu">abs</span>(.) <span class="sc">&lt;</span> .<span class="dv">01</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, .), <span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>,.))) <span class="sc">%&gt;%</span></span>
<span id="cb380-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb380-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">est =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s&lt;br&gt;[%s, %s]&quot;</span>, estimate, conf.low, conf.high),</span>
<span id="cb380-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb380-6" tabindex="-1"></a>         <span class="at">est =</span> <span class="fu">ifelse</span>(sig <span class="sc">==</span> <span class="st">&quot;sig&quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;&lt;strong&gt;%s&lt;/strong&gt;&quot;</span>, est), est),</span>
<span id="cb380-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb380-7" tabindex="-1"></a>         <span class="at">study =</span> <span class="fu">factor</span>(study, <span class="fu">c</span>(studies_long, <span class="st">&quot;Meta-Analytic&quot;</span>)),</span>
<span id="cb380-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb380-8" tabindex="-1"></a>         <span class="at">Outcome =</span> <span class="fu">factor</span>(Outcome, outcomes<span class="sc">$</span>short_name, outcomes<span class="sc">$</span>long_name)) <span class="sc">%&gt;%</span></span>
<span id="cb380-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb380-9" tabindex="-1"></a>  <span class="fu">select</span>(type<span class="sc">:</span>Covariate, term, study, est) <span class="sc">%&gt;%</span></span>
<span id="cb380-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb380-10" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;Trait&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;est&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb380-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb380-11" tabindex="-1"></a>  <span class="fu">select</span>(type<span class="sc">:</span>study, E, A, C, N, O) <span class="sc">%&gt;%</span></span>
<span id="cb380-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb380-12" tabindex="-1"></a>  <span class="fu">arrange</span>(type, Outcome, Moderator, Covariate, study)</span>
<span id="cb380-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb380-13" tabindex="-1"></a>ipd3_res_tab</span></code></pre></div>
<pre><code>## # A tibble: 414 × 11
##    type     Outcome              Moderator Covariate term        study     E                          A     C     N     O    
##    &lt;chr&gt;    &lt;fct&gt;                &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;       &lt;fct&gt;     &lt;chr&gt;                      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
##  1 Bayesian Crystallized Ability age       all       p_value:age BASE      0.002&lt;br&gt;[-0.04, 0.04]     &lt;NA&gt;  &lt;NA&gt;  0.01… -0.0…
##  2 Bayesian Crystallized Ability age       all       p_value:age EAS       -0.005&lt;br&gt;[-0.02, 0.01]    -0.0… &lt;str… &lt;str… -0.0…
##  3 Bayesian Crystallized Ability age       all       p_value:age GSOEP     -0.000&lt;br&gt;[-0.004, 0.003]  -0.0… 0.00… 0.00… -0.0…
##  4 Bayesian Crystallized Ability age       all       p_value:age HILDA     &lt;strong&gt;0.001&lt;br&gt;[0.000, … 0.00… &lt;str… &lt;str… &lt;str…
##  5 Bayesian Crystallized Ability age       all       p_value:age HRS       -0.002&lt;br&gt;[-0.005, 0.001]  -0.0… &lt;str… 0.00… &lt;str…
##  6 Bayesian Crystallized Ability age       all       p_value:age LASA      &lt;NA&gt;                       &lt;NA&gt;  &lt;NA&gt;  -0.0… &lt;NA&gt; 
##  7 Bayesian Crystallized Ability age       all       p_value:age MAP       -0.002&lt;br&gt;[-0.009, 0.005]  &lt;NA&gt;  0.00… -0.0… &lt;NA&gt; 
##  8 Bayesian Crystallized Ability age       all       p_value:age MARS      &lt;NA&gt;                       &lt;NA&gt;  &lt;NA&gt;  -0.0… &lt;NA&gt; 
##  9 Bayesian Crystallized Ability age       all       p_value:age OCTO-Twin -0.01&lt;br&gt;[-0.06, 0.03]     &lt;NA&gt;  &lt;NA&gt;  0.03… &lt;NA&gt; 
## 10 Bayesian Crystallized Ability age       all       p_value:age ROS       0.004&lt;br&gt;[-0.007, 0.01]    &lt;str… 0.00… &lt;str… &lt;str…
## # ℹ 404 more rows</code></pre>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-1" tabindex="-1"></a>ipd3_stdmeta_table_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, type, moder, cov){</span>
<span id="cb382-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-2" tabindex="-1"></a>  cv <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(cov, covars<span class="sc">$</span>short_name, covars<span class="sc">$</span>long_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb382-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-3" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;djust&quot;</span>, cv)) cv <span class="ot">&lt;-</span> <span class="fu">paste</span>(cv, <span class="st">&quot;Adjusted&quot;</span>)</span>
<span id="cb382-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-4" tabindex="-1"></a>  md <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(moder, <span class="fu">c</span>(moders<span class="sc">$</span>short_name, stdyModers<span class="sc">$</span>short_name),</span>
<span id="cb382-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-5" tabindex="-1"></a>                  <span class="fu">c</span>(moders<span class="sc">$</span>long_name, stdyModers<span class="sc">$</span>long_name), <span class="at">warn_missing =</span> F)</span>
<span id="cb382-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-6" tabindex="-1"></a>  rs <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Outcome) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb382-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-7" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">end =</span> <span class="fu">cumsum</span>(n), <span class="at">start =</span> <span class="fu">lag</span>(end) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">start =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(start), <span class="dv">1</span>, start))</span>
<span id="cb382-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-8" tabindex="-1"></a>  cs <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>); <span class="fu">names</span>(cs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot; &quot;</span>, traits<span class="sc">$</span>short_name)</span>
<span id="cb382-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-9" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="cf">if</span>(moder <span class="sc">==</span> <span class="st">&quot;none&quot;</span>) {</span>
<span id="cb382-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-10" tabindex="-1"></a>      <span class="fu">sprintf</span>(<span class="st">&quot;&lt;strong&gt;Table X.&lt;/strong&gt;&lt;br&gt;&lt;em&gt;Method 3 Pooled Regression Using Random Effects: Study and Meta-Analytic Estimates of %s Personality-Cognitive Domain Relationships&lt;/em&gt;&quot;</span>, cv) </span>
<span id="cb382-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-11" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb382-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-12" tabindex="-1"></a>      <span class="fu">sprintf</span>(<span class="st">&quot;&lt;strong&gt;Table X.&lt;/strong&gt;&lt;br&gt;&lt;em&gt;Method 3 Pooled Regression Using Random Effects: Study and Meta-Analytic %s Moderation of %s Personality-Cognitive Domain Relationships&lt;/em&gt;&quot;</span>, md, cv)</span>
<span id="cb382-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-13" tabindex="-1"></a>    }</span>
<span id="cb382-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-14" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb382-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-15" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Outcome) <span class="sc">%&gt;%</span></span>
<span id="cb382-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-16" tabindex="-1"></a>    <span class="fu">kable</span>(., <span class="st">&quot;html&quot;</span></span>
<span id="cb382-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-17" tabindex="-1"></a>          , <span class="at">escape =</span> F</span>
<span id="cb382-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-18" tabindex="-1"></a>          , <span class="at">booktabs =</span> T</span>
<span id="cb382-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-19" tabindex="-1"></a>          , <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Study&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">beta$ [CI]&quot;</span>, <span class="dv">5</span>))</span>
<span id="cb382-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-20" tabindex="-1"></a>          , <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">5</span>))</span>
<span id="cb382-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-21" tabindex="-1"></a>          , <span class="at">caption =</span> cap) <span class="sc">%&gt;%</span></span>
<span id="cb382-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-22" tabindex="-1"></a>    <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">&quot;Times New Roman&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb382-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-23" tabindex="-1"></a>    <span class="fu">add_header_above</span>(cs) </span>
<span id="cb382-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-24" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(rs)){</span>
<span id="cb382-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-25" tabindex="-1"></a>    tab <span class="ot">&lt;-</span> tab <span class="sc">%&gt;%</span> </span>
<span id="cb382-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-26" tabindex="-1"></a>      kableExtra<span class="sc">::</span><span class="fu">group_rows</span>(rs<span class="sc">$</span>Outcome[i], rs<span class="sc">$</span>start[i], rs<span class="sc">$</span>end[i])</span>
<span id="cb382-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-27" tabindex="-1"></a>  }</span>
<span id="cb382-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-28" tabindex="-1"></a>  <span class="fu">save_kable</span>(tab, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/tables/study specific/%s_%s.html&quot;</span>,</span>
<span id="cb382-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-29" tabindex="-1"></a>                                 local_path, type, moder, cov))</span>
<span id="cb382-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-30" tabindex="-1"></a>  <span class="fu">return</span>(tab)</span>
<span id="cb382-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-31" tabindex="-1"></a>}</span>
<span id="cb382-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-32" tabindex="-1"></a></span>
<span id="cb382-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-33" tabindex="-1"></a>ipd3_std_tab <span class="ot">&lt;-</span> ipd3_res_tab <span class="sc">%&gt;%</span></span>
<span id="cb382-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-34" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Moderator <span class="sc">%in%</span> stdyModers<span class="sc">$</span>short_name) <span class="sc">%&gt;%</span></span>
<span id="cb382-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-35" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>term) <span class="sc">%&gt;%</span></span>
<span id="cb382-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-36" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Moderator, Covariate) <span class="sc">%&gt;%</span></span>
<span id="cb382-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-37" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb382-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-38" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb382-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb382-39" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tab =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(data, type, Moderator, Covariate), ipd3_stdmeta_table_fun))</span></code></pre></div>
</div>
<div id="meta-analytic" class="section level6 hasAnchor" number="5.4.3.0.1.2">
<h6><span class="header-section-number">5.4.3.0.1.2</span> Meta-Analytic<a href="method-3-two-stage-individual-participant-meta-analysis.html#meta-analytic" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-1" tabindex="-1"></a>ipd3_tab_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, type, moder){</span>
<span id="cb383-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-2" tabindex="-1"></a>  md <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(moder, <span class="fu">c</span>(moders<span class="sc">$</span>long_name, stdyModers<span class="sc">$</span>long_name), <span class="fu">c</span>(moders<span class="sc">$</span>short_name, stdyModers<span class="sc">$</span>short_name), <span class="at">warn_missing =</span> F)</span>
<span id="cb383-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-3" tabindex="-1"></a>  rs <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Outcome) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb383-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-4" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">end =</span> <span class="fu">cumsum</span>(n), <span class="at">start =</span> <span class="fu">lag</span>(end) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">start =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(start), <span class="dv">1</span>, start))</span>
<span id="cb383-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-5" tabindex="-1"></a>  cs <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">unique</span>(d<span class="sc">$</span>term)) <span class="sc">==</span> <span class="dv">1</span>)  <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>) <span class="cf">else</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>)) </span>
<span id="cb383-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-6" tabindex="-1"></a>  <span class="fu">names</span>(cs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot; &quot;</span>, traits<span class="sc">$</span>long_name)</span>
<span id="cb383-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-7" tabindex="-1"></a>  cln <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">unique</span>(d<span class="sc">$</span>term)) <span class="sc">==</span> <span class="dv">1</span>) <span class="fu">c</span>(<span class="st">&quot;CovariaCtes&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;&lt;em&gt;b&lt;/em&gt; [CI]&quot;</span>, <span class="dv">5</span>)) <span class="cf">else</span> <span class="fu">c</span>(<span class="st">&quot;Covariates&quot;</span>, <span class="st">&quot;Term&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;&lt;em&gt;b&lt;/em&gt; [CI]&quot;</span>, <span class="dv">5</span>))</span>
<span id="cb383-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-8" tabindex="-1"></a>  <span class="co"># cln &lt;- if(length(unique(d$term)) == 1) c(&quot;Covariates&quot;, rep(&quot;\\textit{b} [CI]&quot;, 5)) else c(&quot;Covariates&quot;, &quot;Term&quot;, rep(&quot;\\textit{b} [CI]&quot;, 5))</span></span>
<span id="cb383-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-9" tabindex="-1"></a>  al <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">unique</span>(d<span class="sc">$</span>term)) <span class="sc">==</span> <span class="dv">1</span>) <span class="fu">c</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">5</span>)) <span class="cf">else</span> <span class="fu">c</span>(<span class="st">&quot;r&quot;</span>, <span class="st">&quot;r&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">5</span>))</span>
<span id="cb383-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-10" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">unique</span>(d<span class="sc">$</span>term)) <span class="sc">==</span> <span class="dv">1</span>) d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>term)</span>
<span id="cb383-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-11" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="cf">if</span>(md <span class="sc">==</span> <span class="st">&quot;none&quot;</span>) <span class="st">&quot;&lt;strong&gt;Table X.&lt;/strong&gt;&lt;br&gt;&lt;em&gt;Method 3 Pooled Regression Using Random Effects: Meta-Analytic Effects of Personality-Crystallized Domain Associations&lt;/em&gt;&quot;</span> <span class="cf">else</span> <span class="fu">sprintf</span>(<span class="st">&quot;&lt;strong&gt;Table X.&lt;/strong&gt;&lt;br&gt;&lt;em&gt;Method 3 Pooled Regression Using Random Effects: Meta-Analytic %s Moderation of Personality-Crystallized Domain Associations&lt;/em&gt;&quot;</span>, md)</span>
<span id="cb383-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-12" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb383-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-13" tabindex="-1"></a>    <span class="fu">arrange</span>(Outcome) <span class="sc">%&gt;%</span></span>
<span id="cb383-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-14" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Outcome) <span class="sc">%&gt;%</span></span>
<span id="cb383-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-15" tabindex="-1"></a>    <span class="fu">kable</span>(., <span class="st">&quot;html&quot;</span></span>
<span id="cb383-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-16" tabindex="-1"></a>    <span class="co"># kable(., &quot;latex&quot;</span></span>
<span id="cb383-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-17" tabindex="-1"></a>          , <span class="at">booktabs =</span> T</span>
<span id="cb383-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-18" tabindex="-1"></a>          , <span class="at">escape =</span> F</span>
<span id="cb383-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-19" tabindex="-1"></a>          , <span class="at">col.names =</span> cln</span>
<span id="cb383-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-20" tabindex="-1"></a>          , <span class="at">align =</span> al</span>
<span id="cb383-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-21" tabindex="-1"></a>          , <span class="at">caption =</span> cap</span>
<span id="cb383-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-22" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb383-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-23" tabindex="-1"></a>    <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">&quot;Times New Roman&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb383-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-24" tabindex="-1"></a>    <span class="fu">add_header_above</span>(cs) </span>
<span id="cb383-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-25" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(rs)) {</span>
<span id="cb383-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-26" tabindex="-1"></a>    tab <span class="ot">&lt;-</span> tab <span class="sc">%&gt;%</span> kableExtra<span class="sc">::</span><span class="fu">group_rows</span>(rs<span class="sc">$</span>Outcome[i], rs<span class="sc">$</span>start[i], rs<span class="sc">$</span>end[i])</span>
<span id="cb383-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-27" tabindex="-1"></a>  }</span>
<span id="cb383-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-28" tabindex="-1"></a>  <span class="fu">save_kable</span>(tab, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/tables/overall/%s.html&quot;</span></span>
<span id="cb383-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-29" tabindex="-1"></a>                                 , local_path, type, md))</span>
<span id="cb383-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-30" tabindex="-1"></a>  <span class="fu">return</span>(tab)</span>
<span id="cb383-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-31" tabindex="-1"></a>}</span>
<span id="cb383-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-32" tabindex="-1"></a></span>
<span id="cb383-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-33" tabindex="-1"></a>ipd3_meta_res_tab <span class="ot">&lt;-</span> ipd3_res_tab <span class="sc">%&gt;%</span></span>
<span id="cb383-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-34" tabindex="-1"></a>  <span class="fu">filter</span>(study <span class="sc">==</span> <span class="st">&quot;Meta-Analytic&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb383-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-35" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>study) <span class="sc">%&gt;%</span></span>
<span id="cb383-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-36" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">str_remove_all</span>(term, <span class="st">&quot;p_value:&quot;</span>),</span>
<span id="cb383-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-37" tabindex="-1"></a>         <span class="at">term =</span> <span class="fu">mapvalues</span>(term, <span class="fu">str_remove_all</span>(stdyModers<span class="sc">$</span>short_term, <span class="st">&quot; &quot;</span>), stdyModers<span class="sc">$</span>long_term),</span>
<span id="cb383-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-38" tabindex="-1"></a>         <span class="at">term =</span> <span class="fu">mapvalues</span>(term, <span class="fu">str_replace_all</span>(stdyModers<span class="sc">$</span>short_term, <span class="st">&quot;-&quot;</span>, <span class="st">&quot;M&quot;</span>), stdyModers<span class="sc">$</span>long_term),</span>
<span id="cb383-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-39" tabindex="-1"></a>         <span class="at">term =</span> <span class="fu">mapvalues</span>(term, moders<span class="sc">$</span>short_term, moders<span class="sc">$</span>long_term),</span>
<span id="cb383-40"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-40" tabindex="-1"></a>         <span class="at">term =</span> <span class="fu">mapvalues</span>(term, moders<span class="sc">$</span>short_name, moders<span class="sc">$</span>long_term),</span>
<span id="cb383-41"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-41" tabindex="-1"></a>         <span class="at">Covariate =</span> <span class="fu">mapvalues</span>(Covariate, covars<span class="sc">$</span>short_name, covars<span class="sc">$</span>long_name)) <span class="sc">%&gt;%</span></span>
<span id="cb383-42"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-42" tabindex="-1"></a>  <span class="fu">arrange</span>(Outcome, term, Covariate)</span>
<span id="cb383-43"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-43" tabindex="-1"></a>ipd3_meta_res_tab <span class="sc">%&gt;%</span></span>
<span id="cb383-44"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-44" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Moderator) <span class="sc">%&gt;%</span></span>
<span id="cb383-45"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-45" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb383-46"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-46" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb383-47"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb383-47" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tab =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(data, type, Moderator), ipd3_tab_fun))</span></code></pre></div>
<pre><code>## # A tibble: 20 × 4
##    type        Moderator data              tab           
##    &lt;chr&gt;       &lt;chr&gt;     &lt;list&gt;            &lt;list&gt;        
##  1 Bayesian    age       &lt;tibble [2 × 8]&gt;  &lt;kablExtr [1]&gt;
##  2 Frequentist age       &lt;tibble [2 × 8]&gt;  &lt;kablExtr [1]&gt;
##  3 Bayesian    continent &lt;tibble [10 × 8]&gt; &lt;kablExtr [1]&gt;
##  4 Frequentist continent &lt;tibble [10 × 8]&gt; &lt;kablExtr [1]&gt;
##  5 Bayesian    country   &lt;tibble [20 × 8]&gt; &lt;kablExtr [1]&gt;
##  6 Frequentist country   &lt;tibble [20 × 8]&gt; &lt;kablExtr [1]&gt;
##  7 Bayesian    education &lt;tibble [2 × 8]&gt;  &lt;kablExtr [1]&gt;
##  8 Frequentist education &lt;tibble [2 × 8]&gt;  &lt;kablExtr [1]&gt;
##  9 Bayesian    gender    &lt;tibble [2 × 8]&gt;  &lt;kablExtr [1]&gt;
## 10 Frequentist gender    &lt;tibble [2 × 8]&gt;  &lt;kablExtr [1]&gt;
## 11 Bayesian    none      &lt;tibble [5 × 8]&gt;  &lt;kablExtr [1]&gt;
## 12 Frequentist none      &lt;tibble [5 × 8]&gt;  &lt;kablExtr [1]&gt;
## 13 Bayesian    predInt   &lt;tibble [5 × 8]&gt;  &lt;kablExtr [1]&gt;
## 14 Frequentist predInt   &lt;tibble [5 × 8]&gt;  &lt;kablExtr [1]&gt;
## 15 Bayesian    scale     &lt;tibble [30 × 8]&gt; &lt;kablExtr [1]&gt;
## 16 Frequentist scale     &lt;tibble [30 × 8]&gt; &lt;kablExtr [1]&gt;
## 17 Bayesian    baseAge   &lt;tibble [5 × 8]&gt;  &lt;kablExtr [1]&gt;
## 18 Frequentist baseAge   &lt;tibble [5 × 8]&gt;  &lt;kablExtr [1]&gt;
## 19 Bayesian    baseYear  &lt;tibble [5 × 8]&gt;  &lt;kablExtr [1]&gt;
## 20 Frequentist baseYear  &lt;tibble [5 × 8]&gt;  &lt;kablExtr [1]&gt;</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-1" tabindex="-1"></a>ipd3_tab_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, type, cov){</span>
<span id="cb385-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-2" tabindex="-1"></a>  <span class="co"># long outcome name</span></span>
<span id="cb385-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-3" tabindex="-1"></a>  covar <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(cov, covars<span class="sc">$</span>long_name, covars<span class="sc">$</span>short_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb385-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-4" tabindex="-1"></a>  <span class="co"># getting row numbers for later grouping</span></span>
<span id="cb385-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-5" tabindex="-1"></a>  rs <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Moderator) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb385-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-6" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">end =</span> <span class="fu">cumsum</span>(n), <span class="at">start =</span> <span class="fu">lag</span>(end) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">start =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(start), <span class="dv">1</span>, start))</span>
<span id="cb385-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-7" tabindex="-1"></a>  <span class="co"># number and name of columns for span columns </span></span>
<span id="cb385-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-8" tabindex="-1"></a>  cs <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>)</span>
<span id="cb385-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-9" tabindex="-1"></a>  <span class="fu">names</span>(cs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot; &quot;</span>, traits<span class="sc">$</span>long_name)</span>
<span id="cb385-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-10" tabindex="-1"></a>  <span class="co"># cln &lt;- if(length(unique(d$term2)) == 1) c(&quot;Covariate&quot;, rep(&quot;\\textit{b} [CI]&quot;, 5)) else c(&quot; &quot;, &quot;Term&quot;, rep(&quot;\\textit{b} [CI]&quot;, 5))</span></span>
<span id="cb385-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-11" tabindex="-1"></a>  cln <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Term&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;&lt;em&gt;b&lt;/em&gt; [CI]&quot;</span>, <span class="dv">5</span>))</span>
<span id="cb385-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-12" tabindex="-1"></a>  al <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">5</span>))</span>
<span id="cb385-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-13" tabindex="-1"></a>  <span class="co"># caption </span></span>
<span id="cb385-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-14" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;Method 3 Pooled Regression Using Random Effects: Meta-Analytic Estimates of %s Personality-Crystallized Domain Associations&quot;</span>, cov)</span>
<span id="cb385-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-15" tabindex="-1"></a>  <span class="co"># kable the table</span></span>
<span id="cb385-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-16" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb385-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-17" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Moderator) <span class="sc">%&gt;%</span></span>
<span id="cb385-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-18" tabindex="-1"></a>    <span class="fu">kable</span>(., <span class="st">&quot;html&quot;</span></span>
<span id="cb385-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-19" tabindex="-1"></a>    <span class="co"># kable(., &quot;latex&quot;</span></span>
<span id="cb385-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-20" tabindex="-1"></a>          , <span class="at">booktabs =</span> T</span>
<span id="cb385-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-21" tabindex="-1"></a>          , <span class="at">escape =</span> F</span>
<span id="cb385-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-22" tabindex="-1"></a>          , <span class="at">col.names =</span> cln</span>
<span id="cb385-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-23" tabindex="-1"></a>          , <span class="at">align =</span> al</span>
<span id="cb385-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-24" tabindex="-1"></a>          , <span class="at">caption =</span> cap</span>
<span id="cb385-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-25" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb385-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-26" tabindex="-1"></a>    <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">&quot;Times New Roman&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb385-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-27" tabindex="-1"></a>    <span class="co"># kable_styling(full_width = F, font_size = 7) %&gt;%</span></span>
<span id="cb385-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-28" tabindex="-1"></a>    <span class="fu">add_header_above</span>(cs)</span>
<span id="cb385-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-29" tabindex="-1"></a>  <span class="co"># for loop to add grouped sections </span></span>
<span id="cb385-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-30" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(rs)){</span>
<span id="cb385-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-31" tabindex="-1"></a>    tab <span class="ot">&lt;-</span> tab <span class="sc">%&gt;%</span> </span>
<span id="cb385-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-32" tabindex="-1"></a>      kableExtra<span class="sc">::</span><span class="fu">group_rows</span>(rs<span class="sc">$</span>Moderator[i], rs<span class="sc">$</span>start[i], rs<span class="sc">$</span>end[i]) </span>
<span id="cb385-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-33" tabindex="-1"></a>  }</span>
<span id="cb385-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-34" tabindex="-1"></a>  <span class="co"># save the resulting html table</span></span>
<span id="cb385-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-35" tabindex="-1"></a>  <span class="fu">save_kable</span>(tab, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/tables/key terms/%s.html&quot;</span></span>
<span id="cb385-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-36" tabindex="-1"></a>                                 , local_path, type, covar))</span>
<span id="cb385-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-37" tabindex="-1"></a>  <span class="fu">return</span>(tab) <span class="co"># return the html table</span></span>
<span id="cb385-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-38" tabindex="-1"></a>}</span>
<span id="cb385-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-39" tabindex="-1"></a></span>
<span id="cb385-40"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-40" tabindex="-1"></a>ipd3_fx_tab2 <span class="ot">&lt;-</span> ipd3_res_tab <span class="sc">%&gt;%</span></span>
<span id="cb385-41"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-41" tabindex="-1"></a>  <span class="fu">filter</span>(study <span class="sc">==</span> <span class="st">&quot;Meta-Analytic&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb385-42"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-42" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>study) <span class="sc">%&gt;%</span></span>
<span id="cb385-43"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-43" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">str_remove_all</span>(term, <span class="st">&quot;p_value:&quot;</span>),</span>
<span id="cb385-44"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-44" tabindex="-1"></a>         <span class="at">term =</span> <span class="fu">mapvalues</span>(term, <span class="fu">str_remove_all</span>(stdyModers<span class="sc">$</span>short_term, <span class="st">&quot; &quot;</span>), stdyModers<span class="sc">$</span>long_term),</span>
<span id="cb385-45"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-45" tabindex="-1"></a>         <span class="at">term =</span> <span class="fu">mapvalues</span>(term, <span class="fu">str_replace_all</span>(stdyModers<span class="sc">$</span>short_term, <span class="st">&quot;-&quot;</span>, <span class="st">&quot;M&quot;</span>), stdyModers<span class="sc">$</span>long_term),</span>
<span id="cb385-46"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-46" tabindex="-1"></a>         <span class="at">term =</span> <span class="fu">mapvalues</span>(term, moders<span class="sc">$</span>short_term, moders<span class="sc">$</span>long_term),</span>
<span id="cb385-47"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-47" tabindex="-1"></a>         <span class="at">term =</span> <span class="fu">mapvalues</span>(term, moders<span class="sc">$</span>short_name, moders<span class="sc">$</span>long_term),</span>
<span id="cb385-48"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-48" tabindex="-1"></a>         <span class="at">Moderator =</span> <span class="fu">factor</span>(Moderator, <span class="at">levels =</span> <span class="fu">c</span>(moders<span class="sc">$</span>short_name, stdyModers<span class="sc">$</span>short_name), <span class="at">labels =</span> <span class="fu">c</span>(moders<span class="sc">$</span>long_name, stdyModers<span class="sc">$</span>long_name)),</span>
<span id="cb385-49"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-49" tabindex="-1"></a>         <span class="at">Covariate =</span> <span class="fu">mapvalues</span>(Covariate, covars<span class="sc">$</span>short_name, covars<span class="sc">$</span>long_name)) <span class="sc">%&gt;%</span></span>
<span id="cb385-50"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-50" tabindex="-1"></a>  <span class="fu">arrange</span>(Outcome, Moderator, term, Covariate) <span class="sc">%&gt;%</span></span>
<span id="cb385-51"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-51" tabindex="-1"></a>  <span class="fu">filter</span>(Covariate <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Fully Adjusted&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb385-52"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-52" tabindex="-1"></a>  <span class="fu">group_by</span>(Outcome, type, Covariate) <span class="sc">%&gt;%</span> </span>
<span id="cb385-53"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-53" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb385-54"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-54" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb385-55"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-55" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tab =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(data, type, Covariate), ipd3_tab_fun))</span>
<span id="cb385-56"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-56" tabindex="-1"></a></span>
<span id="cb385-57"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb385-57" tabindex="-1"></a><span class="co"># save(ipd1a_fx_tab, ipd1a_fx_tab2, ipd1a_res, file = sprintf(&quot;%s/manuscript/results/ipd1b_fx_tab.RData&quot;, res_path))</span></span></code></pre></div>
</div>
<div id="all-model-terms-4" class="section level6 hasAnchor" number="5.4.3.0.1.3">
<h6><span class="header-section-number">5.4.3.0.1.3</span> All Model Terms<a href="method-3-two-stage-individual-participant-meta-analysis.html#all-model-terms-4" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-1" tabindex="-1"></a>ipd3_mod_tab <span class="ot">&lt;-</span> nested_ipd3_meta <span class="sc">%&gt;%</span></span>
<span id="cb386-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>metaEff, <span class="sc">-</span>metaHet) <span class="sc">%&gt;%</span></span>
<span id="cb386-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-3" tabindex="-1"></a>  <span class="fu">unnest</span>(studyEff) <span class="sc">%&gt;%</span></span>
<span id="cb386-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-4" tabindex="-1"></a>  <span class="co"># keep key terms </span></span>
<span id="cb386-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-5" tabindex="-1"></a>  <span class="co"># mark significance and prettify trait, outcome, and covariate names</span></span>
<span id="cb386-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(<span class="fu">sign</span>(conf.low) <span class="sc">==</span> <span class="fu">sign</span>(conf.high), <span class="st">&quot;sig&quot;</span>, <span class="st">&quot;ns&quot;</span>),</span>
<span id="cb386-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-7" tabindex="-1"></a>         <span class="at">Trait =</span> <span class="fu">factor</span>(Trait, traits<span class="sc">$</span>short_name),</span>
<span id="cb386-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-8" tabindex="-1"></a>         <span class="at">Outcome =</span> <span class="fu">factor</span>(Outcome, outcomes<span class="sc">$</span>short_name, outcomes<span class="sc">$</span>long_name),</span>
<span id="cb386-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-9" tabindex="-1"></a>         <span class="at">Moderator =</span> <span class="fu">factor</span>(Moderator, <span class="fu">c</span>(moders<span class="sc">$</span>short_name, stdyModers<span class="sc">$</span>short_name), <span class="fu">c</span>(moders<span class="sc">$</span>long_name, stdyModers<span class="sc">$</span>long_name)),</span>
<span id="cb386-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-10" tabindex="-1"></a>         <span class="at">Covariate =</span> <span class="fu">factor</span>(Covariate, covars<span class="sc">$</span>short_name, <span class="fu">str_wrap</span>(covars<span class="sc">$</span>long_name, <span class="dv">15</span>)),</span>
<span id="cb386-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-11" tabindex="-1"></a>         <span class="at">term =</span> <span class="fu">str_replace_all</span>(term, <span class="st">&quot;metamod&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;p_value:&quot;</span>, Moderator))) <span class="sc">%&gt;%</span></span>
<span id="cb386-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-12" tabindex="-1"></a>  <span class="co"># format values as text, combine estimates and CI&#39;s, bold significance</span></span>
<span id="cb386-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-13" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(estimate, conf.low, conf.high), </span>
<span id="cb386-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-14" tabindex="-1"></a>            <span class="sc">~</span><span class="fu">ifelse</span>(<span class="fu">abs</span>(.) <span class="sc">&lt;</span> .<span class="dv">01</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, .), <span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, .))) <span class="sc">%&gt;%</span></span>
<span id="cb386-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-15" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">est =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s&lt;br&gt;[%s, %s]&quot;</span>, estimate, conf.low, conf.high),</span>
<span id="cb386-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-16" tabindex="-1"></a>         <span class="at">est =</span> <span class="fu">ifelse</span>(sig <span class="sc">==</span> <span class="st">&quot;sig&quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;&lt;strong&gt;%s&lt;/strong&gt;&quot;</span>, est), est),</span>
<span id="cb386-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-17" tabindex="-1"></a>         <span class="at">study =</span> <span class="fu">mapvalues</span>(study, <span class="fu">c</span>(<span class="st">&quot;BASE-I&quot;</span>, <span class="st">&quot;OCTO-TWIN&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;BASE&quot;</span>, <span class="st">&quot;OCTO-Twin&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb386-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-18" tabindex="-1"></a>  <span class="co"># mutate(est = sprintf(&quot;%s [%s, %s]&quot;, estimate, conf.low, conf.high),</span></span>
<span id="cb386-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-19" tabindex="-1"></a>  <span class="co"># est = ifelse(sig == &quot;sig&quot;, sprintf(&quot;\\textbf{%s}&quot;, est), est)) %&gt;%</span></span>
<span id="cb386-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-20" tabindex="-1"></a>  <span class="co"># final reshaping, remove extra columns, arrange values, and change to wide format</span></span>
<span id="cb386-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-21" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>estimate, <span class="sc">-</span>conf.low, <span class="sc">-</span>conf.high, <span class="sc">-</span>sig, <span class="sc">-</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb386-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-22" tabindex="-1"></a>  <span class="fu">arrange</span>(type, Outcome, Trait, Moderator, Covariate) <span class="sc">%&gt;%</span></span>
<span id="cb386-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-23" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;Trait&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;est&quot;</span>) </span>
<span id="cb386-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-24" tabindex="-1"></a></span>
<span id="cb386-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-25" tabindex="-1"></a>ipd3_mod_tab_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, type, out, moder, cov){</span>
<span id="cb386-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-26" tabindex="-1"></a>  md <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(moder, <span class="fu">c</span>(moders<span class="sc">$</span>long_name, stdyModers<span class="sc">$</span>long_name), <span class="fu">c</span>(moders<span class="sc">$</span>short_name, stdyModers<span class="sc">$</span>short_name), <span class="at">warn_missing =</span> F)</span>
<span id="cb386-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-27" tabindex="-1"></a>  o <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(out, outcomes<span class="sc">$</span>long_name, outcomes<span class="sc">$</span>short_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb386-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-28" tabindex="-1"></a>  cv <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(cov, covars<span class="sc">$</span>long_name, covars<span class="sc">$</span>short_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb386-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-29" tabindex="-1"></a>  cs <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>)</span>
<span id="cb386-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-30" tabindex="-1"></a>  <span class="fu">names</span>(cs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot; &quot;</span>, traits<span class="sc">$</span>long_name)</span>
<span id="cb386-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-31" tabindex="-1"></a>  <span class="co"># cln &lt;- if(length(unique(d$term2)) == 1) c(&quot;Covariate&quot;, rep(&quot;\\textit{b} [CI]&quot;, 5)) else c(&quot; &quot;, &quot;Term&quot;, rep(&quot;\\textit{b} [CI]&quot;, 5))</span></span>
<span id="cb386-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-32" tabindex="-1"></a>  cln <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Term&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;&lt;em&gt;b&lt;/em&gt; [CI]&quot;</span>, <span class="dv">5</span>))</span>
<span id="cb386-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-33" tabindex="-1"></a>  al <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">5</span>))</span>
<span id="cb386-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-34" tabindex="-1"></a>  <span class="co"># caption </span></span>
<span id="cb386-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-35" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="cf">if</span>(md <span class="sc">==</span> <span class="st">&quot;none&quot;</span>) <span class="st">&quot;3 Separate Models Followed Random Effects Meta-Analysis: All Model Estimates of Fixed Effect Personality-Crystallized Domain Associations&quot;</span> <span class="cf">else</span> <span class="fu">sprintf</span>(<span class="st">&quot;3 Separate Models Followed Random Effects Meta-Analysis: All Model Estimates of Fixed Effect %s Moderation of Personality-Crystallized Domain Associations&quot;</span>, md)</span>
<span id="cb386-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-36" tabindex="-1"></a>  </span>
<span id="cb386-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-37" tabindex="-1"></a>  d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(study, term)</span>
<span id="cb386-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-38" tabindex="-1"></a>  </span>
<span id="cb386-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-39" tabindex="-1"></a>  rs <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(study) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb386-40"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-40" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">end =</span> <span class="fu">cumsum</span>(n), <span class="at">start =</span> <span class="fu">lag</span>(end) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">start =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(start), <span class="dv">1</span>, start))</span>
<span id="cb386-41"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-41" tabindex="-1"></a>  </span>
<span id="cb386-42"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-42" tabindex="-1"></a>  <span class="co"># kable the table</span></span>
<span id="cb386-43"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-43" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb386-44"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-44" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>study) <span class="sc">%&gt;%</span></span>
<span id="cb386-45"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-45" tabindex="-1"></a>    <span class="fu">kable</span>(., <span class="st">&quot;html&quot;</span></span>
<span id="cb386-46"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-46" tabindex="-1"></a>    <span class="co"># kable(., &quot;latex&quot;</span></span>
<span id="cb386-47"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-47" tabindex="-1"></a>          , <span class="at">booktabs =</span> T</span>
<span id="cb386-48"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-48" tabindex="-1"></a>          , <span class="at">escape =</span> F</span>
<span id="cb386-49"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-49" tabindex="-1"></a>          , <span class="at">col.names =</span> cln</span>
<span id="cb386-50"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-50" tabindex="-1"></a>          , <span class="at">align =</span> al</span>
<span id="cb386-51"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-51" tabindex="-1"></a>          , <span class="at">caption =</span> cap</span>
<span id="cb386-52"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-52" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb386-53"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-53" tabindex="-1"></a>    <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">&quot;Times New Roman&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb386-54"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-54" tabindex="-1"></a>    <span class="co"># kable_styling(full_width = F, font_size = 7) %&gt;%</span></span>
<span id="cb386-55"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-55" tabindex="-1"></a>    <span class="fu">add_header_above</span>(cs)</span>
<span id="cb386-56"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-56" tabindex="-1"></a>  </span>
<span id="cb386-57"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-57" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(rs)){</span>
<span id="cb386-58"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-58" tabindex="-1"></a>    tab <span class="ot">&lt;-</span> tab <span class="sc">%&gt;%</span> kableExtra<span class="sc">::</span><span class="fu">group_rows</span>(rs<span class="sc">$</span>study[i], rs<span class="sc">$</span>start[i], rs<span class="sc">$</span>end[i])</span>
<span id="cb386-59"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-59" tabindex="-1"></a>  }</span>
<span id="cb386-60"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-60" tabindex="-1"></a>  <span class="co"># save the resulting html table</span></span>
<span id="cb386-61"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-61" tabindex="-1"></a>  <span class="fu">save_kable</span>(tab, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/tables/all terms/%s-%s-%s.html&quot;</span></span>
<span id="cb386-62"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-62" tabindex="-1"></a>                                 , local_path, type, o, md, cv))</span>
<span id="cb386-63"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-63" tabindex="-1"></a>  <span class="fu">return</span>(tab) <span class="co"># return the html table</span></span>
<span id="cb386-64"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-64" tabindex="-1"></a>}</span>
<span id="cb386-65"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-65" tabindex="-1"></a></span>
<span id="cb386-66"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-66" tabindex="-1"></a>ipd3_mod_tab2 <span class="ot">&lt;-</span> ipd3_mod_tab <span class="sc">%&gt;%</span></span>
<span id="cb386-67"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-67" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Outcome, Moderator, Covariate) <span class="sc">%&gt;%</span></span>
<span id="cb386-68"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-68" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb386-69"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-69" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb386-70"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb386-70" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tab =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(data, type, Outcome, Moderator, Covariate), ipd3_mod_tab_fun))</span></code></pre></div>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-1" tabindex="-1"></a>ipd3_meta_all <span class="ot">&lt;-</span> nested_ipd3_meta <span class="sc">%&gt;%</span> </span>
<span id="cb387-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>studyEff, <span class="sc">-</span>metaHet) <span class="sc">%&gt;%</span></span>
<span id="cb387-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-3" tabindex="-1"></a>  <span class="fu">unnest</span>(metaEff) <span class="sc">%&gt;%</span> </span>
<span id="cb387-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(<span class="fu">sign</span>(conf.low) <span class="sc">==</span> <span class="fu">sign</span>(conf.high), <span class="st">&quot;sig&quot;</span>, <span class="st">&quot;ns&quot;</span>),</span>
<span id="cb387-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-5" tabindex="-1"></a>         <span class="at">Trait =</span> <span class="fu">factor</span>(Trait, traits<span class="sc">$</span>short_name),</span>
<span id="cb387-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-6" tabindex="-1"></a>         <span class="at">Outcome =</span> <span class="fu">factor</span>(Outcome, outcomes<span class="sc">$</span>short_name, outcomes<span class="sc">$</span>long_name),</span>
<span id="cb387-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-7" tabindex="-1"></a>         <span class="at">Moderator =</span> <span class="fu">factor</span>(Moderator, <span class="fu">c</span>(moders<span class="sc">$</span>short_name, stdyModers<span class="sc">$</span>short_name), <span class="fu">c</span>(moders<span class="sc">$</span>long_name, stdyModers<span class="sc">$</span>long_name)),</span>
<span id="cb387-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-8" tabindex="-1"></a>         <span class="at">Covariate =</span> <span class="fu">ifelse</span>(Moderator <span class="sc">!=</span> <span class="st">&quot;None&quot;</span> <span class="sc">&amp;</span> Covariate <span class="sc">==</span> <span class="st">&quot;None&quot;</span>, Moderator, Covariate),</span>
<span id="cb387-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-9" tabindex="-1"></a>         <span class="at">Covariate =</span> <span class="fu">factor</span>(Covariate, moders<span class="sc">$</span>short_name, <span class="fu">str_wrap</span>(moders<span class="sc">$</span>long_name, <span class="dv">15</span>)),</span>
<span id="cb387-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-10" tabindex="-1"></a>         <span class="at">term =</span> <span class="fu">str_replace_all</span>(term, <span class="st">&quot;metamod&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;p_value:&quot;</span>, Moderator))) <span class="sc">%&gt;%</span></span>
<span id="cb387-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-11" tabindex="-1"></a>  <span class="co"># format values as text, combine estimates and CI&#39;s, bold significance</span></span>
<span id="cb387-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-12" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(estimate, conf.low, conf.high), </span>
<span id="cb387-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-13" tabindex="-1"></a>            <span class="sc">~</span><span class="fu">ifelse</span>(<span class="fu">abs</span>(.) <span class="sc">&lt;</span> .<span class="dv">01</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, .), <span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, .))) <span class="sc">%&gt;%</span></span>
<span id="cb387-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">est =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s&lt;br&gt;[%s, %s]&quot;</span>, estimate, conf.low, conf.high),</span>
<span id="cb387-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-15" tabindex="-1"></a>         <span class="at">est =</span> <span class="fu">ifelse</span>(sig <span class="sc">==</span> <span class="st">&quot;sig&quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;&lt;strong&gt;%s&lt;/strong&gt;&quot;</span>, est), est)) <span class="sc">%&gt;%</span></span>
<span id="cb387-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-16" tabindex="-1"></a>  <span class="co"># mutate(est = sprintf(&quot;%s [%s, %s]&quot;, estimate, conf.low, conf.high),</span></span>
<span id="cb387-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-17" tabindex="-1"></a>  <span class="co"># est = ifelse(sig == &quot;sig&quot;, sprintf(&quot;\\textbf{%s}&quot;, est), est)) %&gt;%</span></span>
<span id="cb387-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-18" tabindex="-1"></a>  <span class="co"># final reshaping, remove extra columns, arrange values, and change to wide format</span></span>
<span id="cb387-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-19" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>estimate, <span class="sc">-</span>conf.low, <span class="sc">-</span>conf.high, <span class="sc">-</span>sig, <span class="sc">-</span>SE) <span class="sc">%&gt;%</span></span>
<span id="cb387-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-20" tabindex="-1"></a>  <span class="fu">arrange</span>(type, Outcome, Trait, Moderator, Covariate) <span class="sc">%&gt;%</span></span>
<span id="cb387-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-21" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;Trait&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;est&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb387-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-22" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Outcome, Covariate) <span class="sc">%&gt;%</span></span>
<span id="cb387-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-23" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb387-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb387-24" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span></code></pre></div>
</div>
<div id="heterogeneity" class="section level6 hasAnchor" number="5.4.3.0.1.4">
<h6><span class="header-section-number">5.4.3.0.1.4</span> Heterogeneity<a href="method-3-two-stage-individual-participant-meta-analysis.html#heterogeneity" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-1" tabindex="-1"></a>loadRData <span class="ot">&lt;-</span> <span class="cf">function</span>(fileName, type, obj, folder){</span>
<span id="cb388-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-2" tabindex="-1"></a><span class="co">#loads an RData file, and returns it</span></span>
<span id="cb388-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-3" tabindex="-1"></a>    path <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/%s/%s&quot;</span>, local_path, type, folder, fileName)</span>
<span id="cb388-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-4" tabindex="-1"></a>    <span class="fu">load</span>(path)</span>
<span id="cb388-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-5" tabindex="-1"></a>    <span class="fu">get</span>(<span class="fu">ls</span>()[<span class="fu">grepl</span>(obj, <span class="fu">ls</span>())])</span>
<span id="cb388-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-6" tabindex="-1"></a>}</span>
<span id="cb388-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-7" tabindex="-1"></a></span>
<span id="cb388-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-8" tabindex="-1"></a><span class="do">## load in &quot;fixed&quot; effects</span></span>
<span id="cb388-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-9" tabindex="-1"></a><span class="do">## first get file names</span></span>
<span id="cb388-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-10" tabindex="-1"></a>nested_ipd3_het <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;Frequentist&quot;</span>, <span class="st">&quot;Bayesian&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb388-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">file =</span> <span class="fu">map</span>(type, <span class="sc">~</span><span class="fu">list.files</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/metaHetero&quot;</span>, local_path, .)))) <span class="sc">%&gt;%</span></span>
<span id="cb388-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-12" tabindex="-1"></a>  <span class="fu">unnest</span>(file) <span class="sc">%&gt;%</span></span>
<span id="cb388-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-13" tabindex="-1"></a>  <span class="fu">separate</span>(file, <span class="fu">c</span>(<span class="st">&quot;Outcome&quot;</span>, <span class="st">&quot;Trait&quot;</span>, <span class="st">&quot;Moderator&quot;</span>, <span class="st">&quot;Covariate&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="at">remove =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb388-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-14" tabindex="-1"></a>  <span class="do">## read in the files</span></span>
<span id="cb388-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-15" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Covariate =</span> <span class="fu">str_remove</span>(Covariate, <span class="st">&quot;.RData&quot;</span>),</span>
<span id="cb388-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-16" tabindex="-1"></a>         <span class="at">het =</span> <span class="fu">map2</span>(file, type, <span class="fu">possibly</span>(<span class="sc">~</span><span class="fu">loadRData</span>(.x, .y, <span class="st">&quot;het&quot;</span>, <span class="st">&quot;metaHetero&quot;</span>), <span class="cn">NA_real_</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb388-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-17" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(het)) <span class="sc">%&gt;%</span></span>
<span id="cb388-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb388-18" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>file) </span></code></pre></div>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-1" tabindex="-1"></a>round_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb389-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-2" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> .<span class="dv">001</span> <span class="sc">&amp;</span> x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">&quot;&amp;lt; .001&quot;</span></span>
<span id="cb389-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-3" tabindex="-1"></a>   , <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="sc">-</span>.<span class="dv">001</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">&quot;&amp;gt; -.001&quot;</span> </span>
<span id="cb389-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-4" tabindex="-1"></a>   , <span class="fu">ifelse</span>(<span class="fu">abs</span>(x) <span class="sc">&lt;</span> .<span class="dv">01</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, x) </span>
<span id="cb389-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-5" tabindex="-1"></a>   , <span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, x))))</span>
<span id="cb389-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-6" tabindex="-1"></a>}</span>
<span id="cb389-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-7" tabindex="-1"></a></span>
<span id="cb389-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-8" tabindex="-1"></a>ip3_hetero_tab_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, type, out, mod, cov){</span>
<span id="cb389-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-9" tabindex="-1"></a>  moder <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(mod, moders<span class="sc">$</span>short_name, moders<span class="sc">$</span>long_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb389-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-10" tabindex="-1"></a>  d2 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb389-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-11" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Trait =</span> <span class="fu">factor</span>(Trait, traits<span class="sc">$</span>short_name, traits<span class="sc">$</span>long_name)) <span class="sc">%&gt;%</span></span>
<span id="cb389-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-12" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">-</span>Trait), round_fun) <span class="sc">%&gt;%</span></span>
<span id="cb389-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-13" tabindex="-1"></a>    <span class="fu">arrange</span>(Trait)</span>
<span id="cb389-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-14" tabindex="-1"></a>  </span>
<span id="cb389-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-15" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="cf">if</span>(mod <span class="sc">==</span> <span class="st">&quot;none&quot;</span>) <span class="st">&quot;Heterogeneity Estimates of Personality-Crystallized Domain Associations&quot;</span> <span class="cf">else</span> <span class="fu">sprintf</span>(<span class="st">&quot;Heterogeneity Estimates for Overall %s Moderation of Personality-Crystallized Domain Associations&quot;</span>, moder)</span>
<span id="cb389-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-16" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;&lt;strong&gt;Table SX&lt;/strong&gt;&lt;br&gt;&lt;em&gt;%s&lt;/em&gt;&quot;</span>, cap)</span>
<span id="cb389-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-17" tabindex="-1"></a>  </span>
<span id="cb389-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-18" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span></span>
<span id="cb389-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-19" tabindex="-1"></a>    <span class="fu">kable</span>(.</span>
<span id="cb389-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-20" tabindex="-1"></a>          , <span class="st">&quot;html&quot;</span></span>
<span id="cb389-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-21" tabindex="-1"></a>          , <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="fu">ncol</span>(d2)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb389-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-22" tabindex="-1"></a>          , <span class="at">caption =</span> cap</span>
<span id="cb389-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-23" tabindex="-1"></a>          , <span class="at">escape =</span> F</span>
<span id="cb389-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-24" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb389-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-25" tabindex="-1"></a>    <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">&quot;Times New Roman&quot;</span>) </span>
<span id="cb389-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-26" tabindex="-1"></a>  </span>
<span id="cb389-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-27" tabindex="-1"></a>  <span class="fu">save_kable</span>(tab, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/tables/heterogeneity/%s-%s-%s.html&quot;</span>, local_path, type, out, mod, cov))</span>
<span id="cb389-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-28" tabindex="-1"></a>  <span class="fu">return</span>(tab)</span>
<span id="cb389-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-29" tabindex="-1"></a>}</span>
<span id="cb389-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-30" tabindex="-1"></a></span>
<span id="cb389-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-31" tabindex="-1"></a>nested_ipd3_het_tab <span class="ot">&lt;-</span> nested_ipd3_het <span class="sc">%&gt;%</span></span>
<span id="cb389-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-32" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Moderator <span class="sc">%in%</span> stdyModers<span class="sc">$</span>short_name) <span class="sc">%&gt;%</span></span>
<span id="cb389-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-33" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb389-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-34" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb389-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-35" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb389-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-36" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb389-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-37" tabindex="-1"></a>                      <span class="fu">unnest</span>(het) <span class="sc">%&gt;%</span></span>
<span id="cb389-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-38" tabindex="-1"></a>                      <span class="fu">group_by</span>(Outcome, Moderator, Covariate) <span class="sc">%&gt;%</span> </span>
<span id="cb389-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-39" tabindex="-1"></a>                      <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb389-40"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-40" tabindex="-1"></a>                      <span class="fu">ungroup</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb389-41"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-41" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb389-42"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb389-42" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tab =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(data, type, Outcome, Moderator, Covariate), ip3_hetero_tab_fun))</span></code></pre></div>
</div>
</div>
</div>
<div id="figures-4" class="section level3 hasAnchor" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> Figures<a href="method-3-two-stage-individual-participant-meta-analysis.html#figures-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="overall-forest-4" class="section level6 hasAnchor" number="5.4.4.0.0.1">
<h6><span class="header-section-number">5.4.4.0.0.1</span> Overall Forest<a href="method-3-two-stage-individual-participant-meta-analysis.html#overall-forest-4" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-1" tabindex="-1"></a>ipd3_fx_plot_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, mod, type, cov){</span>
<span id="cb390-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-2" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(mod, <span class="fu">c</span>(moders<span class="sc">$</span>long_name, stdyModers<span class="sc">$</span>long_name), <span class="fu">c</span>(moders<span class="sc">$</span>short_name, stdyModers<span class="sc">$</span>short_name), <span class="at">warn_missing =</span> F)</span>
<span id="cb390-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-3" tabindex="-1"></a>  cv <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(cov, covars<span class="sc">$</span>short_name, covars<span class="sc">$</span>long_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb390-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-4" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">max</span>(<span class="fu">abs</span>(<span class="fu">min</span>(df<span class="sc">$</span>estimate)), <span class="fu">abs</span>(<span class="fu">max</span>(df<span class="sc">$</span>estimate))), <span class="dv">3</span>)</span>
<span id="cb390-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-5" tabindex="-1"></a>  lim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">-</span>d<span class="sc">-</span>(d<span class="sc">/</span><span class="fl">2.5</span>), <span class="dv">0</span><span class="sc">+</span>d<span class="sc">+</span>(d<span class="sc">/</span><span class="fl">2.5</span>))</span>
<span id="cb390-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-6" tabindex="-1"></a>  brk <span class="ot">&lt;-</span> <span class="cf">if</span>(d <span class="sc">&gt;</span> .<span class="dv">01</span>) <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">-</span>d<span class="sc">-</span>(d<span class="sc">/</span><span class="dv">5</span>), <span class="dv">0</span>, <span class="dv">0</span><span class="sc">+</span>d<span class="sc">+</span>(d<span class="sc">/</span><span class="dv">5</span>)),<span class="dv">2</span>) <span class="cf">else</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">-</span>d<span class="sc">-</span>(d<span class="sc">/</span><span class="dv">5</span>), <span class="dv">0</span>, <span class="dv">0</span><span class="sc">+</span>d<span class="sc">+</span>(d<span class="sc">/</span><span class="dv">5</span>)),<span class="dv">3</span>) </span>
<span id="cb390-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-7" tabindex="-1"></a>  <span class="co"># lim_high &lt;- lim[2]*4</span></span>
<span id="cb390-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-8" tabindex="-1"></a>  lab <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(brk, <span class="st">&quot;^0.&quot;</span>, <span class="st">&quot;.&quot;</span>)</span>
<span id="cb390-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-9" tabindex="-1"></a>  shapes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>)[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(df<span class="sc">$</span>term))]</span>
<span id="cb390-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-10" tabindex="-1"></a>  lt <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;solid&quot;</span>, <span class="fu">length</span>(<span class="fu">unique</span>(df<span class="sc">$</span>term)))</span>
<span id="cb390-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-11" tabindex="-1"></a>  titl <span class="ot">&lt;-</span> <span class="cf">if</span>(mod <span class="sc">==</span> <span class="st">&quot;none&quot;</span>){<span class="cn">NULL</span>} <span class="cf">else</span> {<span class="fu">sprintf</span>(<span class="st">&quot;%s Moderation of Personality-Outcome Associations&quot;</span>, mod)}</span>
<span id="cb390-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-12" tabindex="-1"></a>  titl <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="sc">!</span>cov <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;all&quot;</span>)) <span class="fu">paste</span>(cv, <span class="st">&quot;Adjusted&quot;</span>, titl, <span class="at">collapse =</span> <span class="st">&quot; &quot;</span>) <span class="cf">else</span> <span class="fu">paste</span>(cv, titl, <span class="at">collapse =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb390-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-13" tabindex="-1"></a>  leg <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">unique</span>(df<span class="sc">$</span>term)) <span class="sc">&gt;</span> <span class="dv">1</span>){<span class="st">&quot;bottom&quot;</span>} <span class="cf">else</span> {<span class="st">&quot;none&quot;</span>}</span>
<span id="cb390-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-14" tabindex="-1"></a>  p <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb390-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-15" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">conf.low =</span> <span class="fu">ifelse</span>(conf.low <span class="sc">&lt;</span> lim[<span class="dv">1</span>], lim[<span class="dv">1</span>], conf.low),</span>
<span id="cb390-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-16" tabindex="-1"></a>           <span class="at">conf.high =</span> <span class="fu">ifelse</span>(conf.high <span class="sc">&gt;</span> lim[<span class="dv">2</span>], lim[<span class="dv">2</span>], conf.high)) <span class="sc">%&gt;%</span> </span>
<span id="cb390-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-17" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Outcome, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb390-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-18" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> lim, <span class="at">breaks =</span> brk, <span class="at">labels =</span> lab) <span class="sc">+</span> </span>
<span id="cb390-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-19" tabindex="-1"></a>    <span class="fu">scale_size_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, .<span class="dv">85</span>)) <span class="sc">+</span></span>
<span id="cb390-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-20" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> shapes) <span class="sc">+</span></span>
<span id="cb390-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-21" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb390-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-22" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> lt) <span class="sc">+</span></span>
<span id="cb390-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-23" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>), <span class="at">size =</span> .<span class="dv">25</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb390-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-24" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">linetype =</span> term)</span>
<span id="cb390-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-25" tabindex="-1"></a>                  , <span class="at">width =</span> <span class="dv">0</span></span>
<span id="cb390-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-26" tabindex="-1"></a>                  , <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">9</span>)) <span class="sc">+</span> </span>
<span id="cb390-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-27" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> sig, <span class="at">size =</span> sig, <span class="at">shape =</span> term)</span>
<span id="cb390-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-28" tabindex="-1"></a>                  , <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb390-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-29" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb390-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-30" tabindex="-1"></a>         , <span class="at">y =</span> <span class="st">&quot;Estimate (POMP)&quot;</span></span>
<span id="cb390-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-31" tabindex="-1"></a>         , <span class="at">title =</span> titl</span>
<span id="cb390-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-32" tabindex="-1"></a>         , <span class="at">subtitle =</span> <span class="st">&quot;Method 3: Pooled Regression Using Random Effects&quot;</span></span>
<span id="cb390-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-33" tabindex="-1"></a>         ) <span class="sc">+</span></span>
<span id="cb390-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-34" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb390-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-35" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span>Trait, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">space =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb390-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-36" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb390-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-37" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb390-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-38" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> leg,</span>
<span id="cb390-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-39" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.2</span>), <span class="at">hjust =</span> .<span class="dv">5</span>),</span>
<span id="cb390-40"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-40" tabindex="-1"></a>          <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>), <span class="at">hjust =</span> .<span class="dv">5</span>),</span>
<span id="cb390-41"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-41" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb390-42"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-42" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb390-43"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-43" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.4</span>)),</span>
<span id="cb390-44"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-44" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb390-45"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-45" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>)))</span>
<span id="cb390-46"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-46" tabindex="-1"></a>  ht <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(df<span class="sc">$</span>Outcome)); ht2 <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(df<span class="sc">$</span>term))</span>
<span id="cb390-47"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-47" tabindex="-1"></a>  local_path <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(df<span class="sc">$</span>Trait))</span>
<span id="cb390-48"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-48" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/figures/overall forest/%s_%s_fixed.png&quot;</span>, local_path, type, m, cov), <span class="at">width =</span> local_path<span class="sc">*</span><span class="dv">2</span>, <span class="at">height =</span> <span class="fl">1.25</span><span class="sc">*</span>ht <span class="sc">+</span> .<span class="dv">75</span><span class="sc">*</span>ht2)</span>
<span id="cb390-49"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-49" tabindex="-1"></a><span class="fu">rm</span>(p)</span>
<span id="cb390-50"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-50" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb390-51"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-51" tabindex="-1"></a><span class="fu">return</span>(T)</span>
<span id="cb390-52"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-52" tabindex="-1"></a>}</span>
<span id="cb390-53"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-53" tabindex="-1"></a></span>
<span id="cb390-54"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-54" tabindex="-1"></a>nested_ipd3_meta <span class="sc">%&gt;%</span></span>
<span id="cb390-55"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-55" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>studyEff, <span class="sc">-</span>metaHet) <span class="sc">%&gt;%</span></span>
<span id="cb390-56"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-56" tabindex="-1"></a>  <span class="fu">unnest</span>(metaEff) <span class="sc">%&gt;%</span></span>
<span id="cb390-57"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-57" tabindex="-1"></a>    <span class="fu">filter</span>((Moderator <span class="sc">==</span> <span class="st">&quot;none&quot;</span> <span class="sc">&amp;</span> term <span class="sc">==</span> <span class="st">&quot;p_value&quot;</span>)<span class="sc">|</span></span>
<span id="cb390-58"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-58" tabindex="-1"></a>          (Moderator <span class="sc">!=</span> <span class="st">&quot;none&quot;</span> <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">&quot;^p_value:&quot;</span>, term))) <span class="sc">%&gt;%</span></span>
<span id="cb390-59"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-59" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(<span class="fu">sign</span>(conf.low) <span class="sc">==</span> <span class="fu">sign</span>(conf.high), <span class="st">&quot;sig&quot;</span>, <span class="st">&quot;ns&quot;</span>),</span>
<span id="cb390-60"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-60" tabindex="-1"></a>           <span class="at">sig =</span> <span class="fu">factor</span>(sig, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;sig&quot;</span>,<span class="st">&quot;ns&quot;</span>)),</span>
<span id="cb390-61"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-61" tabindex="-1"></a>           <span class="at">Trait =</span> <span class="fu">factor</span>(Trait, <span class="at">levels =</span> traits<span class="sc">$</span>short_name),</span>
<span id="cb390-62"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-62" tabindex="-1"></a>           <span class="at">Outcome =</span> <span class="fu">factor</span>(Outcome, <span class="at">levels =</span> outcomes<span class="sc">$</span>short_name, <span class="at">labels =</span> <span class="fu">str_wrap</span>(outcomes<span class="sc">$</span>long_name, <span class="dv">15</span>)),</span>
<span id="cb390-63"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-63" tabindex="-1"></a>           <span class="at">Moderator =</span> <span class="fu">factor</span>(Moderator, <span class="at">levels =</span> <span class="fu">c</span>(moders<span class="sc">$</span>short_name, stdyModers<span class="sc">$</span>short_name), <span class="at">labels =</span> <span class="fu">c</span>(moders<span class="sc">$</span>long_name, stdyModers<span class="sc">$</span>long_name)),</span>
<span id="cb390-64"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-64" tabindex="-1"></a>           <span class="at">Outcome =</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>(Outcome))  <span class="sc">%&gt;%</span></span>
<span id="cb390-65"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-65" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;Frequentist&quot;</span> <span class="sc">&amp;</span> Moderator <span class="sc">==</span> <span class="st">&quot;None&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb390-66"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-66" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Moderator, Covariate) <span class="sc">%&gt;%</span></span>
<span id="cb390-67"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-67" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb390-68"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-68" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb390-69"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb390-69" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">pmap</span>(<span class="fu">list</span>(data, Moderator, type, Covariate), ipd3_fx_plot_fun))</span></code></pre></div>
</div>
<div id="study-specific-forest-2" class="section level6 hasAnchor" number="5.4.4.0.0.2">
<h6><span class="header-section-number">5.4.4.0.0.2</span> Study-Specific Forest<a href="method-3-two-stage-individual-participant-meta-analysis.html#study-specific-forest-2" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-1" tabindex="-1"></a>ipd3_rx_plot_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, outcome, mod, type, cov, trait){</span>
<span id="cb391-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-2" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(outcome, mod))</span>
<span id="cb391-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-3" tabindex="-1"></a>  trt <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(trait, traits<span class="sc">$</span>short_name, traits<span class="sc">$</span>long_name)</span>
<span id="cb391-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-4" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(mod, moders<span class="sc">$</span>short_name, moders<span class="sc">$</span>long_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb391-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-5" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">max</span>(<span class="fu">abs</span>(<span class="fu">min</span>(df<span class="sc">$</span>estimate)), <span class="fu">abs</span>(<span class="fu">max</span>(df<span class="sc">$</span>estimate))), <span class="dv">3</span>)</span>
<span id="cb391-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-6" tabindex="-1"></a>  <span class="co"># stds &lt;- unique(df$study)</span></span>
<span id="cb391-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-7" tabindex="-1"></a>  lim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">-</span>d<span class="sc">-</span>(d<span class="sc">/</span><span class="fl">2.5</span>), <span class="dv">0</span><span class="sc">+</span>d<span class="sc">+</span>(d<span class="sc">/</span><span class="fl">2.5</span>))</span>
<span id="cb391-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-8" tabindex="-1"></a>  brk <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">-</span>d<span class="sc">-</span>(d<span class="sc">/</span><span class="dv">5</span>), <span class="dv">0</span>, <span class="dv">0</span><span class="sc">+</span>d<span class="sc">+</span>(d<span class="sc">/</span><span class="dv">5</span>)),<span class="dv">2</span>)</span>
<span id="cb391-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-9" tabindex="-1"></a>  lab <span class="ot">&lt;-</span> <span class="fu">str_remove</span>(<span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">-</span>d<span class="sc">-</span>(d<span class="sc">/</span><span class="dv">5</span>), <span class="dv">0</span>, <span class="dv">0</span><span class="sc">+</span>d<span class="sc">+</span>(d<span class="sc">/</span><span class="dv">5</span>)),<span class="dv">2</span>), <span class="st">&quot;^0&quot;</span>)</span>
<span id="cb391-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-10" tabindex="-1"></a>  shapes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>)[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(df<span class="sc">$</span>term))]</span>
<span id="cb391-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-11" tabindex="-1"></a>  lt <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;solid&quot;</span>, <span class="fu">length</span>(<span class="fu">unique</span>(df<span class="sc">$</span>term)))</span>
<span id="cb391-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-12" tabindex="-1"></a>  titl <span class="ot">&lt;-</span> <span class="cf">if</span>(mod <span class="sc">==</span> <span class="st">&quot;none&quot;</span>){trt} <span class="cf">else</span> {<span class="fu">sprintf</span>(<span class="st">&quot;%s x %s&quot;</span>, trt, m)}</span>
<span id="cb391-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-13" tabindex="-1"></a>  leg <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">unique</span>(df<span class="sc">$</span>term)) <span class="sc">&gt;</span> <span class="dv">1</span>){<span class="st">&quot;bottom&quot;</span>} <span class="cf">else</span> {<span class="st">&quot;none&quot;</span>}</span>
<span id="cb391-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-14" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">study =</span> <span class="fu">mapvalues</span>(study, <span class="fu">c</span>(<span class="st">&quot;BASE-I&quot;</span>, <span class="st">&quot;OCTO-TWIN&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;BASE&quot;</span>, <span class="st">&quot;OCTO-Twin&quot;</span>)))</span>
<span id="cb391-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-15" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">full_join</span>(<span class="fu">tibble</span>(<span class="at">study =</span> <span class="st">&quot; &quot;</span>, <span class="at">estimate =</span> <span class="cn">NA</span>, <span class="at">n =</span> <span class="cn">NA</span>))</span>
<span id="cb391-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-16" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(estimate)</span>
<span id="cb391-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-17" tabindex="-1"></a>  stds <span class="ot">&lt;-</span> df<span class="sc">$</span>study[<span class="sc">!</span>df<span class="sc">$</span>study <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Meta-Analytic&quot;</span>, <span class="st">&quot; &quot;</span>)]</span>
<span id="cb391-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-18" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb391-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-19" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">study =</span> <span class="fu">factor</span>(study, <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">&quot; &quot;</span>, stds, <span class="st">&quot;Meta-Analytic&quot;</span>)))</span>
<span id="cb391-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-20" tabindex="-1"></a>           <span class="co"># , conf.low = ifelse(conf.low &lt; lim[1], lim[1], conf.low)</span></span>
<span id="cb391-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-21" tabindex="-1"></a>           <span class="co"># , conf.high = ifelse(conf.high &gt; lim[2], lim[2], conf.high)</span></span>
<span id="cb391-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-22" tabindex="-1"></a>           , <span class="at">lb =</span> <span class="fu">ifelse</span>(conf.low <span class="sc">&lt;</span> lim[<span class="dv">1</span>], <span class="st">&quot;lower&quot;</span></span>
<span id="cb391-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-23" tabindex="-1"></a>                         , <span class="fu">ifelse</span>(conf.high <span class="sc">&gt;</span> lim[<span class="dv">2</span>], <span class="st">&quot;upper&quot;</span>, <span class="st">&quot;neither&quot;</span>))</span>
<span id="cb391-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-24" tabindex="-1"></a>           , <span class="at">conf.low2 =</span> <span class="fu">ifelse</span>(conf.low <span class="sc">&lt;</span> lim[<span class="dv">1</span>], lim[<span class="dv">1</span>], conf.low)</span>
<span id="cb391-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-25" tabindex="-1"></a>           , <span class="at">conf.high2 =</span> <span class="fu">ifelse</span>(conf.high <span class="sc">&gt;</span> lim[<span class="dv">2</span>], lim[<span class="dv">2</span>], conf.high)</span>
<span id="cb391-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-26" tabindex="-1"></a>           <span class="co"># , study = factor(study, levels = str_remove_all(c(&quot;Overall&quot;, studies_long), &quot;-&quot;), labels = c(&quot;Overall&quot;, studies_long))</span></span>
<span id="cb391-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-27" tabindex="-1"></a>           <span class="co"># Trait = factor(Trait, levels = traits$short_name, labels = traits$long_name),</span></span>
<span id="cb391-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-28" tabindex="-1"></a>           , <span class="at">type =</span> <span class="fu">ifelse</span>(study <span class="sc">==</span> <span class="st">&quot;Meta-Analytic&quot;</span>, <span class="st">&quot;fixed&quot;</span>, <span class="st">&quot;random&quot;</span>))</span>
<span id="cb391-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-29" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb391-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-30" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> study, <span class="at">y =</span> estimate)) <span class="sc">+</span> </span>
<span id="cb391-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-31" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high)</span>
<span id="cb391-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-32" tabindex="-1"></a>                  , <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span></span>
<span id="cb391-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-33" tabindex="-1"></a>                  , <span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb391-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-34" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> term, <span class="at">size =</span> term)) <span class="sc">+</span> </span>
<span id="cb391-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-35" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="at">data =</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(lb <span class="sc">==</span> <span class="st">&quot;lower&quot;</span>)</span>
<span id="cb391-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-36" tabindex="-1"></a>                 , <span class="fu">aes</span>(<span class="at">y =</span> conf.high2, <span class="at">yend =</span> conf.low2, <span class="at">xend =</span> study)</span>
<span id="cb391-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-37" tabindex="-1"></a>                 , <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">&quot;closed&quot;</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb391-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-38" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="at">data =</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(lb <span class="sc">==</span> <span class="st">&quot;upper&quot;</span>)</span>
<span id="cb391-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-39" tabindex="-1"></a>                 , <span class="fu">aes</span>(<span class="at">y =</span> conf.low2, <span class="at">yend =</span> conf.high2, <span class="at">xend =</span> study)</span>
<span id="cb391-40"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-40" tabindex="-1"></a>                 , <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">&quot;closed&quot;</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb391-41"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-41" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb391-42"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-42" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb391-43"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-43" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">length</span>(stds) <span class="sc">+</span> <span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb391-44"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-44" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="fu">length</span>(stds) <span class="sc">+</span> <span class="fl">1.6</span>, <span class="at">xmax =</span> <span class="cn">Inf</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb391-45"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-45" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> lim, <span class="at">breaks =</span> brk, <span class="at">labels =</span> lab) <span class="sc">+</span> </span>
<span id="cb391-46"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-46" tabindex="-1"></a>    <span class="fu">scale_size_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb391-47"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-47" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb391-48"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-48" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb391-49"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-49" tabindex="-1"></a>         , <span class="at">y =</span> <span class="st">&quot;Estimate&quot;</span></span>
<span id="cb391-50"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-50" tabindex="-1"></a>         <span class="co"># , title = &quot;  &quot;</span></span>
<span id="cb391-51"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-51" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb391-52"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-52" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb391-53"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-53" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb391-54"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-54" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb391-55"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-55" tabindex="-1"></a>          , <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb391-56"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-56" tabindex="-1"></a>          , <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb391-57"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-57" tabindex="-1"></a>          , <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> .<span class="dv">5</span>)</span>
<span id="cb391-58"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-58" tabindex="-1"></a>          , <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb391-59"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-59" tabindex="-1"></a>          , <span class="at">axis.line.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb391-60"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-60" tabindex="-1"></a>          , <span class="at">axis.line.x.top =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>))</span>
<span id="cb391-61"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-61" tabindex="-1"></a>  </span>
<span id="cb391-62"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-62" tabindex="-1"></a>  d2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb391-63"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-63" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(estimate, conf.low, conf.high)</span>
<span id="cb391-64"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-64" tabindex="-1"></a>              , <span class="sc">~</span><span class="fu">ifelse</span>(<span class="fu">abs</span>(.) <span class="sc">&lt;</span> .<span class="dv">01</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, .), <span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, .))) <span class="sc">%&gt;%</span></span>
<span id="cb391-65"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-65" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(estimate, conf.low, conf.high), <span class="sc">~</span><span class="fu">str_replace_all</span>(., <span class="st">&quot;^0.&quot;</span>, <span class="st">&quot;.&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb391-66"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-66" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(estimate, conf.low, conf.high), <span class="sc">~</span><span class="fu">str_replace_all</span>(., <span class="st">&quot;^-0.&quot;</span>, <span class="st">&quot;-.&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb391-67"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-67" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">est =</span> <span class="fu">ifelse</span>(study <span class="sc">!=</span> <span class="st">&quot; &quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%s [%s, %s]      &quot;</span>, estimate, conf.low, conf.high), <span class="st">&quot;&quot;</span>)</span>
<span id="cb391-68"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-68" tabindex="-1"></a>           , <span class="at">n =</span> <span class="fu">as.character</span>(n)</span>
<span id="cb391-69"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-69" tabindex="-1"></a>           ) <span class="sc">%&gt;%</span></span>
<span id="cb391-70"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-70" tabindex="-1"></a>    <span class="fu">select</span>(study, n, est) <span class="sc">%&gt;%</span></span>
<span id="cb391-71"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-71" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(n, est), <span class="at">names_to =</span> <span class="st">&quot;est&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb391-72"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-72" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span></span>
<span id="cb391-73"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-73" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> study, <span class="at">y =</span> est)) <span class="sc">+</span></span>
<span id="cb391-74"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-74" tabindex="-1"></a>      <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value), <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span> </span>
<span id="cb391-75"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-75" tabindex="-1"></a>      <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;b [CI]&quot;</span>, <span class="at">x =</span> <span class="fu">length</span>(stds) <span class="sc">+</span> <span class="fl">1.75</span>, <span class="at">y =</span> <span class="st">&quot;est&quot;</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb391-76"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-76" tabindex="-1"></a>      <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;N&quot;</span>, <span class="at">x =</span> <span class="fu">length</span>(stds) <span class="sc">+</span> <span class="fl">1.75</span>, <span class="at">y =</span> <span class="st">&quot;n&quot;</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb391-77"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-77" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb391-78"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-78" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">length</span>(stds) <span class="sc">+</span> <span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb391-79"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-79" tabindex="-1"></a>      <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb391-80"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-80" tabindex="-1"></a>      <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb391-81"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-81" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb391-82"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-82" tabindex="-1"></a>            , <span class="at">axis.text =</span> <span class="fu">element_blank</span>()</span>
<span id="cb391-83"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-83" tabindex="-1"></a>            , <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()</span>
<span id="cb391-84"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-84" tabindex="-1"></a>            , <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb391-85"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-85" tabindex="-1"></a>  </span>
<span id="cb391-86"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-86" tabindex="-1"></a>  my_theme <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb391-87"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-87" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb391-88"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-88" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>))</span>
<span id="cb391-89"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-89" tabindex="-1"></a>  }</span>
<span id="cb391-90"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-90" tabindex="-1"></a>  title_theme <span class="ot">&lt;-</span> <span class="fu">calc_element</span>(<span class="st">&quot;plot.title&quot;</span>, <span class="fu">my_theme</span>())</span>
<span id="cb391-91"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-91" tabindex="-1"></a>  ttl <span class="ot">&lt;-</span> <span class="fu">ggdraw</span>() <span class="sc">+</span> </span>
<span id="cb391-92"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-92" tabindex="-1"></a>      <span class="fu">draw_label</span>(</span>
<span id="cb391-93"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-93" tabindex="-1"></a>          titl,</span>
<span id="cb391-94"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-94" tabindex="-1"></a>          <span class="at">fontfamily =</span> title_theme<span class="sc">$</span>family,</span>
<span id="cb391-95"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-95" tabindex="-1"></a>          <span class="at">fontface =</span> title_theme<span class="sc">$</span>face,</span>
<span id="cb391-96"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-96" tabindex="-1"></a>          <span class="at">size =</span> title_theme<span class="sc">$</span>size<span class="dv">-2</span></span>
<span id="cb391-97"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-97" tabindex="-1"></a>      )</span>
<span id="cb391-98"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-98" tabindex="-1"></a></span>
<span id="cb391-99"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-99" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1, p2</span>
<span id="cb391-100"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-100" tabindex="-1"></a>                     , <span class="at">rel_widths =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>)<span class="co">#c(.4, .6)</span></span>
<span id="cb391-101"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-101" tabindex="-1"></a>                     , <span class="at">align =</span> <span class="st">&quot;h&quot;</span></span>
<span id="cb391-102"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-102" tabindex="-1"></a>                     )</span>
<span id="cb391-103"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-103" tabindex="-1"></a>  <span class="co"># p &lt;- cowplot::plot_grid(ttl, subttl, p3, rel_heights = c(.05, .05, .9), nrow = 3)</span></span>
<span id="cb391-104"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-104" tabindex="-1"></a>  p <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(ttl, p3, <span class="at">rel_heights =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">95</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb391-105"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-105" tabindex="-1"></a>  <span class="fu">save</span>(p</span>
<span id="cb391-106"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-106" tabindex="-1"></a>       , <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/figures/study specific forest/rdata/%s_%s_%s_%s.RData&quot;</span>, local_path, type, outcome, trait, mod, cov))</span>
<span id="cb391-107"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-107" tabindex="-1"></a>  <span class="fu">gc</span>()</span>
<span id="cb391-108"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-108" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb391-109"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-109" tabindex="-1"></a>}</span>
<span id="cb391-110"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-110" tabindex="-1"></a></span>
<span id="cb391-111"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-111" tabindex="-1"></a><span class="do">## fixed effects</span></span>
<span id="cb391-112"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-112" tabindex="-1"></a>nested_ipd3_reg_fp <span class="ot">&lt;-</span> ipd3_meta_res <span class="sc">%&gt;%</span></span>
<span id="cb391-113"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-113" tabindex="-1"></a>  <span class="fu">filter</span>(Moderator <span class="sc">%in%</span> moders<span class="sc">$</span>short_name) <span class="sc">%&gt;%</span></span>
<span id="cb391-114"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-114" tabindex="-1"></a>  <span class="do">## filter key terms</span></span>
<span id="cb391-115"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-115" tabindex="-1"></a>  <span class="fu">filter</span>((Moderator <span class="sc">==</span> <span class="st">&quot;none&quot;</span> <span class="sc">&amp;</span> term <span class="sc">==</span> <span class="st">&quot;p_value&quot;</span>)<span class="sc">|</span></span>
<span id="cb391-116"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-116" tabindex="-1"></a>         (Moderator <span class="sc">!=</span> <span class="st">&quot;none&quot;</span> <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">&quot;^p_value:&quot;</span>, term) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;study&quot;</span>, term))) <span class="sc">%&gt;%</span></span>
<span id="cb391-117"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-117" tabindex="-1"></a>  <span class="do">## significance</span></span>
<span id="cb391-118"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-118" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(<span class="fu">sign</span>(conf.low) <span class="sc">==</span> <span class="fu">sign</span>(conf.high), <span class="st">&quot;sig&quot;</span>, <span class="st">&quot;ns&quot;</span>)</span>
<span id="cb391-119"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-119" tabindex="-1"></a>         , <span class="at">study =</span> <span class="fu">mapvalues</span>(study, studies_long, studies_sp, <span class="at">warn_missing =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb391-120"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-120" tabindex="-1"></a>  <span class="do">## grouping for plotting</span></span>
<span id="cb391-121"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-121" tabindex="-1"></a>  <span class="fu">group_by</span>(Outcome, Moderator, type, Covariate, Trait) <span class="sc">%&gt;%</span></span>
<span id="cb391-122"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-122" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb391-123"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-123" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb391-124"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-124" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(data, Outcome, Moderator, type, Covariate, Trait), ipd3_rx_plot_fun))</span>
<span id="cb391-125"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-125" tabindex="-1"></a></span>
<span id="cb391-126"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-126" tabindex="-1"></a>ipd3_rx_plot_comb_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(outcome, cov, mod, type, d){</span>
<span id="cb391-127"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-127" tabindex="-1"></a>  o <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(outcome, outcomes<span class="sc">$</span>short_name, outcomes<span class="sc">$</span>long_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb391-128"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-128" tabindex="-1"></a>  cv <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(cov, covars<span class="sc">$</span>short_name, covars<span class="sc">$</span>long_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb391-129"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-129" tabindex="-1"></a>  titl <span class="ot">&lt;-</span> <span class="fu">paste0</span>(o, <span class="st">&quot;,&quot;</span>)</span>
<span id="cb391-130"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-130" tabindex="-1"></a>  titl <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="sc">!</span>cov <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;all&quot;</span>)) <span class="fu">paste</span>(titl, cv, <span class="st">&quot;Adjusted&quot;</span>, <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>) <span class="cf">else</span> <span class="fu">paste</span>(titl, cv, <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>)</span>
<span id="cb391-131"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-131" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(</span>
<span id="cb391-132"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-132" tabindex="-1"></a>    d<span class="sc">$</span>p[[<span class="dv">1</span>]]</span>
<span id="cb391-133"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-133" tabindex="-1"></a>    , d<span class="sc">$</span>p[[<span class="dv">2</span>]]</span>
<span id="cb391-134"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-134" tabindex="-1"></a>    , d<span class="sc">$</span>p[[<span class="dv">3</span>]]</span>
<span id="cb391-135"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-135" tabindex="-1"></a>    , d<span class="sc">$</span>p[[<span class="dv">4</span>]]</span>
<span id="cb391-136"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-136" tabindex="-1"></a>    , d<span class="sc">$</span>p[[<span class="dv">5</span>]]</span>
<span id="cb391-137"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-137" tabindex="-1"></a>    , <span class="at">nrow =</span> <span class="dv">3</span></span>
<span id="cb391-138"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-138" tabindex="-1"></a>    , <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb391-139"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-139" tabindex="-1"></a>    , <span class="at">axis =</span> <span class="st">&quot;tblr&quot;</span></span>
<span id="cb391-140"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-140" tabindex="-1"></a>    , <span class="at">align =</span> <span class="st">&quot;hv&quot;</span></span>
<span id="cb391-141"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-141" tabindex="-1"></a>    )</span>
<span id="cb391-142"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-142" tabindex="-1"></a>  my_theme <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb391-143"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-143" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb391-144"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-144" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb391-145"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-145" tabindex="-1"></a>  }</span>
<span id="cb391-146"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-146" tabindex="-1"></a>  title_theme <span class="ot">&lt;-</span> <span class="fu">calc_element</span>(<span class="st">&quot;plot.title&quot;</span>, <span class="fu">my_theme</span>())</span>
<span id="cb391-147"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-147" tabindex="-1"></a>  ttl <span class="ot">&lt;-</span> <span class="fu">ggdraw</span>() <span class="sc">+</span> </span>
<span id="cb391-148"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-148" tabindex="-1"></a>      <span class="fu">draw_label</span>(</span>
<span id="cb391-149"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-149" tabindex="-1"></a>          titl,</span>
<span id="cb391-150"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-150" tabindex="-1"></a>          <span class="at">fontfamily =</span> title_theme<span class="sc">$</span>family,</span>
<span id="cb391-151"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-151" tabindex="-1"></a>          <span class="at">fontface =</span> title_theme<span class="sc">$</span>face,</span>
<span id="cb391-152"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-152" tabindex="-1"></a>          <span class="at">size =</span> title_theme<span class="sc">$</span>size</span>
<span id="cb391-153"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-153" tabindex="-1"></a>      )</span>
<span id="cb391-154"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-154" tabindex="-1"></a>  my_theme <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb391-155"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-155" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb391-156"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-156" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb391-157"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-157" tabindex="-1"></a>  }</span>
<span id="cb391-158"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-158" tabindex="-1"></a>  subtitle_theme <span class="ot">&lt;-</span> <span class="fu">calc_element</span>(<span class="st">&quot;subplot.title&quot;</span>, <span class="fu">my_theme</span>())</span>
<span id="cb391-159"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-159" tabindex="-1"></a>  subttl <span class="ot">&lt;-</span> <span class="fu">ggdraw</span>() <span class="sc">+</span></span>
<span id="cb391-160"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-160" tabindex="-1"></a>      <span class="fu">draw_label</span>(</span>
<span id="cb391-161"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-161" tabindex="-1"></a>          <span class="st">&quot;Method 3: Two-Stage Individual Participant Meta-Analysis&quot;</span>,</span>
<span id="cb391-162"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-162" tabindex="-1"></a>          <span class="at">fontfamily =</span> subtitle_theme<span class="sc">$</span>family,</span>
<span id="cb391-163"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-163" tabindex="-1"></a>          <span class="at">fontface =</span> subtitle_theme<span class="sc">$</span>face,</span>
<span id="cb391-164"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-164" tabindex="-1"></a>          <span class="at">size =</span> subtitle_theme<span class="sc">$</span>size</span>
<span id="cb391-165"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-165" tabindex="-1"></a>      )</span>
<span id="cb391-166"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-166" tabindex="-1"></a>  p <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(ttl, subttl, p1, <span class="at">rel_heights =</span> <span class="fu">c</span>(.<span class="dv">03</span>, .<span class="dv">03</span>, .<span class="dv">94</span>), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb391-167"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-167" tabindex="-1"></a>  <span class="fu">ggsave</span>(p </span>
<span id="cb391-168"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-168" tabindex="-1"></a>         , <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/figures/study specific forest/%s_%s_%s.png&quot;</span>, local_path, type, outcome, mod, cov)</span>
<span id="cb391-169"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-169" tabindex="-1"></a>         , <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>)</span>
<span id="cb391-170"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-170" tabindex="-1"></a>  <span class="fu">ggsave</span>(p </span>
<span id="cb391-171"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-171" tabindex="-1"></a>         , <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/figures/study specific forest/%s_%s_%s.pdf&quot;</span>, local_path, type, outcome, mod, cov)</span>
<span id="cb391-172"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-172" tabindex="-1"></a>         , <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>)</span>
<span id="cb391-173"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-173" tabindex="-1"></a>  <span class="fu">return</span>(T)</span>
<span id="cb391-174"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-174" tabindex="-1"></a>}</span>
<span id="cb391-175"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-175" tabindex="-1"></a></span>
<span id="cb391-176"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-176" tabindex="-1"></a>nested_ipd3_reg_fp <span class="sc">%&gt;%</span></span>
<span id="cb391-177"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-177" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trait =</span> <span class="fu">factor</span>(Trait, traits<span class="sc">$</span>short_name)) <span class="sc">%&gt;%</span></span>
<span id="cb391-178"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-178" tabindex="-1"></a>  <span class="fu">arrange</span>(Trait) <span class="sc">%&gt;%</span></span>
<span id="cb391-179"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-179" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>data) <span class="sc">%&gt;%</span></span>
<span id="cb391-180"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-180" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Outcome, Moderator, Covariate) <span class="sc">%&gt;%</span></span>
<span id="cb391-181"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-181" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb391-182"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-182" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb391-183"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb391-183" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(Outcome, Covariate, Moderator, type, data), ipd3_rx_plot_comb_fun))</span></code></pre></div>
</div>
<div id="overall-simple-effects-plots-2" class="section level4 hasAnchor" number="5.4.4.1">
<h4><span class="header-section-number">5.4.4.1</span> Overall Simple Effects Plots<a href="method-3-two-stage-individual-participant-meta-analysis.html#overall-simple-effects-plots-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-1" tabindex="-1"></a>loadRData <span class="ot">&lt;-</span> <span class="cf">function</span>(fileName, type, obj, folder){</span>
<span id="cb392-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-2" tabindex="-1"></a><span class="co">#loads an RData file, and returns it</span></span>
<span id="cb392-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-3" tabindex="-1"></a>    path <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/%s/%s&quot;</span>, local_path, type, folder, fileName)</span>
<span id="cb392-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-4" tabindex="-1"></a>    <span class="co"># print(path)</span></span>
<span id="cb392-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-5" tabindex="-1"></a>    <span class="fu">load</span>(path)</span>
<span id="cb392-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-6" tabindex="-1"></a>    <span class="fu">get</span>(<span class="fu">ls</span>()[<span class="fu">grepl</span>(obj, <span class="fu">ls</span>())])</span>
<span id="cb392-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-7" tabindex="-1"></a>}</span>
<span id="cb392-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-8" tabindex="-1"></a></span>
<span id="cb392-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-9" tabindex="-1"></a><span class="do">## load in effect size data </span></span>
<span id="cb392-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-10" tabindex="-1"></a><span class="do">## first get file names</span></span>
<span id="cb392-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-11" tabindex="-1"></a>nested_ipd3_meta <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;Frequentist&quot;</span>, <span class="st">&quot;Bayesian&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb392-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">file =</span> <span class="fu">map</span>(type, <span class="sc">~</span><span class="fu">list.files</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/studyPredicted&quot;</span>, local_path, .)))) <span class="sc">%&gt;%</span></span>
<span id="cb392-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-13" tabindex="-1"></a>  <span class="fu">unnest</span>(file) <span class="sc">%&gt;%</span></span>
<span id="cb392-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-14" tabindex="-1"></a>  <span class="fu">separate</span>(file, <span class="fu">c</span>(<span class="st">&quot;Outcome&quot;</span>, <span class="st">&quot;Trait&quot;</span>, <span class="st">&quot;Moderator&quot;</span>, <span class="st">&quot;Covariate&quot;</span>, <span class="st">&quot;study&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="at">remove =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb392-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-15" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(study)) <span class="sc">%&gt;%</span></span>
<span id="cb392-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-16" tabindex="-1"></a>  <span class="do">## read in the files</span></span>
<span id="cb392-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">study =</span> <span class="fu">str_remove</span>(study, <span class="st">&quot;.RData&quot;</span>),</span>
<span id="cb392-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-18" tabindex="-1"></a>         <span class="at">pred.rx =</span> <span class="fu">map2</span>(file, type, <span class="sc">~</span><span class="fu">loadRData</span>(.x, .y, <span class="st">&quot;pred.rx&quot;</span>, <span class="st">&quot;studyPredicted&quot;</span>))</span>
<span id="cb392-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-19" tabindex="-1"></a>         , <span class="at">n =</span> <span class="fu">map2</span>(file, type, <span class="sc">~</span><span class="fu">loadRData</span>(.x, .y, <span class="st">&quot;es&quot;</span>, <span class="st">&quot;studyEffects&quot;</span>))</span>
<span id="cb392-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-20" tabindex="-1"></a>         , <span class="at">n =</span> <span class="fu">map_dbl</span>(n, <span class="sc">~</span>(.)<span class="sc">$</span>ni[<span class="dv">1</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb392-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-21" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>file) <span class="sc">%&gt;%</span></span>
<span id="cb392-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-22" tabindex="-1"></a>  <span class="fu">unnest</span>(pred.rx) <span class="sc">%&gt;%</span></span>
<span id="cb392-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-23" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Trait, Outcome, Moderator, Covariate) <span class="sc">%&gt;%</span></span>
<span id="cb392-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-24" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">studyPred =</span> study<span class="sc">:</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb392-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb392-25" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-1" tabindex="-1"></a>ipd3_pred_fx_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, mod, type, outcome, trait, cov){</span>
<span id="cb393-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-2" tabindex="-1"></a>  d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> unclass <span class="sc">%&gt;%</span> data.frame</span>
<span id="cb393-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-3" tabindex="-1"></a>  d<span class="sc">$</span>mod_value <span class="ot">&lt;-</span> d[,mod]</span>
<span id="cb393-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-4" tabindex="-1"></a>  d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">all_of</span>(mod)) <span class="sc">%&gt;%</span> as_tibble</span>
<span id="cb393-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-5" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">class</span>(d<span class="sc">$</span>mod_value) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;factor&quot;</span>, <span class="st">&quot;character&quot;</span>)){</span>
<span id="cb393-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-6" tabindex="-1"></a>    d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mod_fac =</span> <span class="fu">factor</span>(mod_value))</span>
<span id="cb393-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-7" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb393-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-8" tabindex="-1"></a>      d2 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb393-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-9" tabindex="-1"></a>          <span class="fu">select</span>(study, mod_value) <span class="sc">%&gt;%</span> </span>
<span id="cb393-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-10" tabindex="-1"></a>          <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb393-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-11" tabindex="-1"></a>          <span class="fu">arrange</span>(study, mod_value)</span>
<span id="cb393-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-12" tabindex="-1"></a>      <span class="cf">if</span>(mod <span class="sc">==</span> <span class="st">&quot;age&quot;</span>) d2 <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mod_fac =</span> <span class="fu">factor</span>(mod_value, <span class="at">levels =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;-10 yrs&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;+10 yrs&quot;</span>)))</span>
<span id="cb393-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-13" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span>(mod <span class="sc">==</span> <span class="st">&quot;baseYear&quot;</span>) d2 <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mod_fac =</span> <span class="fu">factor</span>(mod_value, <span class="at">levels =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1990&quot;</span>, <span class="st">&quot;200)0&quot;</span>, <span class="st">&quot;2010&quot;</span>)))</span>
<span id="cb393-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-14" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span>(mod <span class="sc">==</span> <span class="st">&quot;baseAge&quot;</span>) d2 <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mod_fac =</span> <span class="fu">factor</span>(mod_value, <span class="at">levels =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;50&quot;</span>, <span class="st">&quot;60&quot;</span>, <span class="st">&quot;70&quot;</span>)))</span>
<span id="cb393-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-15" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span>(mod <span class="sc">==</span> <span class="st">&quot;predInt&quot;</span>) d2 <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mod_fac =</span> <span class="fu">factor</span>(mod_value, <span class="at">levels =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;-5 yrs&quot;</span>, <span class="st">&quot;5 yrs&quot;</span>, <span class="st">&quot;+5 yrs&quot;</span>)))</span>
<span id="cb393-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-16" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span>(mod <span class="sc">==</span> <span class="st">&quot;education&quot;</span>) d2 <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mod_fac =</span> <span class="fu">factor</span>(mod_value, <span class="at">levels =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;-5 yrs&quot;</span>, <span class="st">&quot;12 years&quot;</span>, <span class="st">&quot;+5 yrs&quot;</span>)))</span>
<span id="cb393-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-17" tabindex="-1"></a>      <span class="cf">else</span> d2 <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mod_fac =</span> <span class="fu">factor</span>(mod_value, <span class="at">levels =</span> <span class="fu">unique</span>(mod_value), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;-1 SD&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;+1 SD&quot;</span>)))</span>
<span id="cb393-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-18" tabindex="-1"></a>      d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">full_join</span>(d2) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb393-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-19" tabindex="-1"></a>  }</span>
<span id="cb393-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-20" tabindex="-1"></a>  pred.fx <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb393-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-21" tabindex="-1"></a>    <span class="fu">group_by</span>(p_value, mod_fac) <span class="sc">%&gt;%</span></span>
<span id="cb393-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-22" tabindex="-1"></a>    <span class="fu">summarize_at</span>(<span class="fu">vars</span>(pred, lower, upper), <span class="sc">~</span><span class="fu">weighted.mean</span>(., n)) <span class="sc">%&gt;%</span></span>
<span id="cb393-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-23" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb393-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-24" tabindex="-1"></a>  <span class="fu">save</span>(pred.fx, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/metaPredicted/%s_%s_%s_%s.RData&quot;</span></span>
<span id="cb393-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-25" tabindex="-1"></a>                          , local_path, type, outcome, trait, mod, cov))</span>
<span id="cb393-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-26" tabindex="-1"></a>}</span>
<span id="cb393-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-27" tabindex="-1"></a></span>
<span id="cb393-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-28" tabindex="-1"></a>nested_ipd3_meta <span class="sc">%&gt;%</span></span>
<span id="cb393-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-29" tabindex="-1"></a>  <span class="co"># filter(Moderator == &quot;baseAge&quot;) %&gt;%</span></span>
<span id="cb393-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb393-30" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(studyPred, Moderator, type, Outcome, Trait, Covariate), ipd3_pred_fx_fun))</span></code></pre></div>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-1" tabindex="-1"></a>ipd3_se_plot_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, outcome, mod, cov, type){</span>
<span id="cb394-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-2" tabindex="-1"></a>  <span class="co"># print(paste(int, mod, cov, random, imp))</span></span>
<span id="cb394-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-3" tabindex="-1"></a>  o <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(outcome, outcomes<span class="sc">$</span>short_name, outcomes<span class="sc">$</span>long_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb394-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-4" tabindex="-1"></a>  cv <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(cov, covars<span class="sc">$</span>short_name, covars<span class="sc">$</span>long_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb394-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-5" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(mod, moders<span class="sc">$</span>short_name, moders<span class="sc">$</span>long_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb394-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-6" tabindex="-1"></a>  titl <span class="ot">&lt;-</span> <span class="cf">if</span>(mod <span class="sc">==</span> <span class="st">&quot;none&quot;</span>){<span class="fu">sprintf</span>(<span class="st">&quot;%s&quot;</span>, o)} <span class="cf">else</span> {<span class="fu">sprintf</span>(<span class="st">&quot;%s: Personality x %s Simple Effects&quot;</span>, o, m)}</span>
<span id="cb394-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-7" tabindex="-1"></a>  </span>
<span id="cb394-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-8" tabindex="-1"></a>  d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb394-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-9" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">study =</span> <span class="fu">mapvalues</span>(study, <span class="fu">c</span>(<span class="st">&quot;BASE-I&quot;</span>, <span class="st">&quot;OCTO-TWIN&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;BASE&quot;</span>, <span class="st">&quot;OCTO-Twin&quot;</span>)),</span>
<span id="cb394-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-10" tabindex="-1"></a>           <span class="at">study =</span> <span class="fu">factor</span>(study, <span class="at">levels =</span> stdcolors<span class="sc">$</span>studies))</span>
<span id="cb394-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-11" tabindex="-1"></a>  std <span class="ot">&lt;-</span> <span class="fu">unique</span>(d<span class="sc">$</span>study)</span>
<span id="cb394-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-12" tabindex="-1"></a>  <span class="co"># cols &lt;- (stdcolors %&gt;% filter(studies %in% std))$colors</span></span>
<span id="cb394-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-13" tabindex="-1"></a>  d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> unclass <span class="sc">%&gt;%</span> data.frame</span>
<span id="cb394-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-14" tabindex="-1"></a>  d<span class="sc">$</span>mod_value <span class="ot">&lt;-</span> d[,mod]</span>
<span id="cb394-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-15" tabindex="-1"></a>  d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">all_of</span>(mod)) <span class="sc">%&gt;%</span> as_tibble</span>
<span id="cb394-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-16" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">class</span>(d<span class="sc">$</span>mod_value) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;factor&quot;</span>, <span class="st">&quot;character&quot;</span>)){</span>
<span id="cb394-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-17" tabindex="-1"></a>    d <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mod_fac =</span> <span class="fu">factor</span>(mod_value))</span>
<span id="cb394-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-18" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb394-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-19" tabindex="-1"></a>      d <span class="sc">%&gt;%</span></span>
<span id="cb394-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-20" tabindex="-1"></a>      <span class="fu">full_join</span>(</span>
<span id="cb394-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-21" tabindex="-1"></a>        d <span class="sc">%&gt;%</span> <span class="fu">select</span>(Trait,study, mod_value) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(study, mod_value) <span class="sc">%&gt;%</span></span>
<span id="cb394-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-22" tabindex="-1"></a>          <span class="fu">group_by</span>(Trait, study) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mod_fac =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;-1 SD&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;+1 SD&quot;</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;-1 SD&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;+1 SD&quot;</span>))) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb394-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-23" tabindex="-1"></a>        )</span>
<span id="cb394-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-24" tabindex="-1"></a>  }</span>
<span id="cb394-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-25" tabindex="-1"></a>  lt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;dotted&quot;</span>, <span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(d<span class="sc">$</span>mod_fac))]</span>
<span id="cb394-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-26" tabindex="-1"></a>  ht <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(d<span class="sc">$</span>mod_fac))</span>
<span id="cb394-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-27" tabindex="-1"></a>  p <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb394-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-28" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Trait =</span> <span class="fu">factor</span>(Trait, <span class="at">levels =</span> traits<span class="sc">$</span>short_name, <span class="at">labels =</span> traits<span class="sc">$</span>long_name)) <span class="sc">%&gt;%</span></span>
<span id="cb394-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-29" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_value, <span class="at">y =</span> pred, <span class="at">group =</span> <span class="fu">interaction</span>(Trait, mod_fac), <span class="at">linetype =</span> mod_fac)) <span class="sc">+</span> </span>
<span id="cb394-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-30" tabindex="-1"></a>      <span class="co"># geom_line(aes(color = study</span></span>
<span id="cb394-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-31" tabindex="-1"></a>      <span class="co">#               , group = interaction(study, mod_fac)</span></span>
<span id="cb394-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-32" tabindex="-1"></a>      <span class="co">#               , linetype = study)</span></span>
<span id="cb394-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-33" tabindex="-1"></a>      <span class="co">#           , size = 1) + </span></span>
<span id="cb394-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-34" tabindex="-1"></a>      <span class="co"># geom_ribbon(aes(fill = study</span></span>
<span id="cb394-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-35" tabindex="-1"></a>      <span class="co">#                 , group = interaction(study, mod_fac)</span></span>
<span id="cb394-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-36" tabindex="-1"></a>      <span class="co">#                 , ymin = lower</span></span>
<span id="cb394-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-37" tabindex="-1"></a>      <span class="co">#                 , ymax = upper)</span></span>
<span id="cb394-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-38" tabindex="-1"></a>      <span class="co">#             , alpha = .25) + </span></span>
<span id="cb394-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-39" tabindex="-1"></a>      <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">weight =</span> n, <span class="at">linetype =</span> mod_fac, <span class="at">fill =</span> mod_fac)</span>
<span id="cb394-40"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-40" tabindex="-1"></a>                  , <span class="at">method =</span> <span class="st">&quot;lm&quot;</span></span>
<span id="cb394-41"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-41" tabindex="-1"></a>                  , <span class="at">formula =</span> y<span class="sc">~</span>x</span>
<span id="cb394-42"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-42" tabindex="-1"></a>                  , <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb394-43"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-43" tabindex="-1"></a>                  , <span class="at">color =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb394-44"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-44" tabindex="-1"></a>                  ) <span class="sc">+</span></span>
<span id="cb394-45"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-45" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(<span class="sc">~</span>Trait, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb394-46"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-46" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">10</span>)</span>
<span id="cb394-47"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-47" tabindex="-1"></a>                         , <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb394-48"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-48" tabindex="-1"></a>                         , <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb394-49"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-49" tabindex="-1"></a>      <span class="co"># scale_color_manual(values = cols) +</span></span>
<span id="cb394-50"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-50" tabindex="-1"></a>      <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> lt) <span class="sc">+</span></span>
<span id="cb394-51"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-51" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Personality Score (POMP)&quot;</span></span>
<span id="cb394-52"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-52" tabindex="-1"></a>           , <span class="at">y =</span> <span class="st">&quot;Cognition Score (POMP)&quot;</span></span>
<span id="cb394-53"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-53" tabindex="-1"></a>           <span class="co"># , color = &quot;Study&quot;</span></span>
<span id="cb394-54"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-54" tabindex="-1"></a>           , <span class="at">fill =</span> m</span>
<span id="cb394-55"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-55" tabindex="-1"></a>           , <span class="at">linetype =</span> m</span>
<span id="cb394-56"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-56" tabindex="-1"></a>           , <span class="at">title =</span> titl</span>
<span id="cb394-57"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-57" tabindex="-1"></a>           , <span class="at">subtitle =</span> <span class="st">&quot;Method 3: Two-Stage Individual Participant Meta-Analysis&quot;</span></span>
<span id="cb394-58"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-58" tabindex="-1"></a>           )  <span class="sc">+</span></span>
<span id="cb394-59"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-59" tabindex="-1"></a>      <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb394-60"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-60" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb394-61"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-61" tabindex="-1"></a>            , <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.2</span>), <span class="at">hjust =</span> .<span class="dv">5</span>)</span>
<span id="cb394-62"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-62" tabindex="-1"></a>            , <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>), <span class="at">hjust =</span> .<span class="dv">5</span>)</span>
<span id="cb394-63"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-63" tabindex="-1"></a>            , <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb394-64"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-64" tabindex="-1"></a>            , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb394-65"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-65" tabindex="-1"></a>            , <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>))</span>
<span id="cb394-66"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-66" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/figures/overall simple effects/%s_%s_%s.png&quot;</span>, local_path, type, outcome, mod, cov), <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb394-67"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-67" tabindex="-1"></a>}</span>
<span id="cb394-68"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-68" tabindex="-1"></a></span>
<span id="cb394-69"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-69" tabindex="-1"></a>nested_ipd3_meta <span class="sc">%&gt;%</span></span>
<span id="cb394-70"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-70" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Outcome, Moderator, Covariate) <span class="sc">%&gt;%</span></span>
<span id="cb394-71"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-71" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb394-72"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-72" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb394-73"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-73" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(studyPred))</span>
<span id="cb394-74"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb394-74" tabindex="-1"></a>         , <span class="at">p =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(data, Outcome, Moderator, Covariate, type), ipd3_se_plot_fun))</span></code></pre></div>
</div>
<div id="study-specific-simple-effects-plots-2" class="section level4 hasAnchor" number="5.4.4.2">
<h4><span class="header-section-number">5.4.4.2</span> Study-Specific Simple Effects Plots<a href="method-3-two-stage-individual-participant-meta-analysis.html#study-specific-simple-effects-plots-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-1" tabindex="-1"></a>ipd3_std_se_plot_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, outcome, trait, mod, cov, type){</span>
<span id="cb395-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-2" tabindex="-1"></a>  <span class="co"># print(paste(int, mod, cov, random, imp))</span></span>
<span id="cb395-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-3" tabindex="-1"></a>  o <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(outcome, outcomes<span class="sc">$</span>short_name, outcomes<span class="sc">$</span>long_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb395-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-4" tabindex="-1"></a>  trt <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(trait, traits<span class="sc">$</span>short_name, traits<span class="sc">$</span>long_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb395-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-5" tabindex="-1"></a>  cv <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(cov, covars<span class="sc">$</span>short_name, covars<span class="sc">$</span>long_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb395-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-6" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(mod, moders<span class="sc">$</span>short_name, moders<span class="sc">$</span>long_name, <span class="at">warn_missing =</span> F)</span>
<span id="cb395-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-7" tabindex="-1"></a>  titl <span class="ot">&lt;-</span> <span class="cf">if</span>(mod <span class="sc">==</span> <span class="st">&quot;none&quot;</span>){<span class="fu">sprintf</span>(<span class="st">&quot;%s: %s&quot;</span>, o, trt)} <span class="cf">else</span> {<span class="fu">sprintf</span>(<span class="st">&quot;%s: %s x %s Simple Effects&quot;</span>, o, trt, m)}</span>
<span id="cb395-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-8" tabindex="-1"></a>  d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">study =</span> <span class="fu">mapvalues</span>(study, <span class="fu">c</span>(<span class="st">&quot;BASE-I&quot;</span>, <span class="st">&quot;OCTO-TWIN&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;BASE&quot;</span>, <span class="st">&quot;OCTO-Twin&quot;</span>)),</span>
<span id="cb395-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-9" tabindex="-1"></a>           <span class="at">study =</span> <span class="fu">factor</span>(study, <span class="at">levels =</span> stdcolors<span class="sc">$</span>studies))</span>
<span id="cb395-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-10" tabindex="-1"></a>  std <span class="ot">&lt;-</span> <span class="fu">unique</span>(d<span class="sc">$</span>study)</span>
<span id="cb395-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-11" tabindex="-1"></a>  cols <span class="ot">&lt;-</span> (stdcolors <span class="sc">%&gt;%</span> <span class="fu">filter</span>(studies <span class="sc">%in%</span> std))<span class="sc">$</span>colors</span>
<span id="cb395-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-12" tabindex="-1"></a>  lt <span class="ot">&lt;-</span> (stdcolors <span class="sc">%&gt;%</span> <span class="fu">filter</span>(studies <span class="sc">%in%</span> std))<span class="sc">$</span>lt</span>
<span id="cb395-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-13" tabindex="-1"></a>  d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> unclass <span class="sc">%&gt;%</span> data.frame</span>
<span id="cb395-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-14" tabindex="-1"></a>  d<span class="sc">$</span>mod_value <span class="ot">&lt;-</span> d[,mod]</span>
<span id="cb395-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-15" tabindex="-1"></a>  d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">all_of</span>(mod)) <span class="sc">%&gt;%</span> as_tibble</span>
<span id="cb395-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-16" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">class</span>(d<span class="sc">$</span>mod_value) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;factor&quot;</span>, <span class="st">&quot;character&quot;</span>)){</span>
<span id="cb395-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-17" tabindex="-1"></a>    d <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mod_fac =</span> <span class="fu">factor</span>(mod_value))</span>
<span id="cb395-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-18" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb395-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-19" tabindex="-1"></a>      d <span class="sc">%&gt;%</span></span>
<span id="cb395-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-20" tabindex="-1"></a>      <span class="fu">full_join</span>(</span>
<span id="cb395-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-21" tabindex="-1"></a>        d <span class="sc">%&gt;%</span> <span class="fu">select</span>(study, mod_value) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(study, mod_value) <span class="sc">%&gt;%</span></span>
<span id="cb395-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-22" tabindex="-1"></a>          <span class="fu">group_by</span>(study) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mod_fac =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;-1 SD&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;+1 SD&quot;</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;-1 SD&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;+1 SD&quot;</span>))) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb395-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-23" tabindex="-1"></a>        )</span>
<span id="cb395-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-24" tabindex="-1"></a>  }</span>
<span id="cb395-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-25" tabindex="-1"></a>  ht <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(d<span class="sc">$</span>mod_fac))</span>
<span id="cb395-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-26" tabindex="-1"></a>  p <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb395-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-27" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_value, <span class="at">y =</span> pred)) <span class="sc">+</span> </span>
<span id="cb395-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-28" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> study</span>
<span id="cb395-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-29" tabindex="-1"></a>                    , <span class="at">group =</span> <span class="fu">interaction</span>(study, mod_fac)</span>
<span id="cb395-30"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-30" tabindex="-1"></a>                    , <span class="at">linetype =</span> study)</span>
<span id="cb395-31"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-31" tabindex="-1"></a>                , <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb395-32"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-32" tabindex="-1"></a>      <span class="co"># geom_ribbon(aes(fill = study</span></span>
<span id="cb395-33"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-33" tabindex="-1"></a>      <span class="co">#                 , group = interaction(study, mod_fac)</span></span>
<span id="cb395-34"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-34" tabindex="-1"></a>      <span class="co">#                 , ymin = lower</span></span>
<span id="cb395-35"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-35" tabindex="-1"></a>      <span class="co">#                 , ymax = upper)</span></span>
<span id="cb395-36"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-36" tabindex="-1"></a>      <span class="co">#             , alpha = .25) + </span></span>
<span id="cb395-37"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-37" tabindex="-1"></a>      <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">weight =</span> n)</span>
<span id="cb395-38"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-38" tabindex="-1"></a>                  , <span class="at">method =</span> <span class="st">&quot;lm&quot;</span></span>
<span id="cb395-39"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-39" tabindex="-1"></a>                  , <span class="at">formula =</span> y<span class="sc">~</span>x</span>
<span id="cb395-40"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-40" tabindex="-1"></a>                  , <span class="at">size =</span> <span class="fl">1.2</span></span>
<span id="cb395-41"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-41" tabindex="-1"></a>                  , <span class="at">color =</span> <span class="st">&quot;darkslateblue&quot;</span></span>
<span id="cb395-42"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-42" tabindex="-1"></a>                  ) <span class="sc">+</span></span>
<span id="cb395-43"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-43" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">10</span>)</span>
<span id="cb395-44"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-44" tabindex="-1"></a>                         , <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb395-45"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-45" tabindex="-1"></a>                         , <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb395-46"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-46" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cols) <span class="sc">+</span></span>
<span id="cb395-47"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-47" tabindex="-1"></a>      <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> lt) <span class="sc">+</span></span>
<span id="cb395-48"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-48" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Personality Score (POMP)&quot;</span></span>
<span id="cb395-49"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-49" tabindex="-1"></a>           , <span class="at">y =</span> <span class="st">&quot;Cognition Score (POMP)&quot;</span></span>
<span id="cb395-50"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-50" tabindex="-1"></a>           , <span class="at">color =</span> <span class="st">&quot;Study&quot;</span></span>
<span id="cb395-51"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-51" tabindex="-1"></a>           , <span class="at">fill =</span> <span class="st">&quot;Study&quot;</span></span>
<span id="cb395-52"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-52" tabindex="-1"></a>           , <span class="at">linetype =</span> <span class="st">&quot;Study&quot;</span></span>
<span id="cb395-53"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-53" tabindex="-1"></a>           , <span class="at">title =</span> titl</span>
<span id="cb395-54"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-54" tabindex="-1"></a>           , <span class="at">subtitle =</span> <span class="st">&quot;Method 3: Two-Stage Individual Participant Meta-Analysis&quot;</span></span>
<span id="cb395-55"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-55" tabindex="-1"></a>           )  <span class="sc">+</span></span>
<span id="cb395-56"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-56" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(<span class="sc">~</span>mod_fac) <span class="sc">+</span> </span>
<span id="cb395-57"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-57" tabindex="-1"></a>      <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb395-58"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-58" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb395-59"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-59" tabindex="-1"></a>            , <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">size =</span> <span class="fu">rel</span>(.<span class="dv">95</span>))</span>
<span id="cb395-60"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-60" tabindex="-1"></a>            , <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>), <span class="at">hjust =</span> .<span class="dv">5</span>)</span>
<span id="cb395-61"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-61" tabindex="-1"></a>            , <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb395-62"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-62" tabindex="-1"></a>            , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb395-63"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-63" tabindex="-1"></a>            , <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>))</span>
<span id="cb395-64"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-64" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/results/3_ipd_meta/%s/figures/study specific simple effects/%s_%s_%s_%s.png&quot;</span>, local_path, type, outcome, trt, mod, cov), <span class="at">width =</span> <span class="dv">3</span><span class="sc">*</span>ht, <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb395-65"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-65" tabindex="-1"></a>}</span>
<span id="cb395-66"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-66" tabindex="-1"></a></span>
<span id="cb395-67"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-67" tabindex="-1"></a>nested_ipd3_meta <span class="sc">%&gt;%</span></span>
<span id="cb395-68"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb395-68" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(studyPred, Outcome, Trait, Moderator, Covariate, type), ipd3_std_se_plot_fun))</span></code></pre></div>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb396-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;~/Documents/projects/data synthesis/crystallized/results/3_ipd_meta/Frequentist/metaModels/crystallized_C_country_all.RData&quot;</span>)</span>
<span id="cb396-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb396-2" tabindex="-1"></a><span class="fu">coef</span>(mt)</span></code></pre></div>
<pre><code>##          intrcpt metamodAustralia   metamodGermany    metamodSweden 
##       0.06433784      -0.06106685      -0.06322996      -0.18061653</code></pre>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb398-1" tabindex="-1"></a>cntrm <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb398-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb398-2" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb398-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb398-3" tabindex="-1"></a>  , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb398-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb398-4" tabindex="-1"></a>  , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb398-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb398-5" tabindex="-1"></a>  , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb398-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb398-6" tabindex="-1"></a>); <span class="fu">rownames</span>(cntrm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;United States&quot;</span>, <span class="st">&quot;Australia&quot;</span>, <span class="st">&quot;Germany&quot;</span>, <span class="st">&quot;Sweden&quot;</span>)</span>
<span id="cb398-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb398-7" tabindex="-1"></a></span>
<span id="cb398-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb398-8" tabindex="-1"></a>(multcomp<span class="sc">::</span><span class="fu">glht</span>(mt, cntrm) <span class="sc">%&gt;%</span> <span class="co"># multcomp hypothesis function</span></span>
<span id="cb398-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb398-9" tabindex="-1"></a>      <span class="fu">confint</span>(., <span class="at">calpha =</span> multcomp<span class="sc">::</span><span class="fu">univariate_calpha</span>()))<span class="sc">$</span>confint <span class="sc">%&gt;%</span></span>
<span id="cb398-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb398-10" tabindex="-1"></a>      <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb398-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb398-11" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb398-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb398-12" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;cntr&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb398-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb398-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">rownames</span>(cntrm)) <span class="sc">%&gt;%</span> </span>
<span id="cb398-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb398-14" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>cntr) <span class="sc">%&gt;%</span></span>
<span id="cb398-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb398-15" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">est =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(Estimate) <span class="sc">&lt;</span> .<span class="dv">01</span>, <span class="fu">sprintf</span>(<span class="st">&quot;b = %.3f, 95%% CI [%.3f, %.3f]&quot;</span>, Estimate, lwr, upr), <span class="fu">sprintf</span>(<span class="st">&quot;b = %.2f, 95%% CI [%.2f, %.2f]&quot;</span>, Estimate, lwr, upr)))</span></code></pre></div>
<pre><code>##       Estimate         lwr         upr          term                               est
## 1  0.064337841  0.04167694  0.08699874 United States     b = 0.06, 95% CI [0.04, 0.09]
## 2  0.003270996 -0.02297616  0.02951815     Australia b = 0.003, 95% CI [-0.023, 0.030]
## 3  0.001107879 -0.05502738  0.05724314       Germany b = 0.001, 95% CI [-0.055, 0.057]
## 4 -0.116278686 -0.20058736 -0.03197002        Sweden  b = -0.12, 95% CI [-0.20, -0.03]</code></pre>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb400-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;~/Documents/projects/data synthesis/crystallized/results/3_ipd_meta/Frequentist/metaModels/crystallized_C_scale_all.RData&quot;</span>)</span>
<span id="cb400-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb400-2" tabindex="-1"></a><span class="fu">coef</span>(mt)</span></code></pre></div>
<pre><code>##         intrcpt    metamodBFI-S  metamodEysenck metamodIPIP NEO     metamodMIDI   metamodTDA-40 
##      0.08889284     -0.08778496     -0.20517153     -0.12764963     -0.02316003     -0.08562185</code></pre>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-1" tabindex="-1"></a>cntrm <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb402-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-2" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># NEO-FFI</span></span>
<span id="cb402-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-3" tabindex="-1"></a>  , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># BFI-S</span></span>
<span id="cb402-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-4" tabindex="-1"></a>  , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># Eysenck</span></span>
<span id="cb402-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-5" tabindex="-1"></a>  , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># IPIP NEO</span></span>
<span id="cb402-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-6" tabindex="-1"></a>  , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>) <span class="co"># MIDI</span></span>
<span id="cb402-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-7" tabindex="-1"></a>  , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="co"># TDA-40</span></span>
<span id="cb402-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-8" tabindex="-1"></a>); <span class="fu">rownames</span>(cntrm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;NEO-FFI&quot;</span>, <span class="st">&quot;BFI-S&quot;</span>, <span class="st">&quot;Eysenck&quot;</span>, <span class="st">&quot;IPIP NEO&quot;</span>, <span class="st">&quot;MIDI&quot;</span>, <span class="st">&quot;TDA-40&quot;</span>)</span>
<span id="cb402-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-9" tabindex="-1"></a></span>
<span id="cb402-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-10" tabindex="-1"></a>(multcomp<span class="sc">::</span><span class="fu">glht</span>(mt, cntrm) <span class="sc">%&gt;%</span> <span class="co"># multcomp hypothesis function</span></span>
<span id="cb402-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-11" tabindex="-1"></a>      <span class="fu">confint</span>(., <span class="at">calpha =</span> multcomp<span class="sc">::</span><span class="fu">univariate_calpha</span>()))<span class="sc">$</span>confint <span class="sc">%&gt;%</span></span>
<span id="cb402-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-12" tabindex="-1"></a>      <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb402-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-13" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb402-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-14" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;cntr&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb402-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-15" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">rownames</span>(cntrm)) <span class="sc">%&gt;%</span> </span>
<span id="cb402-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-16" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>cntr) <span class="sc">%&gt;%</span></span>
<span id="cb402-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb402-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">est =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(Estimate) <span class="sc">&lt;</span> .<span class="dv">01</span>, <span class="fu">sprintf</span>(<span class="st">&quot;b = %.3f, 95%% CI [%.3f, %.3f]&quot;</span>, Estimate, lwr, upr), <span class="fu">sprintf</span>(<span class="st">&quot;b = %.2f, 95%% CI [%.2f, %.2f]&quot;</span>, Estimate, lwr, upr)))</span></code></pre></div>
<pre><code>##       Estimate         lwr         upr     term                               est
## 1  0.088892841  0.03486531  0.14292037  NEO-FFI     b = 0.09, 95% CI [0.03, 0.14]
## 2  0.001107879 -0.05488928  0.05710503    BFI-S b = 0.001, 95% CI [-0.055, 0.057]
## 3 -0.116278686 -0.20049547 -0.03206191  Eysenck  b = -0.12, 95% CI [-0.20, -0.03]
## 4 -0.038756793 -0.13781345  0.06029986 IPIP NEO   b = -0.04, 95% CI [-0.14, 0.06]
## 5  0.065732812  0.04024951  0.09121611     MIDI     b = 0.07, 95% CI [0.04, 0.09]
## 6  0.003270996 -0.02267949  0.02922148   TDA-40 b = 0.003, 95% CI [-0.023, 0.029]</code></pre>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb404-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;~/Documents/projects/data synthesis/crystallized/results/3_ipd_meta/Frequentist/metaModels/crystallized_N_scale_all.RData&quot;</span>)</span>
<span id="cb404-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb404-2" tabindex="-1"></a><span class="fu">coef</span>(mt)</span></code></pre></div>
<pre><code>##         intrcpt    metamodBFI-S      metamodDPQ  metamodEysenck metamodIPIP NEO     metamodMIDI   metamodTDA-40 
##     -0.11303919      0.07722236      0.06822839      0.07197000      0.06484409      0.09060320     -0.00330891</code></pre>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-1" tabindex="-1"></a>cntrm <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb406-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-2" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># NEO-FFI</span></span>
<span id="cb406-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-3" tabindex="-1"></a>  , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># BFI-S</span></span>
<span id="cb406-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-4" tabindex="-1"></a>  , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># DPQ</span></span>
<span id="cb406-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-5" tabindex="-1"></a>  , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># Eysenck</span></span>
<span id="cb406-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-6" tabindex="-1"></a>  , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># IPIP NEO</span></span>
<span id="cb406-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-7" tabindex="-1"></a>  , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>) <span class="co"># MIDI</span></span>
<span id="cb406-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-8" tabindex="-1"></a>  , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="co"># TDA-40</span></span>
<span id="cb406-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-9" tabindex="-1"></a>); <span class="fu">rownames</span>(cntrm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;NEO-FFI&quot;</span>, <span class="st">&quot;BFI-S&quot;</span>, <span class="st">&quot;DPQ&quot;</span>, <span class="st">&quot;Eysenck&quot;</span>, <span class="st">&quot;IPIP NEO&quot;</span>, <span class="st">&quot;MIDI&quot;</span>, <span class="st">&quot;TDA-40&quot;</span>)</span>
<span id="cb406-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-10" tabindex="-1"></a></span>
<span id="cb406-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-11" tabindex="-1"></a>(multcomp<span class="sc">::</span><span class="fu">glht</span>(mt, cntrm) <span class="sc">%&gt;%</span> <span class="co"># multcomp hypothesis function</span></span>
<span id="cb406-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-12" tabindex="-1"></a>      <span class="fu">confint</span>(., <span class="at">calpha =</span> multcomp<span class="sc">::</span><span class="fu">univariate_calpha</span>()))<span class="sc">$</span>confint <span class="sc">%&gt;%</span></span>
<span id="cb406-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-13" tabindex="-1"></a>      <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb406-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-14" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb406-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-15" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;cntr&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb406-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">rownames</span>(cntrm),</span>
<span id="cb406-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-17" tabindex="-1"></a>         <span class="at">sig =</span> <span class="fu">ifelse</span>(<span class="fu">sign</span>(lwr) <span class="sc">==</span> <span class="fu">sign</span>(upr), <span class="st">&quot;sig&quot;</span>, <span class="st">&quot;ns&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb406-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-18" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>cntr) <span class="sc">%&gt;%</span></span>
<span id="cb406-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-19" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">est =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(Estimate) <span class="sc">&lt;</span> .<span class="dv">01</span>, <span class="fu">sprintf</span>(<span class="st">&quot;b = %.3f, 95%% CI [%.3f, %.3f]&quot;</span>, Estimate, lwr, upr), <span class="fu">sprintf</span>(<span class="st">&quot;b = %.2f, 95%% CI [%.2f, %.2f]&quot;</span>, Estimate, lwr, upr))) <span class="sc">%&gt;%</span></span>
<span id="cb406-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb406-20" tabindex="-1"></a>  <span class="fu">arrange</span>(sig, Estimate)</span></code></pre></div>
<pre><code>##      Estimate         lwr          upr     term sig                              est
## 1 -0.04819510 -0.14247152  0.046081326 IPIP NEO  ns  b = -0.05, 95% CI [-0.14, 0.05]
## 2 -0.04106919 -0.10615703  0.024018652  Eysenck  ns  b = -0.04, 95% CI [-0.11, 0.02]
## 3 -0.03581683 -0.08170762  0.010073957    BFI-S  ns  b = -0.04, 95% CI [-0.08, 0.01]
## 4 -0.11634810 -0.14179851 -0.090897687   TDA-40 sig b = -0.12, 95% CI [-0.14, -0.09]
## 5 -0.11303919 -0.15448612 -0.071592256  NEO-FFI sig b = -0.11, 95% CI [-0.15, -0.07]
## 6 -0.04481079 -0.08127859 -0.008343002      DPQ sig b = -0.04, 95% CI [-0.08, -0.01]
## 7 -0.02243598 -0.04344011 -0.001431855     MIDI sig b = -0.02, 95% CI [-0.04, -0.00]</code></pre>
</div>
</div>
<div id="table-meta-analytic-heterogeneity" class="section level3 hasAnchor" number="5.4.5">
<h3><span class="header-section-number">5.4.5</span> Table Meta-Analytic Heterogeneity<a href="method-3-two-stage-individual-participant-meta-analysis.html#table-meta-analytic-heterogeneity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Relative to previous tables, this is slightly complicated because Frequentist and Bayesian meta-analysis don’t use the same methods for estimating heterogeneity.</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb408-1" tabindex="-1"></a>ipd3_het_tab <span class="ot">&lt;-</span> nested_ipd3_meta <span class="sc">%&gt;%</span> </span>
<span id="cb408-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb408-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>studyEff, <span class="sc">-</span>metaEff) <span class="sc">%&gt;%</span></span>
<span id="cb408-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb408-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trait =</span> <span class="fu">factor</span>(Trait, traits<span class="sc">$</span>short_name, traits<span class="sc">$</span>long_name),</span>
<span id="cb408-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb408-4" tabindex="-1"></a>         <span class="at">Outcome =</span> <span class="fu">factor</span>(Outcome, outcomes<span class="sc">$</span>short_name, outcomes<span class="sc">$</span>long_name)) <span class="sc">%&gt;%</span></span>
<span id="cb408-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb408-5" tabindex="-1"></a>  <span class="fu">arrange</span>(type, Outcome, Trait, Moderator) <span class="sc">%&gt;%</span></span>
<span id="cb408-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb408-6" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Moderator) <span class="sc">%&gt;%</span></span>
<span id="cb408-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb408-7" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb408-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb408-8" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb408-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb408-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(metaHet)))</span>
<span id="cb408-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb408-10" tabindex="-1"></a>ipd3_het_tab</span>
<span id="cb408-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb408-11" tabindex="-1"></a></span>
<span id="cb408-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb408-12" tabindex="-1"></a><span class="do">## frequentist</span></span>
<span id="cb408-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb408-13" tabindex="-1"></a>ipd3_het_tab<span class="sc">$</span>data[[<span class="fu">nrow</span>(ipd3_het_tab)]]</span>
<span id="cb408-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb408-14" tabindex="-1"></a><span class="do">## bayesian</span></span>
<span id="cb408-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb408-15" tabindex="-1"></a>ipd3_het_tab<span class="sc">$</span>data[[<span class="dv">1</span>]]</span></code></pre></div>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-1" tabindex="-1"></a>ipd3_het_tab_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, type, moder){</span>
<span id="cb409-2"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-2" tabindex="-1"></a>  rs <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Outcome) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb409-3"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">end =</span> <span class="fu">cumsum</span>(n), <span class="at">start =</span> <span class="fu">lag</span>(end) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">start =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(start), <span class="dv">1</span>, start))</span>
<span id="cb409-4"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-4" tabindex="-1"></a>  <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">&quot;Frequentist&quot;</span>){</span>
<span id="cb409-5"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-5" tabindex="-1"></a>    d <span class="sc">%&gt;%</span></span>
<span id="cb409-6"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-6" tabindex="-1"></a>      <span class="fu">mutate_at</span>(<span class="fu">vars</span>(tau2, QEp), <span class="sc">~</span><span class="fu">ifelse</span>(. <span class="sc">&lt;</span> .<span class="dv">001</span>, <span class="st">&quot;&lt; 0.001&quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, .))) <span class="sc">%&gt;%</span></span>
<span id="cb409-7"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-7" tabindex="-1"></a>      <span class="fu">mutate_at</span>(<span class="fu">vars</span>(I2<span class="sc">:</span>QE), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, .)) <span class="sc">%&gt;%</span></span>
<span id="cb409-8"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-8" tabindex="-1"></a>      <span class="fu">select</span>(Trait, tau2, I2, H2, QE, QEp) <span class="sc">%&gt;%</span></span>
<span id="cb409-9"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-9" tabindex="-1"></a>      <span class="fu">kable</span>(., <span class="st">&quot;html&quot;</span></span>
<span id="cb409-10"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-10" tabindex="-1"></a>            , <span class="at">escape =</span> F</span>
<span id="cb409-11"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-11" tabindex="-1"></a>            , <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb409-12"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-12" tabindex="-1"></a>            , <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Trait&quot;</span>, <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">tau^2$&quot;</span>, <span class="st">&quot;$I^2$&quot;</span>, <span class="st">&quot;$H^2$&quot;</span>, <span class="st">&quot;&lt;em&gt;Q&lt;/em&gt;&quot;</span>, <span class="st">&quot;&lt;em&gt;p&lt;/em&gt;&quot;</span>)</span>
<span id="cb409-13"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-13" tabindex="-1"></a>            , <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;c&quot;</span>,<span class="dv">5</span>))</span>
<span id="cb409-14"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-14" tabindex="-1"></a>            , <span class="at">caption =</span> <span class="fu">sprintf</span>(<span class="st">&quot;Table X. Heterogeneity estimates for %s Models with %s Moderator&quot;</span>, type, moder)) <span class="sc">%&gt;%</span></span>
<span id="cb409-15"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-15" tabindex="-1"></a>      <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">&quot;Times New Roman&quot;</span>)</span>
<span id="cb409-16"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-16" tabindex="-1"></a>  } <span class="cf">else</span>{</span>
<span id="cb409-17"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-17" tabindex="-1"></a>    d <span class="sc">%&gt;%</span></span>
<span id="cb409-18"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-18" tabindex="-1"></a>      <span class="fu">mutate_at</span>(<span class="fu">vars</span>(tau2, BF), <span class="sc">~</span><span class="fu">ifelse</span>(. <span class="sc">&lt;</span> .<span class="dv">001</span>, <span class="st">&quot;&lt; 0.001&quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, .))) <span class="sc">%&gt;%</span></span>
<span id="cb409-19"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-19" tabindex="-1"></a>      <span class="fu">mutate_at</span>(<span class="fu">vars</span>(I2, H2), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, .)) <span class="sc">%&gt;%</span></span>
<span id="cb409-20"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-20" tabindex="-1"></a>      <span class="fu">select</span>(Trait, tau2, I2, H2, BF) <span class="sc">%&gt;%</span></span>
<span id="cb409-21"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-21" tabindex="-1"></a>      <span class="fu">kable</span>(., <span class="st">&quot;html&quot;</span></span>
<span id="cb409-22"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-22" tabindex="-1"></a>            , <span class="at">escape =</span> F</span>
<span id="cb409-23"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-23" tabindex="-1"></a>            , <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb409-24"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-24" tabindex="-1"></a>            , <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Trait&quot;</span>, <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">tau^2$&quot;</span>, <span class="st">&quot;$I^2$&quot;</span>, <span class="st">&quot;$H^2$&quot;</span>, <span class="st">&quot;BF&quot;</span>)</span>
<span id="cb409-25"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-25" tabindex="-1"></a>            , <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;c&quot;</span>,<span class="dv">4</span>))</span>
<span id="cb409-26"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-26" tabindex="-1"></a>            , <span class="at">caption =</span> <span class="fu">sprintf</span>(<span class="st">&quot;Table X. Heterogeneity estimates for %s Models with %s Moderator&quot;</span>, type, moder)) <span class="sc">%&gt;%</span></span>
<span id="cb409-27"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-27" tabindex="-1"></a>      <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">&quot;Times New Roman&quot;</span>)</span>
<span id="cb409-28"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-28" tabindex="-1"></a>  }</span>
<span id="cb409-29"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb409-29" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="sample-results-section-4" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Sample Results Section<a href="method-3-two-stage-individual-participant-meta-analysis.html#sample-results-section-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We examined estimates of overall prospective associations between Big Five personality characteristics and crystallized abilities as well as participant and sample-level moderators of those associations using a two-stage individual participant meta-analysis of 11 studies. This allowed us to estimate both sample-specific and overall prospective associations between personality characteristics and cognitive ability as well as heterogeneity in those estimates. Fully adjusted Big Five personality trait-crystallized ability associations as well as participant- and sample-level moderators of these associations can be found in Table S5. Of the 20 key participant-level personality-crystallized ability associations and moderators of those associations, two (10%) were significant. Specifically, Openness was positively associated with later crystallized abilities, and gender moderated this association.</p>
<table class=" lightable-classic" style="color: black; font-family: Times New Roman; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-72">Table 5.1: </span>Method 3 Pooled Regression Using Random Effects: Meta-Analytic Estimates of Fully Adjusted Personality-Crystallized Domain Associations
</caption>
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Extraversion
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Agreeableness
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Conscientiousness
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Neuroticism
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Openness to Experience
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
Term
</th>
<th style="text-align:center;">
<em>b</em> [CI]
</th>
<th style="text-align:center;">
<em>b</em> [CI]
</th>
<th style="text-align:center;">
<em>b</em> [CI]
</th>
<th style="text-align:center;">
<em>b</em> [CI]
</th>
<th style="text-align:center;">
<em>b</em> [CI]
</th>
</tr>
</thead>
<tbody>
<tr grouplength="1">
<td colspan="6" style="border-bottom: 0;">
<strong>None</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Personality
</td>
<td style="text-align:center;">
0.01<br>[-0.02, 0.05]
</td>
<td style="text-align:center;">
0.02<br>[-0.001, 0.03]
</td>
<td style="text-align:center;">
0.02<br>[-0.03, 0.07]
</td>
<td style="text-align:center;">
<strong>-0.07<br>[-0.10, -0.04]</strong>
</td>
<td style="text-align:center;">
<strong>0.17<br>[0.10, 0.25]</strong>
</td>
</tr>
<tr grouplength="1">
<td colspan="6" style="border-bottom: 0;">
<strong>Age</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Age
</td>
<td style="text-align:center;">
-0.000<br>[-0.003, 0.002]
</td>
<td style="text-align:center;">
-0.001<br>[-0.003, 0.002]
</td>
<td style="text-align:center;">
-0.000<br>[-0.005, 0.004]
</td>
<td style="text-align:center;">
0.000<br>[-0.004, 0.005]
</td>
<td style="text-align:center;">
0.001<br>[-0.006, 0.007]
</td>
</tr>
<tr grouplength="1">
<td colspan="6" style="border-bottom: 0;">
<strong>Gender</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Gender (Male v Female)
</td>
<td style="text-align:center;">
0.04<br>[-0.004, 0.09]
</td>
<td style="text-align:center;">
0.02<br>[-0.02, 0.05]
</td>
<td style="text-align:center;">
0.005<br>[-0.03, 0.04]
</td>
<td style="text-align:center;">
-0.000<br>[-0.03, 0.03]
</td>
<td style="text-align:center;">
<strong>-0.04<br>[-0.07, -0.01]</strong>
</td>
</tr>
<tr grouplength="1">
<td colspan="6" style="border-bottom: 0;">
<strong>Education</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Education (Years)
</td>
<td style="text-align:center;">
-0.004<br>[-0.02, 0.008]
</td>
<td style="text-align:center;">
-0.008<br>[-0.02, 0.008]
</td>
<td style="text-align:center;">
0.003<br>[-0.01, 0.02]
</td>
<td style="text-align:center;">
-0.001<br>[-0.01, 0.008]
</td>
<td style="text-align:center;">
-0.007<br>[-0.02, 0.005]
</td>
</tr>
<tr grouplength="2">
<td colspan="6" style="border-bottom: 0;">
<strong>Continent</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Continent (North America v Australia)
</td>
<td style="text-align:center;">
0.03<br>[-0.06, 0.12]
</td>
<td style="text-align:center;">
-0.03<br>[-0.15, 0.08]
</td>
<td style="text-align:center;">
-0.06<br>[-0.17, 0.06]
</td>
<td style="text-align:center;">
-0.05<br>[-0.13, 0.04]
</td>
<td style="text-align:center;">
0.06<br>[-0.21, 0.33]
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Continent (North America v Europe)
</td>
<td style="text-align:center;">
0.06<br>[-0.02, 0.14]
</td>
<td style="text-align:center;">
-0.08<br>[-0.19, 0.03]
</td>
<td style="text-align:center;">
<strong>-0.11<br>[-0.21, -0.006]</strong>
</td>
<td style="text-align:center;">
0.02<br>[-0.04, 0.08]
</td>
<td style="text-align:center;">
0.08<br>[-0.13, 0.28]
</td>
</tr>
<tr grouplength="4">
<td colspan="6" style="border-bottom: 0;">
<strong>Country</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Country (United States v Australia)
</td>
<td style="text-align:center;">
0.03<br>[-0.05, 0.12]
</td>
<td style="text-align:center;">
-0.03<br>[-0.11, 0.06]
</td>
<td style="text-align:center;">
<strong>-0.06<br>[-0.10, -0.03]</strong>
</td>
<td style="text-align:center;">
-0.04<br>[-0.14, 0.06]
</td>
<td style="text-align:center;">
0.06<br>[-0.22, 0.34]
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Country (United States v Germany)
</td>
<td style="text-align:center;">
<strong>0.09<br>[0.002, 0.18]</strong>
</td>
<td style="text-align:center;">
-0.03<br>[-0.12, 0.07]
</td>
<td style="text-align:center;">
<strong>-0.06<br>[-0.12, -0.003]</strong>
</td>
<td style="text-align:center;">
0.02<br>[-0.08, 0.12]
</td>
<td style="text-align:center;">
0.04<br>[-0.20, 0.28]
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Country (United States v Sweden)
</td>
<td style="text-align:center;">
0.03<br>[-0.06, 0.13]
</td>
<td style="text-align:center;">
<strong>-0.15<br>[-0.28, -0.02]</strong>
</td>
<td style="text-align:center;">
<strong>-0.18<br>[-0.27, -0.09]</strong>
</td>
<td style="text-align:center;">
0.03<br>[-0.07, 0.13]
</td>
<td style="text-align:center;">
0.15<br>[-0.16, 0.46]
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Country (United States v The Netherlands)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.03<br>[-0.08, 0.14]
</td>
<td style="text-align:center;">
</td>
</tr>
<tr grouplength="6">
<td colspan="6" style="border-bottom: 0;">
<strong>Personality Scale</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Scale (NEO-FFI v Eysenck)
</td>
<td style="text-align:center;">
0.02<br>[-0.07, 0.12]
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<strong>-0.21<br>[-0.31, -0.11]</strong>
</td>
<td style="text-align:center;">
0.07<br>[-0.005, 0.15]
</td>
<td style="text-align:center;">
0.07<br>[-0.37, 0.51]
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Scale (NEO-FFI v BFI-S)
</td>
<td style="text-align:center;">
<strong>0.10<br>[0.01, 0.18]</strong>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<strong>-0.09<br>[-0.17, -0.010]</strong>
</td>
<td style="text-align:center;">
<strong>0.08<br>[0.02, 0.14]</strong>
</td>
<td style="text-align:center;">
-0.14<br>[-0.57, 0.28]
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Scale (NEO-FFI v DPQ)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<strong>0.07<br>[0.01, 0.12]</strong>
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Scale (NEO-FFI v IPIP NEO)
</td>
<td style="text-align:center;">
0.08<br>[-0.04, 0.20]
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<strong>-0.13<br>[-0.24, -0.01]</strong>
</td>
<td style="text-align:center;">
0.06<br>[-0.04, 0.17]
</td>
<td style="text-align:center;">
0.04<br>[-0.39, 0.48]
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Scale (NEO-FFI v MIDI)
</td>
<td style="text-align:center;">
-0.04<br>[-0.11, 0.03]
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
-0.02<br>[-0.08, 0.04]
</td>
<td style="text-align:center;">
<strong>0.09<br>[0.04, 0.14]</strong>
</td>
<td style="text-align:center;">
-0.13<br>[-0.55, 0.29]
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Scale (NEO-FFI v TDA-40)
</td>
<td style="text-align:center;">
0.03<br>[-0.05, 0.10]
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<strong>-0.09<br>[-0.15, -0.03]</strong>
</td>
<td style="text-align:center;">
-0.003<br>[-0.05, 0.05]
</td>
<td style="text-align:center;">
-0.01<br>[-0.43, 0.41]
</td>
</tr>
<tr grouplength="1">
<td colspan="6" style="border-bottom: 0;">
<strong>Baseline Age</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Study Baseline Age
</td>
<td style="text-align:center;">
-0.001<br>[-0.003, 0.002]
</td>
<td style="text-align:center;">
0.002<br>[-0.001, 0.004]
</td>
<td style="text-align:center;">
0.002<br>[-0.001, 0.006]
</td>
<td style="text-align:center;">
-0.000<br>[-0.003, 0.002]
</td>
<td style="text-align:center;">
0.001<br>[-0.005, 0.007]
</td>
</tr>
<tr grouplength="1">
<td colspan="6" style="border-bottom: 0;">
<strong>Baseline Year</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Study Baseline Year
</td>
<td style="text-align:center;">
0.001<br>[-0.004, 0.006]
</td>
<td style="text-align:center;">
<strong>0.005<br>[0.001, 0.009]</strong>
</td>
<td style="text-align:center;">
0.004<br>[-0.003, 0.01]
</td>
<td style="text-align:center;">
-0.000<br>[-0.005, 0.004]
</td>
<td style="text-align:center;">
-0.006<br>[-0.01, 0.003]
</td>
</tr>
<tr grouplength="1">
<td colspan="6" style="border-bottom: 0;">
<strong>Prediction Interval</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
Prediction Interval
</td>
<td style="text-align:center;">
-0.003<br>[-0.01, 0.009]
</td>
<td style="text-align:center;">
-0.007<br>[-0.02, 0.001]
</td>
<td style="text-align:center;">
-0.008<br>[-0.02, 0.006]
</td>
<td style="text-align:center;">
0.001<br>[-0.010, 0.01]
</td>
<td style="text-align:center;">
0.007<br>[-0.01, 0.03]
</td>
</tr>
</tbody>
</table>
<p>To better understand the moderation, we examined fully adjusted simple effects plots for tests of moderators of personality-cognitive ability associations in Figure S7. Although the figure demonstrates the simple effects for all of the Big Five, gender only significantly moderated openness to experience (b = -0.04, 95% CI [-0.07, -0.01]). In addition, the overall association between openness-crystallized ability association was positive for males and females. However, the interaction indicates that females had a significantly lower association than males.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-84"></span>
<img src="../../results/3_ipd_meta/Frequentist/figures/study specific simple effects/crystallized_Extraversion_gender_all.png" alt="Figure S7. Prospective sample-specific and overall associations between extraversion (in POMP units, 0-10) and crystallized abilities (in POMP units, 0-10) across genders (male, female). Different colors and line types indicate different samples. Thicker, black lines indicate the average association across samples, while thinner lines indicate sample-specific associations." width="900" />
<p class="caption">
Figure 5.1: Figure S7. Prospective sample-specific and overall associations between extraversion (in POMP units, 0-10) and crystallized abilities (in POMP units, 0-10) across genders (male, female). Different colors and line types indicate different samples. Thicker, black lines indicate the average association across samples, while thinner lines indicate sample-specific associations.
</p>
</div>
<p>Finally, we examined the consistency of the prospective associations across samples for both personality-cognitive ability associations and the simple effects across samples for each moderator. Figure S8 presents the forest plots of the fully adjusted sample-specific and meta-analytic estimates of Big Five personality characteristic-crystallized ability associations across samples. These associations were very consistent for openness, with all samples except for ROS demonstrating a positive association between openness and crystallized abilities. Other estimates were less consistent, with three samples (HRS, MAP, and ROS) showing a positive association between conscientiousness and crystallized abilities, one sample (SATSA) showing a negative association, and two samples (HILDA, GSOEP) showing a null association.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-85"></span>
<img src="../../results/3_ipd_meta/Frequentist/figures/study specific forest/crystallized_none_all.png" alt="Figure S8. Forest plot of fully adjusted prospective associations between Big Five personality characteristics and crystallized abilities across samples for using one-stage pooled integrative data analysis via effects coded contrasts. Overall point estimates (squares) represent the grand-mean estimates of the association across samples, while sample point estimates represent regression terms or linear combinations of regression terms. Error bars capture the 95% CI around the point estimate. Arrows indicate the confidence band was truncated to better visualize the estimates." width="1500" />
<p class="caption">
Figure 5.2: Figure S8. Forest plot of fully adjusted prospective associations between Big Five personality characteristics and crystallized abilities across samples for using one-stage pooled integrative data analysis via effects coded contrasts. Overall point estimates (squares) represent the grand-mean estimates of the association across samples, while sample point estimates represent regression terms or linear combinations of regression terms. Error bars capture the 95% CI around the point estimate. Arrows indicate the confidence band was truncated to better visualize the estimates.
</p>
</div>
<p>(Although gender did not moderate the association between extraversion and crystallized abilities in Method 3, for consistency with other methods, we include interpretation here.) Next, we examined the consistency of moderator associations across samples. Figure S7 displays the overall fully adjusted predicted crystallized abilities levels at different levels of extraversion across samples for those males and females for comparison to other methods. As is clear in the Figure, the overall trend suggests a null association for women and slight negative association for men, such that men who were higher in extraversion tended to score slightly worse on crystallized domain tasks. HRS (b = 0.04, 95% CI [-0.07, -0.02]) showed a negative association between extraversion and crystallized abilities for women, HILDA (b = 0.05, 95% CI [0.02, 0.08]) and GSOEP (b = 0.10, 95% CI [0.03, 0.17]) showed positive associations, and all other samples showed null associations. For men, HRS (b = -0.05, 95% CI [-0.08, -0.02]) and SATSA (b = -0.17, 95% CI [-0.30, -0.03]) demonstrated a negative association, only GSOEP demonstrated a positive association (b = 0.08, 95% CI [0.01, 0.14]), and all other samples demonstrated a null effect.</p>
<p>Among sample-level moderators, 15 of the 62 (24.19%) tested sample-level moderators were significant (fully adjusted). The most notable of these were country-level differences in the association between Conscientiousness and crystallized / knowledge domain cognitive ability and differences in the associations between Neuroticism and Conscientiousness’s associations with cognitive ability across different personality scales. Specifically, although there was a positive association between Conscientiousness and crystallized / knowledge domain cognitive ability in the United States (b = 0.06, 95% CI [0.04, 0.09]), that association was null (Germany, b = 0.001, 95% CI [-0.055, 0.057]; Australia, b = 0.003, 95% CI [-0.023, 0.030]) or negative (Sweden, b = -0.12, 95% CI [-0.20, -0.03]). Similarly, the association for Conscientiousness was positive when using the NEO-FFI (b = 0.09, 95% CI [0.03, 0.14]) and MIDI (b = 0.07, 95% CI [0.04, 0.09, negative when using the measures in SATSA and OCTO-TWIN (b = -0.12, 95% CI [-0.20, -0.03]). and null when using IPIP NEO (b = -0.04, 95% CI [-0.14, 0.06]), BFI-S (b = 0.001, 95% CI [-0.06, 0.06]), and TDA-40 (b = 0.003, 95% CI [-0.023, 0.029]). For Neuroticism, the association was negative for the NEO-FFI (b = -0.11, 95% CI [-0.15, -0.07]), MIDI (b = -0.02, 95% CI [-0.04, -0.00]), DPQ (b = -0.04, 95% CI [-0.08, -0.01]), and TDA-40 (b = -0.12, 95% CI [-0.14, -0.09]), and null for the IPIP NEO (b = -0.05, 95% CI [-0.14, 0.05]), BFI-S (b = -0.04, 95% CI [-0.08, 0.01]), and the measure used in SATSA and OCTO-TWIN (b = -0.04, 95% CI [-0.11, 0.02]). Simple effects plots for all sample-level moderators can be found in the online materials and web app.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="method-3-two-stage-individual-participant-meta-analysis.html#cb410-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()[<span class="fu">grepl</span>(<span class="st">&quot;ipd3&quot;</span>, <span class="fu">ls</span>())])</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="method-2-pooled-one-stage-models-with-study-specific-effects.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="method-3-one-stage-individual-participant-analyses-reported-together.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-coord_meta.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
